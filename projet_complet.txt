================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\add-poi\page.tsx
================================================================================

"use client";

import { useState, useEffect, Suspense, useRef } from "react";
import { useRouter, useSearchParams } from "next/navigation";
import { 
  ArrowLeft, Save, Loader2, Camera, MapPin, 
  Hash, Globe, Phone, Building2, Flag, Mail, 
  ScanLine, Type, Sparkles, CheckCircle2, CircleDashed,
  Target, ImagePlus, LocateFixed, Maximize, Check
} from "lucide-react";

// Imports pour la carte
import Map, { Marker, NavigationControl, ScaleControl, MapRef } from "react-map-gl/maplibre";
import "maplibre-gl/dist/maplibre-gl.css";

import { POI, Location } from "@/types";
import { useUserData } from "@/hooks/useUserData";
import { CATEGORIES } from "@/data/categories";
import { Button } from "@/components/ui/Button";
import { FormInput } from "@/components/ui/form/FormInput";
import { FormSelect } from "@/components/ui/form/FormSelect";
import Image from "next/image";
import { clsx } from "clsx";
import { poiService } from "@/services/poiService";

// Clé API MapTiler (la même que dans page.tsx)
const MAPTILER_API_KEY = "Lr72DkH8TYyjpP7RNZS9"; 

const AMENITIES_OPTIONS = [
  "Wi-Fi", "Parking", "Climatisé", "Terrasse", "Mobile Money", 
  "Traiteur", "Sécurité", "Vue", "Handicap", "Bar", "24h/24"
];

function AddPoiContent() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const { addMyPoi, updateMyPoi, myPois } = useUserData();
  
  // States
  const [isLoading, setIsLoading] = useState(true);
  const [isMapOpen, setIsMapOpen] = useState(false); // Modal Carte
  const [postalCode, setPostalCode] = useState(""); 
  const [keywordsString, setKeywordsString] = useState("");
  const [previewImage, setPreviewImage] = useState<string | null>(null);

  const editId = searchParams.get("id");

  // Données du formulaire
  const [formData, setFormData] = useState<Partial<POI>>({
    poi_name: "",
    poi_category: "",
    poi_description: "",
    poi_amenities: [],
    location: { latitude: 3.86667, longitude: 11.51667 }, // Défaut: Yaoundé
    address_informal: "",
    address_city: "Yaoundé",
    address_country: "Cameroun",
    poi_contacts: { phone: "", website: "" },
    poi_images_urls: [],
    poi_keywords: []
  });

  // State temporaire pour la carte plein écran
  const [tempLocation, setTempLocation] = useState<Location>({ latitude: 0, longitude: 0 });
  const mapRef = useRef<MapRef>(null);

  // Initialisation
  useEffect(() => {
    if (editId) {
      const existing = myPois.find(p => p.poi_id === editId);
      if (existing) {
        setFormData(existing);
        setTempLocation(existing.location);
        if (existing.poi_images_urls && existing.poi_images_urls[0]) {
          setPreviewImage(existing.poi_images_urls[0]);
        }
        setKeywordsString(existing.poi_keywords?.join(", ") || "");
      }
    } else {
      // Géolocalisation navigateur au chargement
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition((pos) => {
          const loc = { latitude: pos.coords.latitude, longitude: pos.coords.longitude };
          setFormData(prev => ({ ...prev, location: loc }));
          setTempLocation(loc);
        });
      }
    }
    setIsLoading(false);
  }, [editId, myPois]);

  // --- HANDLERS ---

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
    const { name, value } = e.target;
    if (name === "phone" || name === "website") {
        setFormData(prev => ({ ...prev, poi_contacts: { ...prev.poi_contacts, [name]: value } }));
    } else if (name === "latitude" || name === "longitude") {
        const val = parseFloat(value) || 0;
        setFormData(prev => ({ ...prev, location: { ...prev.location!, [name]: val } }));
        setTempLocation(prev => ({ ...prev, [name]: val }));
    } else {
        setFormData(prev => ({ ...prev, [name]: value }));
    }
  };

  const handleAmenityToggle = (amenity: string) => {
    const current = formData.poi_amenities || [];
    const newAmenities = current.includes(amenity)
        ? current.filter(a => a !== amenity)
        : [...current, amenity];
    setFormData(prev => ({ ...prev, poi_amenities: newAmenities }));
  };

  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
        const reader = new FileReader();
        reader.onloadend = () => {
            const res = reader.result as string;
            setPreviewImage(res);
            setFormData(prev => ({ ...prev, poi_images_urls: [res] }));
        };
        reader.readAsDataURL(file);
    }
  };

  // Gestion Carte
  const handleMapClick = (evt: any) => {
    setTempLocation({
        latitude: evt.lngLat.lat,
        longitude: evt.lngLat.lng
    });
  };

  const handleDragEnd = (evt: any) => {
    setTempLocation({
        latitude: evt.lngLat.lat,
        longitude: evt.lngLat.lng
    });
  };

  const saveMapLocation = () => {
    setFormData(prev => ({
        ...prev,
        location: tempLocation
    }));
    setIsMapOpen(false);
  };
const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    // Validation basique
    if (!formData.poi_name || !formData.poi_category) {
        alert("Veuillez renseigner au moins le nom et la catégorie.");
        return;
    }

    setIsLoading(true);

    try {
        // Préparer les données avec keywords convertis
        const dataToSubmit = {
            ...formData,
            poi_keywords: keywordsString 
                ? keywordsString.split(',').map(k => k.trim()).filter(k => k.length > 0)
                : [],
            address_state_province: "Adamaoua" // Province de Ngaoundéré
        };

        if (editId) {
            await poiService.updatePoi(editId, dataToSubmit);
            alert("Lieu mis à jour avec succès !");
        } else {
            await poiService.createPoi(dataToSubmit);
            alert("Nouveau point d'intérêt publié sur Navigoo !");
        }
        
        router.push("/");
        router.refresh();
    } catch (err: any) {
        console.error("❌ Erreur Backend:", err);
        alert(`Erreur lors de l'enregistrement : ${err.message}`);
    } finally {
        setIsLoading(false);
    }
};
  if (isLoading) return <div className="h-screen w-full bg-zinc-50 dark:bg-black flex items-center justify-center"><Loader2 className="animate-spin text-primary" size={40}/></div>;

  return (
    <div className="h-screen w-full bg-zinc-50 dark:bg-black font-sans overflow-y-auto">
      
      {/* HEADER FIXE */}
      <div className="sticky top-0 bg-white/90 dark:bg-zinc-900/90 backdrop-blur-md border-b border-zinc-200 dark:border-zinc-800 z-40 py-3 shadow-sm">
        <div className="max-w-7xl mx-auto px-4 lg:px-8">
            <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div className="flex items-center gap-4">
                    <button onClick={() => router.back()} className="p-2.5 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-xl transition-colors border border-transparent hover:border-zinc-200 dark:hover:border-zinc-700">
                        <ArrowLeft size={20} className="text-zinc-600 dark:text-zinc-400" />
                    </button>
                    <div>
                        <div className="flex items-center gap-2">
                            <span className="text-xs font-bold text-primary uppercase tracking-wider bg-primary/10 px-2 py-0.5 rounded-full">
                                {editId ? "Édition" : "Nouveau"}
                            </span>
                            <h1 className="text-lg md:text-xl font-bold text-zinc-900 dark:text-white leading-none">
                                Bienvenue, Explorateur
                            </h1>
                        </div>
                        <p className="text-xs md:text-sm text-zinc-500 dark:text-zinc-400 flex items-center gap-1.5 mt-1">
                            <Sparkles size={12} className="text-yellow-500 fill-yellow-500" /> 
                            Partagez vos meilleures découvertes et enrichissez la carte.
                        </p>
                    </div>
                </div>
                <div className="flex items-center justify-end">
                    <Button 
                        onClick={handleSubmit} 
                        variant="primary" 
                        className="px-6 py-2 h-11 text-sm font-bold shadow-lg shadow-primary/20 hover:scale-[1.02] active:scale-[0.98] transition-transform flex items-center gap-2"
                    >
                        <Save size={18} /> {editId ? "Mettre à jour" : "Publier le lieu"}
                    </Button>
                </div>
            </div>
        </div>
      </div>

      <div className="max-w-7xl mx-auto p-4 md:p-6 pb-24">
        <form className="grid grid-cols-1 lg:grid-cols-2 gap-6 items-start">

            {/* GAUCHE : INFOS */}
            <div className="bg-white dark:bg-zinc-900 rounded-3xl p-5 border border-zinc-200 dark:border-zinc-800 shadow-sm space-y-5">
                <div className="flex items-center gap-3 pb-4 border-b border-zinc-100 dark:border-zinc-800">
                    <div className="p-2.5 bg-violet-100 dark:bg-violet-900/30 rounded-xl text-primary">
                        <ScanLine size={20} />
                    </div>
                    <div>
                        <h2 className="text-base font-bold text-zinc-800 dark:text-zinc-100">Informations Générales</h2>
                        <p className="text-[11px] text-zinc-500">Détails essentiels pour identifier le lieu.</p>
                    </div>
                </div>

                {/* Upload Photo */}
                <div className="relative h-40 w-full bg-zinc-100 dark:bg-zinc-800 rounded-2xl border-2 border-dashed border-zinc-300 dark:border-zinc-700 overflow-hidden group cursor-pointer transition-colors hover:border-primary hover:bg-primary/5">
                    {previewImage ? (
                        <Image src={previewImage} alt="Cover" fill className="object-cover transition-transform group-hover:scale-105" />
                    ) : (
                        <div className="absolute inset-0 flex flex-col items-center justify-center text-zinc-400">
                            <ImagePlus size={24} className="mb-2 group-hover:text-primary" />
                            <span className="text-xs font-semibold">Ajouter une couverture</span>
                        </div>
                    )}
                    <input type="file" onChange={handleImageChange} accept="image/*" className="absolute inset-0 opacity-0 cursor-pointer z-10" />
                </div>

                <div className="space-y-12">
                    <FormInput 
                        label="Nom du lieu" name="poi_name" 
                        value={formData.poi_name} onChange={handleChange} 
                        icon={<Type size={16}/>} className="h-11" placeholder="Ex: Restaurant Le Délice"
                    />
                    
                    <FormSelect 
                        label="Catégorie" name="poi_category" 
                        value={formData.poi_category} onChange={handleChange}
                        icon={<Hash size={16}/>}
                        options={CATEGORIES.map(c => ({ id: c.id, label: c.label }))}
                    />

                    <FormInput 
                        as="textarea" label="Courte description" name="poi_description"
                        value={formData.poi_description} onChange={handleChange} 
                        icon={<Type size={16}/>} style={{ minHeight: '80px', maxHeight: '120px' }}
                    />

                    <div className="grid grid-cols-2 gap-3">
                        <FormInput 
                            label="Téléphone" name="phone" 
                            value={formData.poi_contacts?.phone} onChange={handleChange}
                            icon={<Phone size={16}/>} className="h-11" 
                        />
                        <FormInput 
                            label="Site Web" name="website" 
                            value={formData.poi_contacts?.website} onChange={handleChange}
                            icon={<Globe size={16}/>} className="h-11" placeholder="facultatif"
                        />
                    </div>

                    <FormInput 
                        label="Mots-clés" name="keywords" 
                        value={keywordsString} onChange={(e) => setKeywordsString(e.target.value)}
                        icon={<Hash size={16}/>} className="h-11" placeholder="tag1, tag2..."
                    />

                    <div>
                        <label className="text-[10px] font-bold text-zinc-500 uppercase tracking-wider mb-2 ml-1 block">Équipements</label>
                        <div className="flex flex-wrap gap-1.5">
                            {AMENITIES_OPTIONS.map(am => (
                                <button key={am} type="button" onClick={() => handleAmenityToggle(am)}
                                    className={clsx(
                                        "px-3 py-1.5 rounded-lg text-[11px] font-bold border flex items-center gap-1.5 transition-all",
                                        formData.poi_amenities?.includes(am)
                                        ? "bg-zinc-800 text-white border-zinc-800 dark:bg-white dark:text-black shadow-sm" 
                                        : "bg-white dark:bg-zinc-800 text-zinc-500 border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50"
                                    )}
                                >
                                    {formData.poi_amenities?.includes(am) ? <CheckCircle2 size={12}/> : <CircleDashed size={12}/>}
                                    {am}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            </div>

            {/* DROITE : COORDONNÉES */}
            <div className="bg-white dark:bg-zinc-900 rounded-3xl p-5 border border-zinc-200 dark:border-zinc-800 shadow-sm space-y-5 h-full flex flex-col">
                <div className="flex items-center gap-3 pb-4 border-b border-zinc-100 dark:border-zinc-800">
                    <div className="p-2.5 bg-blue-100 dark:bg-blue-900/30 rounded-xl text-blue-600">
                        <MapPin size={20} />
                    </div>
                    <div>
                        <h2 className="text-base font-bold text-zinc-800 dark:text-zinc-100">Coordonnées</h2>
                        <p className="text-[11px] text-zinc-500">Sélectionnez la position exacte sur la carte.</p>
                    </div>
                </div>

                {/* --- VUE MINIATURE AVEC BOUTON --- */}
                <div className="relative w-full h-48 rounded-2xl overflow-hidden border border-zinc-200 dark:border-zinc-800 shadow-inner group">
                    {/* Carte Miniature Statique (MapLibre avec interactivité désactivée) */}
                    <div className="absolute inset-0 grayscale-[50%] group-hover:grayscale-0 transition-all duration-500">
                       {/* Note: Pour éviter trop de lourdeur, on peut aussi utiliser une image statique, 
                           mais ici j'utilise la Map désactivée pour la précision visuelle */}
                        <Map
                            initialViewState={{
                                longitude: formData.location?.longitude || 11.5,
                                latitude: formData.location?.latitude || 3.8,
                                zoom: 14
                            }}
                            mapStyle={`https://api.maptiler.com/maps/streets-v2/style.json?key=${MAPTILER_API_KEY}`}
                            scrollZoom={false}
                            dragPan={false}
                            doubleClickZoom={false}
                            attributionControl={false}
                        >
                            <Marker longitude={formData.location?.longitude || 0} latitude={formData.location?.latitude || 0}>
                                <MapPin size={32} className="text-primary fill-primary/20 drop-shadow-md" />
                            </Marker>
                        </Map>
                    </div>

                    {/* Overlay d'Action */}
                    <div className="absolute inset-0 bg-black/10 hover:bg-black/20 transition-colors flex items-center justify-center pointer-events-none">
                        <div className="pointer-events-auto transform transition-transform group-hover:scale-105">
                            <button 
                                type="button"
                                onClick={() => { setTempLocation(formData.location!); setIsMapOpen(true); }}
                                className="bg-white text-zinc-800 px-5 py-2.5 rounded-full font-bold shadow-xl flex items-center gap-2 text-sm border-2 border-primary/20 hover:border-primary transition-all"
                            >
                                <Maximize size={16} className="text-primary"/> 
                                Choisir sur la carte
                            </button>
                        </div>
                    </div>
                </div>

                <div className="space-y-12 pt-2 flex-1">
                    {/* Bloc info GPS Rapide */}
                    <div className="p-3 bg-zinc-50 dark:bg-zinc-950 border border-dashed border-zinc-200 dark:border-zinc-700 rounded-xl flex items-center justify-between">
                        <div className="flex items-center gap-2">
                            <Target size={16} className="text-zinc-400"/>
                            <div className="text-xs font-mono font-bold text-zinc-600 dark:text-zinc-300">
                                {formData.location?.latitude.toFixed(6)}, {formData.location?.longitude.toFixed(6)}
                            </div>
                        </div>
                        <span className="text-[10px] text-green-600 font-bold bg-green-100 dark:bg-green-900/30 px-2 py-0.5 rounded-md">
                            Synchronisé
                        </span>
                    </div>

                    <FormInput 
                        label="Adresse / Lieu-dit" name="address_informal"
                        value={formData.address_informal} onChange={handleChange} 
                        icon={<MapPin size={16}/>} className="h-11" placeholder="Ex: Bastos, Face ambassade..."
                    />

                    <div className="grid grid-cols-2 gap-3">
                        <FormInput 
                            label="Ville" name="address_city"
                            value={formData.address_city} onChange={handleChange} 
                            icon={<Building2 size={16}/>} className="h-11"
                        />
                        <FormInput 
                            label="Pays" name="address_country"
                            value={formData.address_country} onChange={handleChange} 
                            icon={<Flag size={16}/>} className="h-11"
                        />
                    </div>

                    <FormInput 
                        label="Code Postal" name="postalCode"
                        value={postalCode} onChange={(e) => setPostalCode(e.target.value)} 
                        icon={<Mail size={16}/>} className="h-11"
                    />
                </div>
            </div>

        </form>
      </div>

      {/* --- MODALE CARTE PLEIN ÉCRAN --- */}
      {isMapOpen && (
        <div className="fixed inset-0 z-[60] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 md:p-8 animate-in fade-in zoom-in-95 duration-200">
            <div className="bg-white dark:bg-zinc-900 w-full h-full rounded-3xl overflow-hidden relative shadow-2xl flex flex-col">
                
                {/* En-tête Modal */}
                <div className="absolute top-4 left-4 right-4 z-10 flex justify-between pointer-events-none">
                    <div className="bg-white/90 dark:bg-zinc-800/90 backdrop-blur px-4 py-2 rounded-full shadow-lg border border-zinc-200 dark:border-zinc-700 pointer-events-auto">
                        <h3 className="text-sm font-bold flex items-center gap-2">
                            <MapPin size={16} className="text-primary"/>
                            Glissez le marqueur ou cliquez pour définir
                        </h3>
                    </div>
                    <button 
                        onClick={() => setIsMapOpen(false)}
                        className="bg-white text-zinc-800 p-2 rounded-full shadow-lg pointer-events-auto hover:bg-zinc-100"
                    >
                        <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>

                {/* Map Interactive */}
                <div className="flex-1 w-full h-full relative bg-zinc-100">
                    <Map
                        initialViewState={{
                            longitude: tempLocation.longitude,
                            latitude: tempLocation.latitude,
                            zoom: 15
                        }}
                        mapStyle={`https://api.maptiler.com/maps/streets-v2/style.json?key=${MAPTILER_API_KEY}`}
                        onClick={handleMapClick}
                    >
                        <NavigationControl position="bottom-left" showCompass={false} />
                        <ScaleControl position="bottom-right" />

                        {/* Draggable Marker */}
                        <Marker 
                            longitude={tempLocation.longitude} 
                            latitude={tempLocation.latitude} 
                            draggable
                            onDragEnd={handleDragEnd}
                            anchor="bottom"
                        >
                            <div className="flex flex-col items-center cursor-move hover:scale-110 transition-transform">
                                <Flag size={40} className="text-red-600 fill-red-600 drop-shadow-xl filter" strokeWidth={2} />
                                <div className="w-2.5 h-2.5 bg-black/50 rounded-full blur-[2px] mt-[-2px]"></div>
                            </div>
                        </Marker>
                    </Map>
                </div>

                {/* Footer Modal avec Actions */}
                <div className="bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-800 p-4 flex flex-col md:flex-row justify-between items-center gap-4 shrink-0">
                    <div className="flex items-center gap-2 text-zinc-500 text-xs font-mono">
                       <LocateFixed size={14}/>
                       Lat: <span className="text-zinc-800 dark:text-zinc-200 font-bold">{tempLocation.latitude.toFixed(6)}</span> 
                       Lon: <span className="text-zinc-800 dark:text-zinc-200 font-bold">{tempLocation.longitude.toFixed(6)}</span>
                    </div>
                    
                    <div className="flex gap-3 w-full md:w-auto">
                        <Button variant="secondary" onClick={() => navigator.geolocation.getCurrentPosition(p => setTempLocation({latitude: p.coords.latitude, longitude: p.coords.longitude}))} size="md" className="flex-1 md:flex-none">
                            <LocateFixed size={18} /> Ma position
                        </Button>
                        <Button onClick={saveMapLocation} variant="primary" size="md" className="flex-1 md:flex-none font-bold gap-2">
                            <Check size={18} /> Valider la position
                        </Button>
                    </div>
                </div>
            </div>
        </div>
      )}

    </div>
  );
}

// Wrapper Suspense pour Next.js 
export default function AddPoiPage() {
    return (
        <Suspense fallback={<div className="h-screen w-full bg-white dark:bg-black" />}>
            <AddPoiContent />
        </Suspense>
    )
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\register\page.tsx
================================================================================

"use client";

import { useState } from "react";
import Image from "next/image";
import Link from "next/link";
import { useRouter } from "next/navigation";
import {
  User, Mail, Phone, Lock, Eye, EyeOff,
  ArrowRight, Loader2
} from "lucide-react";
import { Button } from "@/components/ui/Button";
import { authService } from "@/services/authService";

export default function RegisterPage() {
  const router = useRouter();
  const [showPassword, setShowPassword] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const [formData, setFormData] = useState({
    username: "",
    email: "",
    phone: "",
    password: ""
  });


  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const { name, value } = e.target;
    
    // Nettoyage du téléphone : garder seulement +, chiffres
    if (name === "phone") {
      const cleaned = value.replace(/[^\d+]/g, "");
      setFormData({ ...formData, [name]: cleaned });
    } else {
      setFormData({ ...formData, [name]: value });
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);

    try {
      await authService.register(formData);
      alert("Compte créé avec succès ! Connectez-vous.");
      router.push("/signin");
      
    } catch (err: any) {
      console.error(err);
      setError(err.message || "Erreur inconnue");
    } finally {
      setIsLoading(false);
    }
  };


  return (
    <div className="min-h-screen w-full bg-white dark:bg-black flex">
      
      {/* --- SECTION GAUCHE (Image en arrière-plan) --- */}
      <div className="hidden lg:flex lg:w-1/2 relative overflow-hidden">
        {/* Image Light Mode */}
        <Image 
          src="/images/image1.png" 
          alt="Join us"
          fill
          sizes="50vw"
          className="object-cover dark:hidden"
          priority
        />
        {/* Image Dark Mode */}
        <Image 
          src="/images/image2.png" 
          alt="Join us"
          fill
          sizes="50vw"
          className="object-cover hidden dark:block"
          priority
        />
        
        {/* Overlay décoratif avec icônes et texte */}
        <div className="absolute inset-0 bg-gradient-to-br from-primary/10 via-transparent to-primary/5 dark:from-primary/20 dark:to-primary/10">
          
          {/* Cercles décoratifs */}
          <div className="absolute top-10 left-10 w-20 h-20 bg-white/20 dark:bg-white/10 rounded-full blur-2xl"></div>
          <div className="absolute bottom-20 right-10 w-40 h-40 bg-primary/30 dark:bg-primary/20 rounded-full blur-3xl"></div>
          
          {/* Texte centré */}
          <div className="absolute inset-0 flex flex-col items-center justify-center text-center mt-128 ml-48 px-8 z-10">
            <div className="bg-white/90 dark:bg-black/80 backdrop-blur-sm px-8 py-6 rounded-3xl border border-white/50 dark:border-zinc-800">
              <h2 className="text-3xl font-black text-primary mb-3">Rejoignez Navigoo</h2>
              <p className="text-zinc-600 dark:text-zinc-300 text-base max-w-md">
                Explorez, partagez et découvrez les meilleurs endroits du Cameroun en communauté.
              </p>
            </div>
          </div>
        </div>
      </div>

      {/* --- SECTION DROITE (Formulaire) --- */}
      <div className="w-full lg:w-1/2 bg-white dark:bg-black p-8 lg:p-16 flex flex-col justify-center overflow-y-auto">
        
        <div className="max-w-md mx-auto w-full">
          <div className="mb-8">
            <div className="flex items-center gap-2 mb-2">
              <span className="h-2 w-2 bg-primary rounded-full"></span>
              <span className="text-xs font-bold uppercase tracking-wider text-zinc-400">Inscription</span>
            </div>
            <h1 className="text-3xl lg:text-4xl font-black text-zinc-900 dark:text-white">Créer un compte</h1>
          </div>

          {error && (
            <div className="mb-6 p-4 rounded-xl bg-red-50 dark:bg-red-950/50 text-red-600 dark:text-red-400 text-sm flex items-center gap-2">
              <span>⚠️</span> {error}
            </div>
          )}

          <form onSubmit={handleSubmit} className="space-y-5">
            
            {/* Username */}
            <div className="space-y-1.5">
              <label className="text-xs font-bold text-zinc-500 dark:text-zinc-400 ml-1">Nom d'utilisateur</label>
              <div className="relative group">
                <User className="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-primary transition-colors" size={20} />
                <input 
                  type="text" name="username" required
                  value={formData.username} onChange={handleChange}
                  placeholder="ex: KmerExplorer"
                  className="w-full pl-12 pr-4 py-4 rounded-2xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 focus:border-primary outline-none text-zinc-900 dark:text-white font-medium transition-all"
                />
              </div>
            </div>

            {/* Email & Phone Grid */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div className="space-y-1.5">
                <label className="text-xs font-bold text-zinc-500 dark:text-zinc-400 ml-1">Email</label>
                <div className="relative group">
                  <Mail className="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-primary transition-colors" size={20} />
                  <input 
                    type="email" name="email" required
                    value={formData.email} onChange={handleChange}
                    placeholder="nom@mail.com"
                    className="w-full pl-12 pr-4 py-4 rounded-2xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 focus:border-primary outline-none text-zinc-900 dark:text-white font-medium transition-all"
                  />
                </div>
              </div>

              <div className="space-y-1.5">
                <label className="text-xs font-bold text-zinc-500 dark:text-zinc-400 ml-1">Téléphone</label>
                <div className="relative group">
                  <Phone className="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-primary transition-colors" size={20} />
                  <input 
                    type="tel" name="phone"
                    value={formData.phone} onChange={handleChange}
                    placeholder="+237 ..."
                    className="w-full pl-12 pr-4 py-4 rounded-2xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 focus:border-primary outline-none text-zinc-900 dark:text-white font-medium transition-all"
                  />
                </div>
              </div>
            </div>

            {/* Password */}
            <div className="space-y-1.5">
              <label className="text-xs font-bold text-zinc-500 dark:text-zinc-400 ml-1">Mot de passe</label>
              <div className="relative group">
                <Lock className="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-primary transition-colors" size={20} />
                <input 
                  type={showPassword ? "text" : "password"} 
                  name="password" required
                  value={formData.password} onChange={handleChange}
                  placeholder="••••••••"
                  className="w-full pl-12 pr-12 py-4 rounded-2xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 focus:border-primary outline-none text-zinc-900 dark:text-white font-medium transition-all"
                />
                <button 
                  type="button" 
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"
                >
                  {showPassword ? <EyeOff size={20}/> : <Eye size={20}/>}
                </button>
              </div>
            </div>

            {/* Submit Button */}
            <div className="pt-4">
              <Button 
                disabled={isLoading}
                className="w-full h-14 bg-primary hover:bg-primary-dark text-white rounded-2xl font-bold text-lg hover:scale-[1.01] active:scale-[0.99] transition-all flex items-center justify-center gap-3"
              >
                {isLoading ? <Loader2 className="animate-spin" /> : <>Créer mon compte <ArrowRight size={20}/></>}
              </Button>
            </div>
          </form>

          {/* Footer */}
          <div className="mt-8 text-center space-y-6">
            <p className="text-xs text-zinc-400">
              En vous inscrivant, vous acceptez nos{" "}
              <span className="text-primary underline cursor-pointer">Conditions</span> et{" "}
              <span className="text-primary underline cursor-pointer">Confidentialité</span>.
            </p>

            <div className="relative">
              <div className="absolute inset-0 flex items-center">
                <div className="w-full border-t border-zinc-200 dark:border-zinc-800"></div>
              </div>
              <div className="relative flex justify-center text-xs">
                <span className="px-2 bg-white dark:bg-black text-zinc-500">ou</span>
              </div>
            </div>
            
            <p className="text-sm text-zinc-600 dark:text-zinc-400">
              Vous avez déjà un compte ? 
              <Link href="/signin" className="ml-2 font-bold text-primary hover:underline">
                Se connecter
              </Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\signin\page.tsx
================================================================================

"use client";

import { useState } from "react";
import Image from "next/image";
import Link from "next/link";
import { useRouter } from "next/navigation";
import { Mail, Lock, Eye, EyeOff, LogIn, Loader2 } from "lucide-react";
import { Button } from "@/components/ui/Button";
import { authService } from "@/services/authService";

export default function SignInPage() {
  const router = useRouter();
  const [showPassword, setShowPassword] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const [formData, setFormData] = useState({ email: "", password: "" });

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsLoading(true);
    setError(null);
    try {
      await authService.login(formData);
      router.push("/");
    } catch (err: any) {
      setError(typeof err === 'string' ? err : "Email ou mot de passe incorrect");
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="min-h-screen w-full bg-white dark:bg-black flex">
      
      {/* --- SECTION GAUCHE (Image en arrière-plan) --- */}
      <div className="hidden lg:flex lg:w-1/2 relative overflow-hidden">
        {/* Image Light Mode */}
        <Image 
          src="/images/image1.png"
          alt="Welcome back"
          fill
          className="object-cover dark:hidden"
          priority
        />
        {/* Image Dark Mode */}
        <Image 
          src="/images/image2.png"
          alt="Welcome back"
          fill
          className="object-cover hidden dark:block"
          priority
        />
        
        {/* Overlay décoratif avec icônes et texte */}
        <div className="absolute inset-0 bg-gradient-to-br from-green-500/10 via-transparent to-green-500/5 dark:from-green-500/20 dark:to-green-500/10">
          
          {/* Cercles décoratifs */}
          <div className="absolute top-20 right-10 w-32 h-32 bg-white/20 dark:bg-white/10 rounded-full blur-3xl"></div>
          <div className="absolute bottom-10 left-10 w-40 h-40 bg-green-400/20 dark:bg-green-500/20 rounded-full blur-3xl"></div>
          
          {/* Texte centré */}
          <div className="absolute inset-0 flex flex-col items-center justify-center text-center mt-128 ml-48 px-8 z-10">
            <div className="bg-white/90 dark:bg-black/80 backdrop-blur-sm px-8 py-6 rounded-3xl border border-white/50 dark:border-zinc-800">
              <h2 className="text-3xl font-black text-green-700 dark:text-green-500 mb-3">Bon retour !</h2>
              <p className="text-zinc-600 dark:text-zinc-300 text-base max-w-md">
                Reprenez votre navigation là où vous l'avez laissée.
              </p>
            </div>
          </div>
        </div>
      </div>

      {/* --- SECTION DROITE (Formulaire) --- */}
      <div className="w-full lg:w-1/2 bg-white dark:bg-black p-8 lg:p-16 flex flex-col justify-center overflow-y-auto">
        
        <div className="max-w-md mx-auto w-full">
          
          <div className="mb-10">
            <div className="inline-flex items-center gap-2 mb-3 bg-primary/10 dark:bg-primary/20 px-3 py-1 rounded-full text-primary text-xs font-bold tracking-wide">
              <span className="w-2 h-2 rounded-full bg-primary animate-pulse"></span>
              POI Navigoo
            </div>
            <h1 className="text-4xl font-black text-zinc-900 dark:text-white mb-2">Connexion</h1>
            <p className="text-zinc-500 dark:text-zinc-400">Entrez vos identifiants pour accéder.</p>
          </div>

          {error && (
            <div className="mb-6 p-4 rounded-xl bg-red-50 dark:bg-red-950/50 text-red-600 dark:text-red-400 text-sm flex items-center gap-2 animate-pulse">
              <span>⛔</span> {error}
            </div>
          )}

          <form onSubmit={handleSubmit} className="space-y-6">
            
            {/* Email */}
            <div className="space-y-1.5">
              <label className="text-xs font-bold text-zinc-500 dark:text-zinc-400 ml-1">Adresse Email</label>
              <div className="relative group">
                <Mail className="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-primary transition-colors" size={20} />
                <input 
                  type="text" name="email" required
                  value={formData.email} onChange={handleChange}
                  placeholder="nom@mail.com"
                  className="w-full pl-12 pr-4 py-4 rounded-2xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 focus:border-primary outline-none text-zinc-900 dark:text-white font-medium transition-all"
                />
              </div>
            </div>

            {/* Password */}
            <div className="space-y-1.5">
              <div className="flex justify-between ml-1">
                <label className="text-xs font-bold text-zinc-500 dark:text-zinc-400">Mot de passe</label>
                <a href="#" className="text-xs text-primary hover:underline font-semibold">Oublié ?</a>
              </div>
              <div className="relative group">
                <Lock className="absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400 group-focus-within:text-primary transition-colors" size={20} />
                <input 
                  type={showPassword ? "text" : "password"} name="password" required
                  value={formData.password} onChange={handleChange}
                  placeholder="••••••••"
                  className="w-full pl-12 pr-12 py-4 rounded-2xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 focus:border-primary outline-none text-zinc-900 dark:text-white font-medium transition-all"
                />
                <button 
                  type="button" 
                  onClick={() => setShowPassword(!showPassword)} 
                  className="absolute right-4 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"
                >
                  {showPassword ? <EyeOff size={20}/> : <Eye size={20}/>}
                </button>
              </div>
            </div>

            {/* Submit Button */}
            <Button 
              disabled={isLoading}
              className="w-full h-14 bg-primary hover:bg-primary-dark text-white rounded-2xl font-bold text-lg hover:-translate-y-1 active:scale-[0.98] transition-all"
            >
              {isLoading ? (
                <Loader2 className="animate-spin" />
              ) : (
                <span className="flex items-center gap-2">
                  Se connecter <LogIn size={20} />
                </span>
              )}
            </Button>
          </form>

          {/* Footer Link */}
          <div className="mt-8 text-center pt-6 border-t border-zinc-200 dark:border-zinc-800">
            <p className="text-sm text-zinc-600 dark:text-zinc-400">
              Pas encore de compte ? 
              <Link href="/register" className="ml-2 font-bold text-primary hover:text-primary-dark hover:underline transition-colors">
                Créer un compte
              </Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\admin\page.tsx
================================================================================

'use client';

import React, { useState, useEffect } from 'react';
import { Sidebar } from '@/components/admin/Sidebar';
import { StatsCard } from '@/components/admin/StatCards';
import { Chart } from '@/components/admin/Chart';
import { RecentActivity } from '@/components/admin/RecentActivity';
import { DataTable, Column } from '@/components/admin/DataTable';
import { 
  DashboardAPI, 
  PoiAPI, 
  ReviewAPI, 
  UserAPI, 
  OrganizationAPI,
  StatisticsAPI,
  AccessLogAPI,
  BlogAPI,
  PodcastAPI,
  PointOfInterest,
  PoiReview,
  AppUser,
  Organization,
} from '@/services/adminService';
import { formatDate, formatCompactNumber, getPoiCategoryLabel, cn } from '@/components/admin/utils';

export default function AdminPage() {
  const [currentSection, setCurrentSection] = useState('dashboard');
  const [loading, setLoading] = useState(true);
  const [dashboardData, setDashboardData] = useState({
    totalPois: 0,
    activePois: 0,
    totalUsers: 0,
    totalReviews: 0,
    averageRating: 0,
    totalViews: 0,
    totalLikes: 0,
  });
  const [pois, setPois] = useState<PointOfInterest[]>([]);
  const [reviews, setReviews] = useState<PoiReview[]>([]);
  const [users, setUsers] = useState<AppUser[]>([]);
  const [organizations, setOrganizations] = useState<Organization[]>([]);

  useEffect(() => {
    loadDashboardData();
  }, []);

  const loadDashboardData = async () => {
    try {
      setLoading(true);
      const [overview, poisData, reviewsData, usersData, orgsData] = await Promise.all([
        DashboardAPI.getOverview(),
        PoiAPI.getAll(),
        ReviewAPI.getAll(),
        UserAPI.getAll(),
        OrganizationAPI.getAll(),
      ]);

      setDashboardData(overview);
      setPois(poisData);
      setReviews(reviewsData);
      setUsers(usersData);
      setOrganizations(orgsData);
    } catch (error) {
      console.error('Error loading dashboard data:', error);
    } finally {
      setLoading(false);
    }
  };

  const recentActivities = [
    {
      id: '1',
      type: 'poi' as const,
      title: 'Nouveau POI créé',
      description: 'Hôtel Hilton Yaoundé ajouté au système',
      timestamp: new Date().toISOString(),
      user: 'Admin',
    },
    {
      id: '2',
      type: 'review' as const,
      title: 'Nouvel avis',
      description: '5 étoiles pour Restaurant Le Palais',
      timestamp: new Date(Date.now() - 3600000).toISOString(),
      user: 'Jean Dupont',
    },
    {
      id: '3',
      type: 'user' as const,
      title: 'Nouvel utilisateur',
      description: 'marie.martin@example.com s\'est inscrit',
      timestamp: new Date(Date.now() - 7200000).toISOString(),
    },
  ];

  const poiColumns: Column<PointOfInterest>[] = [
    {
      key: 'poi_name',
      label: 'Nom',
      sortable: true,
      render: (row) => (
        <div className="flex items-center gap-3">
          <div className="h-10 w-10 rounded-lg bg-gradient-to-br from-violet-500 to-purple-500 flex items-center justify-center text-white font-bold">
            {row.poi_name.charAt(0)}
          </div>
          <div>
            <p className="font-medium">{row.poi_name}</p>
            <p className="text-xs text-gray-500">{getPoiCategoryLabel(row.poi_category)}</p>
          </div>
        </div>
      ),
    },
    {
      key: 'address_city',
      label: 'Ville',
      sortable: true,
    },
    {
      key: 'popularity_score',
      label: 'Popularité',
      sortable: true,
      render: (row) => (
        <div className="flex items-center gap-2">
          <div className="h-2 w-24 rounded-full bg-gray-200 dark:bg-gray-700">
            <div
              className="h-2 rounded-full bg-gradient-to-r from-violet-500 to-purple-500"
              style={{ width: `${row.popularity_score || 0}%` }}
            />
          </div>
          <span className="text-xs">{row.popularity_score || 0}</span>
        </div>
      ),
    },
    {
      key: 'is_active',
      label: 'Statut',
      render: (row) => (
        <span
          className={cn(
            'inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium',
            row.is_active
              ? 'bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400'
              : 'bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400'
          )}
        >
          <span className={cn('h-2 w-2 rounded-full', row.is_active ? 'bg-emerald-500' : 'bg-gray-400')} />
          {row.is_active ? 'Actif' : 'Inactif'}
        </span>
      ),
    },
    {
      key: 'created_at',
      label: 'Date de création',
      sortable: true,
      render: (row) => formatDate(row.created_at),
    },
  ];

  const reviewColumns: Column<PoiReview>[] = [
    {
      key: 'rating',
      label: 'Note',
      render: (row) => (
        <div className="flex items-center gap-1">
          {[...Array(5)].map((_, i) => (
            <svg
              key={i}
              className={cn('h-4 w-4', i < row.rating ? 'text-amber-400' : 'text-gray-300')}
              fill="currentColor"
              viewBox="0 0 20 20"
            >
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
            </svg>
          ))}
        </div>
      ),
    },
    {
      key: 'reviewText',
      label: 'Commentaire',
      render: (row) => (
        <p className="max-w-md truncate text-sm">{row.reviewText || 'Aucun commentaire'}</p>
      ),
    },
    {
      key: 'platformType',
      label: 'Plateforme',
      render: (row) => (
        <span className="rounded-full bg-violet-100 px-3 py-1 text-xs font-medium text-violet-700 dark:bg-violet-900/30 dark:text-violet-400">
          {row.platformType}
        </span>
      ),
    },
    {
      key: 'likes',
      label: 'Likes',
      render: (row) => (
        <div className="flex items-center gap-3">
          <span className="flex items-center gap-1 text-sm">
            <svg className="h-4 w-4 text-emerald-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z" />
            </svg>
            {row.likes}
          </span>
          <span className="flex items-center gap-1 text-sm">
            <svg className="h-4 w-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M18 9.5a1.5 1.5 0 11-3 0v-6a1.5 1.5 0 013 0v6zM14 9.667v-5.43a2 2 0 00-1.105-1.79l-.05-.025A4 4 0 0011.055 2H5.64a2 2 0 00-1.962 1.608l-1.2 6A2 2 0 004.44 12H8v4a2 2 0 002 2 1 1 0 001-1v-.667a4 4 0 01.8-2.4l1.4-1.866a4 4 0 00.8-2.4z" />
            </svg>
            {row.dislikes}
          </span>
        </div>
      ),
    },
    {
      key: 'createdAt',
      label: 'Date',
      sortable: true,
      render: (row) => formatDate(row.createdAt),
    },
  ];

  const userColumns: Column<AppUser>[] = [
    {
      key: 'username',
      label: 'Utilisateur',
      render: (row) => (
        <div className="flex items-center gap-3">
          <div className="h-10 w-10 rounded-full bg-gradient-to-br from-violet-500 to-purple-500 flex items-center justify-center text-white font-bold">
            {row.username.charAt(0).toUpperCase()}
          </div>
          <div>
            <p className="font-medium">{row.username}</p>
            <p className="text-xs text-gray-500">{row.email}</p>
          </div>
        </div>
      ),
    },
    {
      key: 'role',
      label: 'Rôle',
      render: (row) => (
        <span
          className={cn(
            'inline-flex rounded-full px-3 py-1 text-xs font-medium',
            row.role === 'SUPER_ADMIN' && 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400',
            row.role === 'ADMIN' && 'bg-violet-100 text-violet-700 dark:bg-violet-900/30 dark:text-violet-400',
            row.role === 'USER' && 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400'
          )}
        >
          {row.role}
        </span>
      ),
    },
    {
      key: 'phone',
      label: 'Téléphone',
      render: (row) => row.phone || '-',
    },
    {
      key: 'isActive',
      label: 'Statut',
      render: (row) => (
        <span
          className={cn(
            'inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium',
            row.isActive
              ? 'bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400'
              : 'bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400'
          )}
        >
          <span className={cn('h-2 w-2 rounded-full', row.isActive ? 'bg-emerald-500' : 'bg-gray-400')} />
          {row.isActive ? 'Actif' : 'Inactif'}
        </span>
      ),
    },
    {
      key: 'createdAt',
      label: 'Date d\'inscription',
      sortable: true,
      render: (row) => formatDate(row.createdAt),
    },
  ];

  const categoryData = React.useMemo(() => {
    const categories = pois.reduce((acc, poi) => {
      acc[poi.poi_category] = (acc[poi.poi_category] || 0) + 1;
      return acc;
    }, {} as Record<string, number>);

    return Object.entries(categories).map(([label, value]) => ({
      label: getPoiCategoryLabel(label),
      value,
    }));
  }, [pois]);

  const monthlyData = [
    { label: 'Jan', value: 65 },
    { label: 'Fév', value: 59 },
    { label: 'Mar', value: 80 },
    { label: 'Avr', value: 81 },
    { label: 'Mai', value: 56 },
    { label: 'Juin', value: 55 },
    { label: 'Juil', value: 70 },
  ];

  const renderDashboard = () => (
    <div className="space-y-6">
      {/* Stats Grid */}
      <div className="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
        <StatsCard
          title="Points d'Intérêt"
          value={formatCompactNumber(dashboardData.totalPois)}
          subtitle={`${dashboardData.activePois} actifs`}
          variant="default"
          icon={
            <svg className="h-6 w-6 text-violet-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            </svg>
          }
          trend={{ direction: 'up', percentage: 12.5 }}
        />
        <StatsCard
          title="Utilisateurs"
          value={formatCompactNumber(dashboardData.totalUsers)}
          variant="accent"
          icon={
            <svg className="h-6 w-6 text-fuchsia-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
            </svg>
          }
          trend={{ direction: 'up', percentage: 8.2 }}
        />
        <StatsCard
          title="Avis"
          value={formatCompactNumber(dashboardData.totalReviews)}
          subtitle={`${dashboardData.averageRating.toFixed(1)} ⭐ moyenne`}
          variant="success"
          icon={
            <svg className="h-6 w-6 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
            </svg>
          }
          trend={{ direction: 'up', percentage: 15.3 }}
        />
        <StatsCard
          title="Vues totales"
          value={formatCompactNumber(dashboardData.totalViews)}
          variant="warning"
          icon={
            <svg className="h-6 w-6 text-amber-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
          }
          trend={{ direction: 'up', percentage: 23.1 }}
        />
      </div>

      {/* Charts */}
      <div className="grid gap-6 lg:grid-cols-2">
        <Chart type="area" data={monthlyData} title="POIs créés par mois" />
        <Chart type="doughnut" data={categoryData} title="Répartition par catégorie" />
      </div>

      {/* Recent Activity */}
      <RecentActivity activities={recentActivities} />
    </div>
  );

  return (
    <div className="flex min-h-screen bg-gray-50 dark:bg-gray-900">
      <Sidebar currentSection={currentSection} onNavigate={setCurrentSection} />
      
      <main className="flex-1 overflow-auto">
        <div className="mx-auto max-w-7xl p-6 lg:p-8">
          {/* Header */}
          <header className="mb-8">
            <h1 className="text-3xl font-bold text-gray-900 dark:text-white">
              {currentSection === 'dashboard' && 'Tableau de bord'}
              {currentSection === 'pois' && 'Gestion des POIs'}
              {currentSection === 'reviews' && 'Gestion des Avis'}
              {currentSection === 'users' && 'Gestion des Utilisateurs'}
              {currentSection === 'organizations' && 'Gestion des Organisations'}
              {currentSection === 'analytics' && 'Analytiques'}
              {currentSection === 'content' && 'Contenu'}
              {currentSection === 'settings' && 'Paramètres'}
            </h1>
            <p className="mt-2 text-gray-600 dark:text-gray-400">
              {currentSection === 'dashboard' && 'Vue d\'ensemble de votre plateforme'}
              {currentSection === 'pois' && 'Gérez tous vos points d\'intérêt'}
              {currentSection === 'reviews' && 'Modérez et analysez les avis'}
              {currentSection === 'users' && 'Administrez les comptes utilisateurs'}
            </p>
          </header>

          {/* Content */}
          {loading ? (
            <div className="flex items-center justify-center py-12">
              <div className="h-12 w-12 animate-spin rounded-full border-4 border-violet-500 border-t-transparent" />
            </div>
          ) : (
            <>
              {currentSection === 'dashboard' && renderDashboard()}
              {currentSection === 'pois' && (
                <DataTable
                  columns={poiColumns}
                  data={pois}
                  searchPlaceholder="Rechercher un POI..."
                  actions={(row) => (
                    <div className="flex gap-2">
                      <button className="rounded-lg p-2 hover:bg-violet-100 dark:hover:bg-violet-900/30">
                        <svg className="h-5 w-5 text-violet-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                      </button>
                      <button className="rounded-lg p-2 hover:bg-red-100 dark:hover:bg-red-900/30">
                        <svg className="h-5 w-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                      </button>
                    </div>
                  )}
                />
              )}
              {currentSection === 'reviews' && (
                <DataTable
                  columns={reviewColumns}
                  data={reviews}
                  searchPlaceholder="Rechercher un avis..."
                />
              )}
              {currentSection === 'users' && (
                <DataTable
                  columns={userColumns}
                  data={users}
                  searchPlaceholder="Rechercher un utilisateur..."
                />
              )}
            </>
          )}
        </div>
      </main>

      <style jsx global>{`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @keyframes fadeInLeft {
          from {
            opacity: 0;
            transform: translateX(-20px);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }
      `}</style>
    </div>
  );
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\admin\layout.tsx
================================================================================

import type { Metadata } from 'next';

export const metadata: Metadata = {
  title: 'POI Navigoo - Admin Dashboard',
  description: 'Dashboard d\'administration pour la gestion des points d\'intérêt',
};

export default function AdminLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="fr">
      <body>{children}</body>
    </html>
  );
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\profile\page.tsx
================================================================================

"use client";

import { useState, useEffect } from "react";
import { useRouter } from "next/navigation";
import Image from "next/image";
import { 
  User, Mail, Phone, Lock, Camera, LogOut, 
  MapPin, Route, Star, LayoutDashboard, ChevronRight, 
  Settings, Building2, Calendar
} from "lucide-react";
import { authService } from "@/services/authService";
import { poiService } from "@/services/poiService";
import { useUserData } from "@/hooks/useUserData";
import { AppUser, POI } from "@/types";
import { Button } from "@/components/ui/Button";
import { Loader } from "@/components/ui/Loader";

export default function ProfilePage() {
  const router = useRouter();
  const [user, setUser] = useState<AppUser | null>(null);
  const [userPoi, setUserPoi] = useState<POI | null>(null);
  const [loading, setLoading] = useState(true);
  
  const { recentPois, recentTrips } = useUserData();

  useEffect(() => {
    const initProfile = async () => {
      const session = authService.getSession();
      
      if (!session) {
        router.push("/signin");
        return;
      }

      // REDIRECTION SI SUPERADMIN
      if (session.role === "SUPER_ADMIN") {
        router.push("/admin");
        return;
      }

      setUser(session);

      // Charger le POI de l'utilisateur s'il existe
      try {
        const pois = await poiService.getPoisByUser(session.userId);
        if (pois && pois.length > 0) {
            setUserPoi(pois[0]); // On prend le premier
        }
      } catch (err) {
        console.error("Erreur POI", err);
      } finally {
        setLoading(false);
      }
    };

    initProfile();
  }, [router]);

  const handleLogout = () => {
    authService.logout();
  };

  if (loading) return <Loader />;

  return (
    <div className="min-h-screen bg-zinc-50 dark:bg-black flex flex-col md:flex-row font-sans">
      
      {/* --- SIDEBAR GAUCHE : INFOS UTILISATEUR --- */}
      <div className="w-full md:w-[350px] bg-white dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800 p-8 flex flex-col shrink-0">
        
        {/* Photo de Profil */}
        <div className="relative w-32 h-32 mx-auto mb-6 group">
            <div className="w-full h-full rounded-3xl bg-primary/10 flex items-center justify-center overflow-hidden border-2 border-primary/20">
               {/* Simuler photo ou Initiale */}
               <span className="text-4xl font-black text-primary">
                 {user?.username.charAt(0).toUpperCase()}
               </span>
            </div>
            <button className="absolute -bottom-2 -right-2 p-2.5 bg-primary text-white rounded-xl shadow-lg hover:scale-110 transition-transform">
                <Camera size={18} />
            </button>
        </div>

        <div className="text-center mb-8">
            <h1 className="text-2xl font-black text-zinc-900 dark:text-white">{user?.username}</h1>
            <p className="text-xs font-bold text-primary uppercase tracking-widest mt-1 bg-primary/5 py-1 px-3 rounded-full inline-block">
                Explorateur Navigoo
            </p>
        </div>

        {/* Champs Infos */}
        <div className="space-y-4 flex-1">
            <InfoBox icon={<Mail size={18}/>} label="Email" value={user?.email || "N/A"} />
            <InfoBox icon={<Phone size={18}/>} label="Téléphone" value={user?.phone || "Non renseigné"} />
            <InfoBox icon={<Lock size={18}/>} label="Mot de passe" value="••••••••••••" />
            <InfoBox icon={<Calendar size={18}/>} label="Membre depuis" value={new Date(user?.createdAt || Date.now()).toLocaleDateString('fr-FR', {month: 'long', year: 'numeric'})} />
        </div>

        {/* Boutons Actions Basiques */}
        <div className="mt-auto space-y-3 pt-6 border-t border-zinc-100 dark:border-zinc-800">
            <Button variant="outline" className="w-full justify-start gap-3 h-12" onClick={() => router.push("/")}>
                <MapPin size={20}/> Retour à la carte
            </Button>
            <Button onClick={handleLogout} className="w-full justify-start gap-3 h-12 bg-red-50 text-red-600 hover:bg-red-100 border-none shadow-none font-bold">
                <LogOut size={20}/> Se déconnecter
            </Button>
        </div>
      </div>

      {/* --- CONTENU CENTRAL : ACTIVITÉ --- */}
      <main className="flex-1 overflow-y-auto p-4 md:p-12 space-y-12 pb-24">
        
        <header className="max-w-4xl">
            <h2 className="text-4xl font-black text-zinc-900 dark:text-white mb-2">Tableau de Bord</h2>
            <p className="text-zinc-500">Bienvenue chez vous. Gérez vos découvertes et vos lieux favoris.</p>
        </header>

        {/* --- SECTION "MON POI" (SI EXISTE) --- */}
        {userPoi ? (
            <section className="max-w-5xl">
                <div className="flex items-center gap-3 mb-6">
                    <Building2 className="text-primary" size={24} />
                    <h3 className="text-xl font-bold dark:text-white">Votre établissement</h3>
                </div>
                <div className="bg-gradient-to-r from-violet-600 to-indigo-700 rounded-[2.5rem] p-8 text-white flex flex-col md:flex-row items-center gap-8 shadow-2xl shadow-primary/20">
                    <div className="w-32 h-32 relative rounded-2xl overflow-hidden shrink-0 shadow-lg border-4 border-white/20">
                        <Image src={userPoi.poi_images_urls[0] || "/images/placeholder.png"} alt="" fill className="object-cover" />
                    </div>
                    <div className="flex-1">
                        <h4 className="text-3xl font-black mb-1">{userPoi.poi_name}</h4>
                        <div className="flex items-center gap-4 text-white/80 text-sm mb-4">
                            <span className="flex items-center gap-1 font-bold"><Star size={16} fill="white" className="text-yellow-400" /> {userPoi.rating}</span>
                            <span className="px-2 py-0.5 bg-white/20 rounded-md text-xs">{userPoi.poi_category}</span>
                            <span>{userPoi.address_city}</span>
                        </div>
                        <Button onClick={() => router.push(`/add-poi?id=${userPoi.poi_id}`)} className="bg-white text-primary font-black px-8 py-3 rounded-xl hover:bg-zinc-100">
                           Gérer les infos
                        </Button>
                    </div>
                </div>
            </section>
        ) : (
            /* Call to Action si pas de POI */
            <div className="p-8 border-2 border-dashed border-zinc-200 dark:border-zinc-800 rounded-[2rem] flex flex-col items-center text-center max-w-4xl">
                <div className="w-16 h-16 bg-zinc-100 dark:bg-zinc-900 rounded-2xl flex items-center justify-center text-zinc-400 mb-4">
                    <Building2 size={32} />
                </div>
                <h3 className="text-xl font-bold dark:text-white mb-2">Vous avez un commerce ?</h3>
                <p className="text-zinc-500 text-sm mb-6 max-w-xs">Enregistrez votre lieu sur Navigoo et soyez visible par des milliers d'explorateurs.</p>
                <Button onClick={() => router.push("/add-poi")} className="font-bold">Publier mon lieu</Button>
            </div>
        )}

        <div className="grid grid-cols-1 lg:grid-cols-2 gap-10 max-w-5xl">
            
            {/* --- LIEUX RÉCENTS --- */}
            <section>
                <h3 className="text-xl font-black dark:text-white mb-6 flex items-center gap-3">
                    <MapPin className="text-zinc-400" size={20} /> Consultés récemment
                </h3>
                <div className="space-y-4">
                    {recentPois.length > 0 ? (
                        recentPois.slice(0, 4).map(poi => (
                            <ActivityCard key={poi.poi_id} title={poi.poi_name} sub={poi.poi_category} img={poi.poi_images_urls[0]} />
                        ))
                    ) : (
                        <p className="text-zinc-400 italic text-sm">Pas d'activité récente.</p>
                    )}
                </div>
            </section>

            {/* --- TRAJETS RÉCENTS --- */}
            <section>
                <h3 className="text-xl font-black dark:text-white mb-6 flex items-center gap-3">
                    <Route className="text-zinc-400" size={20} /> Derniers itinéraires
                </h3>
                <div className="space-y-4">
                    {recentTrips.length > 0 ? (
                        recentTrips.slice(0, 4).map(trip => (
                            <div key={trip.id} className="flex items-center gap-4 p-4 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl">
                                <div className="p-3 bg-zinc-50 dark:bg-zinc-800 rounded-xl">
                                    <Route size={20} className="text-zinc-500" />
                                </div>
                                <div className="flex-1 min-w-0">
                                    <p className="font-bold text-zinc-900 dark:text-zinc-100 truncate">{trip.arriveName}</p>
                                    <p className="text-[11px] text-zinc-400 uppercase font-black">{Math.round(trip.distance / 1000)} km parcourus</p>
                                </div>
                                <ChevronRight size={16} className="text-zinc-300" />
                            </div>
                        ))
                    ) : (
                        <p className="text-zinc-400 italic text-sm">Aucun trajet enregistré.</p>
                    )}
                </div>
            </section>

        </div>
      </main>

    </div>
  );
}

// --- SOUS COMPOSANTS DE STYLE ---

const InfoBox = ({ icon, label, value }: { icon: any, label: string, value: string }) => (
    <div className="p-4 bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-2xl flex items-center gap-4">
        <div className="text-zinc-400">{icon}</div>
        <div className="overflow-hidden">
            <p className="text-[10px] font-black uppercase text-zinc-400 tracking-widest">{label}</p>
            <p className="text-sm font-bold text-zinc-700 dark:text-zinc-300 truncate">{value}</p>
        </div>
    </div>
);

const ActivityCard = ({ title, sub, img }: { title: string, sub: string, img?: string }) => (
    <div className="group flex items-center gap-4 p-3 bg-white dark:bg-zinc-900 hover:border-primary border border-zinc-100 dark:border-zinc-800 rounded-2xl cursor-pointer transition-all shadow-sm">
        <div className="w-14 h-14 rounded-xl relative overflow-hidden bg-zinc-100">
            {img && <Image src={img} alt="" fill className="object-cover group-hover:scale-110 transition-transform" />}
        </div>
        <div className="flex-1 min-w-0">
            <p className="font-bold text-zinc-900 dark:text-zinc-100 truncate">{title}</p>
            <p className="text-xs text-zinc-500">{sub}</p>
        </div>
        <ChevronRight size={16} className="text-zinc-300 mr-2" />
    </div>
);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\add-content\page.tsx
================================================================================

"use client";

import { Suspense, useState } from "react";
import { useSearchParams, useRouter } from "next/navigation";
import { contentService } from "@/services/contentService";
import { authService } from "@/services/authService";
import { Button } from "@/components/ui/Button";
import { FormInput } from "@/components/ui/form/FormInput";
import { FileText, Mic, Save, ArrowLeft, Loader2 } from "lucide-react";

function ContentForm() {
  const router = useRouter();
  const searchParams = useSearchParams();
  const type = searchParams.get("type"); // blog | podcast
  const poiId = searchParams.get("poiId");
  const user = authService.getSession();

  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    title: "",
    content: "",
    url: "", // audio ou cover
  });

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!poiId || !user) return;
    setLoading(true);

    try {
        if (type === "blog") {
            await contentService.createBlog({
                user_id: user.userId,
                poi_id: poiId,
                title: formData.title,
                content: formData.content,
                is_active: true
            });
        } else {
            await contentService.createPodcast({
                user_id: user.userId,
                poi_id: poiId,
                title: formData.title,
                audio_file_url: formData.url,
                duration_seconds: 120, // simulation
                is_active: true
            });
        }
        alert("Publication réussie !");
        router.back();
    } catch (err) {
        alert("Erreur lors de la publication.");
    } finally {
        setLoading(false);
    }
  };

  return (
    <div className="max-w-2xl mx-auto p-8 pt-20">
      <button onClick={() => router.back()} className="flex items-center gap-2 text-zinc-500 mb-8">
        <ArrowLeft size={20}/> Retour
      </button>
      
      <div className="bg-white dark:bg-zinc-900 p-8 rounded-[2rem] shadow-xl border border-zinc-100 dark:border-zinc-800">
        <div className="flex items-center gap-4 mb-8">
          <div className="p-4 bg-primary/10 rounded-2xl text-primary">
            {type === 'blog' ? <FileText size={32}/> : <Mic size={32}/>}
          </div>
          <div>
            <h1 className="text-2xl font-black dark:text-white">Créer un {type}</h1>
            <p className="text-sm text-zinc-500">Ajouter du contenu riche pour ce lieu.</p>
          </div>
        </div>

        <form onSubmit={handleSubmit} className="space-y-6">
            <FormInput 
                label="Titre" icon={<Mic size={18}/>} 
                value={formData.title} onChange={(e) => setFormData({...formData, title: e.target.value})} 
            />
            
            {type === 'blog' ? (
                <FormInput 
                    as="textarea" label="Contenu de l'article" icon={<FileText size={18}/>} 
                    value={formData.content} onChange={(e) => setFormData({...formData, content: e.target.value})}
                />
            ) : (
                <FormInput 
                    label="URL du fichier audio" icon={<Mic size={18}/>} 
                    placeholder="https://..."
                    value={formData.url} onChange={(e) => setFormData({...formData, url: e.target.value})}
                />
            )}

            <Button disabled={loading} className="w-full h-14 rounded-2xl gap-2 font-bold text-lg">
                {loading ? <Loader2 className="animate-spin" /> : <><Save size={20}/> Publier maintenant</>}
            </Button>
        </form>
      </div>
    </div>
  );
}

export default function AddContentPage() {
    return (
        <Suspense><ContentForm/></Suspense>
    )
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\page.tsx
================================================================================

"use client";

import { useMemo, useState, useEffect } from "react";
import dynamic from "next/dynamic";
import { TopLayout } from "@/components/navigation/TopLayout";
import { Sidebar } from "@/components/sidebar/Sidebar";
import { PoiDetailsSidebar } from "@/components/sidebar/POIDetailsSidebar";
import { DirectionsSidebar } from "@/components/sidebar/DirectionSidebar";
import { SecondarySidebar } from "@/components/sidebar/SecondarySidebar";
import { POI, Location, TransportMode } from "@/types";
import { getRoute, calculateDistance } from "@/services/routingService";
import { poiService } from "@/services/poiService";
import { useUserData } from "@/hooks/useUserData";
import { Settings as SettingsIcon, Check, X, AlertTriangle } from "lucide-react";
import { Loader } from "@/components/ui/Loader";
import { MobileNavBar } from "@/components/navigation/MobileNavbar";
import { authService } from "@/services/authService";
import { reverseGeocode } from "@/services/geocodingService";
import { useGeolocation } from "@/hooks/useGeolocation";
import { captureMap, shareMap } from "@/services/mapCaptureService";

// Import Map Dynamique sans SSR
const MapComponent = dynamic(() => import("@/components/map/Map"), {
  ssr: false,
  loading: () => <Loader />,
});

const MAPTILER_API_KEY = "Lr72DkH8TYyjpP7RNZS9"; 

export default function Home() {
  // États d'interface
  const [isMainSidebarOpen, setIsMainSidebarOpen] = useState(false);
  const [panelState, setPanelState] = useState<{
     type: "details" | "directions" | "saved" | "recent" | "trips" | "mypois" | null;
     data?: any; 
  }>({ type: null });
  
  // États de Données (Backend Integration)
  const [allPois, setAllPois] = useState<POI[]>([]);
  const [isLoadingPois, setIsLoadingPois] = useState(true);
  const [fetchError, setFetchError] = useState<string | null>(null);

  // Hooks Persistance Utilisateur
  const { 
    savedPois, recentPois, recentTrips, mapStyle, 
    addRecentPoi, addTrip, toggleMapStyle, myPois, loadUserPois 
  } = useUserData();

  // États Recherche & Carte
  const [isSettingsOpen, setIsSettingsOpen] = useState(false);
  const [searchQuery, setSearchQuery] = useState("");
  const [selectedCategory, setSelectedCategory] = useState("");
  
  // États Routage
  const [routeStats, setRouteStats] = useState<any>(null);
  const [routeGeometry, setRouteGeometry] = useState<any>(null);
  const [isRouteLoading, setIsRouteLoading] = useState(false);
  const [activeTransportMode, setActiveTransportMode] = useState<TransportMode>("driving");

  // États pour la navigation GPS
  const [isNavigating, setIsNavigating] = useState(false);
  const [traveledPath, setTraveledPath] = useState<Location[]>([]);

  // ✅ CORRECTION : On utilise uniquement le hook useGeolocation (plus de state séparé)
  const { 
    position: userLocation,  // Renommage direct ici
    isTracking, 
    startTracking, 
    stopTracking,
    getCurrentPosition 
  } = useGeolocation();

  // ============================================
  // INITIALISATION (Géoloc + Fetch API)
  // ============================================
  
  useEffect(() => {
     let mounted = true;

     const loadAllPois = async () => {
        try {
            if(mounted) setIsLoadingPois(true);
            const data = await poiService.getAllPois();
            if(mounted) setAllPois(data || []);
        } catch (error) {
            console.error("Erreur chargement POIs:", error);
            if(mounted) setFetchError("Impossible de contacter le serveur.");
        } finally {
            if(mounted) setIsLoadingPois(false);
        }
     };

     const loadLocalPois = async (lat: number, lon: number) => {
        try {
            if(mounted) setIsLoadingPois(true);
            const data = await poiService.searchPoisByLocation(lat, lon, 50);
            
            if (!data || data.length === 0) {
               console.warn("Pas de POIs proches, chargement global.");
               await loadAllPois();
            } else {
               if(mounted) setAllPois(data);
            }
        } catch (err) {
            console.error("Erreur recherche locale, repli sur tout:", err);
            await loadAllPois();
        } finally {
            if(mounted) setIsLoadingPois(false);
        }
     };

     // ✅ Utilisation du hook getCurrentPosition au lieu de navigator.geolocation
     getCurrentPosition()
       .then(loc => {
         if (mounted) {
           loadLocalPois(loc.latitude, loc.longitude);
         }
       })
       .catch(() => {
         console.warn("Géolocalisation échouée, chargement de tous les POIs");
         loadAllPois();
       });

     return () => { mounted = false; };
  }, [getCurrentPosition]);

  useEffect(() => {
    if (panelState.type === "mypois") {
        const user = authService.getSession(); 
        if (user?.userId) {
            loadUserPois(user.userId); 
        } else {
            console.warn("Utilisateur non connecté, impossible de charger 'Mes POIs'");
        }
    }
  }, [panelState.type, loadUserPois]);

  // ============================================
  // HANDLERS INTERFACE
  // ============================================

  const handleSelectPoi = (poi: POI | null) => {
    if(!poi) {
        setPanelState({ type: null });
        return;
    }
    const safePoi = { ...poi, poi_images_urls: poi.poi_images_urls || [] };
    
    addRecentPoi(safePoi);
    setIsMainSidebarOpen(false); 
    setPanelState({ type: "details", data: safePoi });
  };

  const handleViewChange = (view: "saved" | "recent" | "trips" | "mypois") => {
    setIsMainSidebarOpen(false);
    setPanelState({ type: view });
  };

  const handleOpenDirections = () => {
    if (panelState.type === "details" && panelState.data) {
        setPanelState({ type: "directions", data: panelState.data });
        handleCalculateRoute(panelState.data, "driving");
    }
  };

  const handleCalculateRoute = async (destination: POI, mode: TransportMode) => {
    if (!userLocation) {
      alert("Impossible de calculer l'itinéraire sans votre position.");
      return;
    }
    
    setActiveTransportMode(mode);
    setIsRouteLoading(true);

    const result = await getRoute(userLocation, destination.location, mode, MAPTILER_API_KEY);
    
    if (result) {
        addTrip({
            id: Date.now().toString(),
            departName: "Ma Position",
            arriveName: destination.poi_name,
            date: new Date().toISOString(),
            distance: result.distance,
            duration: result.duration
        });
        setRouteStats(result);
        setRouteGeometry(result.geometry);
    } else {
        alert("Impossible de calculer l'itinéraire.");
    }
    setIsRouteLoading(false);
  };

  const handleClosePanel = () => {
    setPanelState({ type: null });
    setRouteGeometry(null); 
    setRouteStats(null);
    handleStopNavigation(); // Arrêter la navigation si active
  };

  const handleResetToMap = () => {
    setPanelState({ type: null });
    setIsMainSidebarOpen(false);
    handleStopNavigation();
  };

  // HANDLER OPTIMISÉ POUR LE CLIC SUR LA CARTE
  const handleMapClick = async (lng: number, lat: number) => {
    try {
      const externalPoi = await reverseGeocode(lat, lng);
      
      if (externalPoi) {
        setPanelState({ 
          type: "details", 
          data: externalPoi as POI 
        });
      }
    } catch (error) {
      console.error("Erreur lors du clic sur la carte:", error);
    }
  };

  // ============================================
  // NAVIGATION GPS
  // ============================================

  const handleStartNavigation = () => {
    if (!userLocation || !panelState.data) {
      alert("Position ou destination manquante");
      return;
    }

    setIsNavigating(true);
    setTraveledPath([userLocation]); // Début du trajet
    startTracking(); // Activer le suivi GPS continu
    
    console.log("🚀 Navigation démarrée");
  };

  const handleStopNavigation = () => {
    setIsNavigating(false);
    setTraveledPath([]);
    stopTracking();
    console.log("🛑 Navigation arrêtée");
  };

  // Mise à jour du chemin parcouru
  useEffect(() => {
    if (isNavigating && userLocation) {
      setTraveledPath(prev => {
        // Éviter les doublons trop proches
        const lastPoint = prev[prev.length - 1];
        if (lastPoint) {
          const dist = calculateDistance(lastPoint, userLocation);
          if (dist < 5) return prev; // Ignorer si < 5m
        }
        return [...prev, userLocation];
      });

      // Vérifier si on est arrivé (distance < 20m)
      if (panelState.data?.location) {
        const distanceToDestination = calculateDistance(userLocation, panelState.data.location);
        if (distanceToDestination < 20) {
          alert("🎉 Vous êtes arrivé à destination !");
          handleStopNavigation();
        }
      }
    }
  }, [isNavigating, userLocation, panelState.data]);

  // Filtrage Local
  const filteredPois = useMemo(() => {
    return allPois.filter((poi) => {
      const catMatch = selectedCategory ? (poi.poi_category === selectedCategory) : true;
      const nameMatch = searchQuery 
        ? (poi.poi_name?.toLowerCase().includes(searchQuery.toLowerCase())) 
        : true;
      const activeMatch = poi.is_active !== false; 

      return catMatch && nameMatch && activeMatch;
    });
  }, [selectedCategory, searchQuery, allPois]);

  return (
    <main className="relative h-screen w-screen overflow-hidden bg-zinc-50 dark:bg-black font-sans">
      
      {isLoadingPois && <Loader className="z-[9999]" />}

      {fetchError && !isLoadingPois && (
        <div className="absolute top-24 left-1/2 -translate-x-1/2 z-50 bg-red-100 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-center gap-3 shadow-xl animate-in fade-in slide-in-from-top-5">
            <AlertTriangle size={20} />
            <span className="text-sm font-medium">{fetchError}</span>
            <button onClick={() => setFetchError(null)} className="ml-2 hover:bg-red-200 p-1 rounded-full"><X size={16}/></button>
        </div>
      )}

      <TopLayout 
        onToggleSidebar={() => setIsMainSidebarOpen(!isMainSidebarOpen)}
        allPois={allPois}
        selectedCategory={selectedCategory}
        onSelectCategory={(id) => setSelectedCategory(prev => prev === id ? "" : id)}
        onSearch={setSearchQuery}
        onSelectResult={handleSelectPoi}
        onLocateMe={async () => {
          try {
            const pos = await getCurrentPosition();
            console.log("📍 Position obtenue:", pos);
          } catch (err) {
            alert("Impossible d'obtenir votre position");
          }
        }}
        recentSearches={[]}
        recentPois={recentPois}
      />

      <Sidebar 
        isOpen={isMainSidebarOpen} 
        onClose={() => setIsMainSidebarOpen(false)}
        onViewChange={handleViewChange}
        onLocateMe={async () => {
          try {
            await getCurrentPosition();
          } catch (err) {
            alert("Géolocalisation échouée");
          }
        }}
        onShare={shareMap}
        onPrint={captureMap}
        onToggleSettings={() => setIsSettingsOpen(true)}
      />

      <MobileNavBar 
        currentView={panelState.type === "details" || panelState.type === "directions" ? null : panelState.type}
        onViewChange={handleViewChange}
        onOpenSidebar={() => setIsMainSidebarOpen(true)}
        onResetView={handleResetToMap}
      />

      {panelState.type === "details" && panelState.data && (
        <PoiDetailsSidebar 
          poi={panelState.data} 
          isOpen={true}
          onClose={handleClosePanel}
          onOpenDirections={handleOpenDirections}
        />
      )}

      {panelState.type === "directions" && panelState.data && (
        <DirectionsSidebar 
            isOpen={true}
            onClose={handleClosePanel}
            originPoi={null}
            destinationPoi={panelState.data}
            userLocation={userLocation}
            activeMode={activeTransportMode}
            isLoadingRoute={isRouteLoading}
            routeStats={routeStats}
            onCalculateRoute={(mode) => handleCalculateRoute(panelState.data, mode)}
            onStartNavigation={handleStartNavigation}
            onStopNavigation={handleStopNavigation}
            isNavigating={isNavigating}
        />
      )}

      {(["saved", "recent", "trips", "mypois"].includes(panelState.type || "")) && (
          <SecondarySidebar 
             view={panelState.type}
             onClose={handleClosePanel}
             data={{ savedPois, recentPois, trips: recentTrips }}
             onSelectPoi={handleSelectPoi}
          />
      )}

      {isSettingsOpen && (
         <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4">
             <div className="bg-white dark:bg-zinc-900 rounded-2xl w-full max-w-sm p-6 shadow-2xl">
                 <div className="flex justify-between items-center mb-6">
                    <h2 className="text-xl font-bold flex items-center gap-2 text-zinc-800 dark:text-white">
                        <SettingsIcon className="text-primary" /> Apparence
                    </h2>
                    <button onClick={() => setIsSettingsOpen(false)} className="p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full text-zinc-500"><X/></button>
                 </div>
                 <div className="grid grid-cols-2 gap-4">
                    <button 
                       onClick={() => { toggleMapStyle(); setIsSettingsOpen(false); }}
                       className={`p-4 rounded-xl border-2 flex flex-col items-center gap-3 transition-all ${mapStyle === 'streets-v2' ? 'border-primary bg-primary/5' : 'border-zinc-200 dark:border-zinc-700'}`}
                    >
                        <div className="w-full h-20 bg-zinc-200 rounded-lg bg-cover bg-center" style={{backgroundImage: "url('https://cloud.maptiler.com/static/img/maps/streets-v2.png')"}}></div>
                        <span className="font-semibold text-sm text-zinc-700 dark:text-zinc-200">Plan</span>
                        {mapStyle === 'streets-v2' && <Check size={16} className="text-primary"/>}
                    </button>
                    <button 
                       onClick={() => { toggleMapStyle(); setIsSettingsOpen(false); }}
                       className={`p-4 rounded-xl border-2 flex flex-col items-center gap-3 transition-all ${mapStyle === 'hybrid' ? 'border-primary bg-primary/5' : 'border-zinc-200 dark:border-zinc-700'}`}
                    >
                         <div className="w-full h-20 bg-zinc-700 rounded-lg bg-cover bg-center" style={{backgroundImage: "url('https://cloud.maptiler.com/static/img/maps/hybrid.png')"}}></div>
                        <span className="font-semibold text-sm text-zinc-700 dark:text-zinc-200">Satellite</span>
                        {mapStyle === 'hybrid' && <Check size={16} className="text-primary"/>}
                    </button>
                 </div>
             </div>
         </div>
      )}

      <div className="absolute top-0 left-0 w-full h-full z-0 print:block">
        <MapComponent 
          apiKey={MAPTILER_API_KEY} 
          pois={filteredPois}
          selectedPoi={panelState.type === "details" || panelState.type === "directions" ? panelState.data : null}
          userLocation={userLocation}
          onSelectPoi={handleSelectPoi}
          routeGeometry={routeGeometry}
          mapStyleType={mapStyle} 
          onMapEmptyClick={handleMapClick}
          isNavigating={isNavigating}
          traveledPath={traveledPath}
        />
      </div>

    </main>
  );
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\layout.tsx
================================================================================

import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";
import "maplibre-gl/dist/maplibre-gl.css"; // Garde-le ici, ou déplace-le dans layout.tsx pour gagner encore + de vitesse

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}



================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\app\globals.css
================================================================================

@import "tailwindcss";

@theme {
  --color-primary: #9400D3;
  --color-primary-dark: #7200a3;
  --color-primary-light: #b64dff;
  --color-background: #ffffff;
  --color-foreground: #171717;
  
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-sans);
  overflow: hidden; /* Empêche le scroll global pour une expérience app map */
}

/* Custom Scrollbar pour le look moderne */
::-webkit-scrollbar {
  width: 6px;
}
::-webkit-scrollbar-track {
  background: transparent;
}
::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 10px;
}
::-webkit-scrollbar-thumb:hover {
  background: #9475aa;
}

@media print {
  body {
    background-color: white;
  }
  /* On cache tout sauf la carte */
  .fixed, .absolute:not(.mapboxgl-map):not(.maplibregl-map), header, aside {
    display: none !important;
  }
  
  /* On s'assure que la carte prend tout */
  main {
    width: 100vw;
    height: 100vh;
    position: absolute;
    top: 0;
    left: 0;
  }

  .maplibregl-map {
      width: 100% !important;
      height: 100% !important;
  }
}






================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\types\index.ts
================================================================================

export interface OperationTimePlan {
  [day: string]: { open: string; close: string; closed?: boolean };
}

export type UserRole = "USER" | "ADMIN" | "SUPER_ADMIN";

export interface Location {
  latitude: number;
  longitude: number;
}

export interface AppUser {
  userId: string;
  organizationId: string;
  username: string;
  email: string;
  phone?: string;
  password?: string;
  role: UserRole;
  isActive: boolean;
  createdAt?: string;
}

export interface POI {
  poi_id: string; 
  organization_id?: string;
  created_by_user_id?: string;
  poi_name: string;
  poi_description?: string;
  poi_category: string; 
  poi_type?: string;

  created_at?: string;
  
  // Supporte les deux formats pour la transition
  latitude?: number;
  longitude?: number;
  
  location: {
    latitude: number;
    longitude: number;
  };

  address_city: string;
  address_informal?: string;
  address_country?: string;
  address_state_province?: string;

  poi_images_urls: string[]; 
  poi_amenities?: string[];
  poi_keywords?: string[];
  
  rating: number; 
  review_count: number;
  popularity_score: number;
  is_active?: boolean;

  poi_contacts?: {
    phone?: string;
    website?: string;
    email?: string;
  };
}

export interface CreatePoiDTO {
  poi_name: string;
  organization_id: string;
  created_by_user_id: string;
  poi_type: string;
  poi_category: string;
  poi_description?: string;
  latitude: number;
  longitude: number;
  address_city?: string;
  address_country: string;
  address_state_province?: string;
  is_active: boolean;
  poi_amenities?: string[];
  poi_keywords?: string[];
}

export interface RouteStats {
  distance: number; 
  duration: number;
  geometry: any;
}

export type TransportMode = "driving" | "walking" | "cycling"; 

export interface Trip {
  id: string;
  departName: string;
  arriveName: string;
  date: string; 
  distance: number;
  duration: number;
}

export type MapStyle = "streets-v2" | "hybrid";

export type PoiCategory = 
  | "FOOD_DRINK" 
  | "ACCOMMODATION" 
  | "SHOPPING_RETAIL" 
  | "TRANSPORTATION" 
  | "HEALTH_WELLNESS" 
  | "LEISURE_CULTURE" 
  | "PUBLIC_ADMIN_SERVICES" 
  | "FINANCE" 
  | "EDUCATION" 
  | "WORSHIP_SPIRITUALITY";

export interface Blog {
  blog_id?: string;
  user_id: string;
  poi_id: string;
  title: string;
  description?: string;
  cover_image_url?: string;
  content: string;
  is_active: boolean;
  created_at?: string;
}

export interface Podcast {
  podcast_id?: string;
  user_id: string;
  poi_id: string;
  title: string;
  description?: string;
  audio_file_url: string;
  cover_image_url?: string;
  duration_seconds: number;
  is_active: boolean;
  created_at?: string;
}

================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\data\categories.tsx
================================================================================

import React from "react";
import { 
  UtensilsCrossed, BedDouble, Bus, Landmark,
  Coffee, ShoppingBag, HeartPulse, Building2, 
  Wallet, GraduationCap, Church, Trees
} from "lucide-react";

export interface CategoryDef {
  id: string;
  label: string;
  icon: React.ReactNode;
  color: string;
}

// IDs mis à jour pour correspondre au POI_CATEGORY du Backend Java
export const CATEGORIES: CategoryDef[] = [
  { id: "FOOD_DRINK", label: "Restauration", icon: <UtensilsCrossed size={16} />, color: "#FF8C00" },
  { id: "ACCOMMODATION", label: "Hébergement", icon: <BedDouble size={16} />, color: "#1E90FF" },
  { id: "SHOPPING_RETAIL", label: "Boutiques", icon: <ShoppingBag size={16} />, color: "#2E8B57" },
  { id: "TRANSPORTATION", label: "Transports", icon: <Bus size={16} />, color: "#00CED1" },
  { id: "HEALTH_WELLNESS", label: "Santé", icon: <HeartPulse size={16} />, color: "#e11d48" },
  { id: "LEISURE_CULTURE", label: "Loisirs & Culture", icon: <Landmark size={16} />, color: "#8A2BE2" },
  { id: "PUBLIC_ADMIN_SERVICES", label: "Services Publics", icon: <Building2 size={16} />, color: "#64748b" },
  { id: "FINANCE", label: "Banques", icon: <Wallet size={16} />, color: "#DAA520" },
  { id: "EDUCATION", label: "Éducation", icon: <GraduationCap size={16} />, color: "#1e293b" },
  { id: "WORSHIP_SPIRITUALITY", label: "Spiritualité", icon: <Church size={16} />, color: "#4B0082" }
];

export const getCategoryConfig = (id: string) => 
    CATEGORIES.find(c => c.id === id) || { id: "OTHER", label: "Autre", icon: <Trees size={16}/>, color: "#94a3b8" };


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\form\FormSection.tsx
================================================================================

import { ReactNode } from "react";
import { motion } from "framer-motion";

interface FormSectionProps {
  children: ReactNode;
  title: string;
  subtitle?: string;
  delay?: number;
}

export const FormSection = ({ children, title, subtitle, delay = 0 }: FormSectionProps) => {
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5, delay }}
      className="bg-white/80 dark:bg-zinc-900/80 backdrop-blur-sm p-6 md:p-8 rounded-3xl border border-zinc-200/50 dark:border-zinc-800 shadow-xl dark:shadow-none h-full flex flex-col"
    >
      <div className="mb-6">
        <h2 className="text-2xl font-bold text-zinc-800 dark:text-white">{title}</h2>
        {subtitle && <p className="text-zinc-500 dark:text-zinc-400 text-sm mt-1">{subtitle}</p>}
      </div>
      <div className="space-y-3 flex-1">
        {children}
      </div>
    </motion.div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\form\FormInput.tsx
================================================================================

import { ReactNode, InputHTMLAttributes, TextareaHTMLAttributes } from "react";
import clsx from "clsx";

interface BaseProps {
  label: string;
  icon: ReactNode;
  className?: string;
}

interface InputProps extends InputHTMLAttributes<HTMLInputElement>, BaseProps {
  as?: "input";
}

interface TextareaProps extends TextareaHTMLAttributes<HTMLTextAreaElement>, BaseProps {
  as: "textarea";
}

type FormInputProps = InputProps | TextareaProps;

export const FormInput = (props: FormInputProps) => {
  const { label, icon, className, ...rest } = props;
  const isTextarea = props.as === "textarea";

  const containerStyles = "relative flex items-center group";
  const iconStyles = "absolute left-4 text-zinc-400 group-focus-within:text-primary transition-colors";
  
  const inputStyles = clsx(
    "w-full pl-12 pr-4 py-4 rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-black/50 text-zinc-900 dark:text-zinc-100",
    "outline-none transition-all font-medium placeholder:text-zinc-400/70",
    "focus:ring-2 focus:ring-primary/20 focus:border-primary",
    isTextarea ? "min-h-[120px] resize-none py-4" : "h-14"
  );

  return (
    <div className={className}>
      <label className="text-xs font-bold text-zinc-500 uppercase tracking-wider mb-2 ml-1 block">
        {label}
      </label>
      <div className={containerStyles}>
        <div className={iconStyles}>{icon}</div>
        {isTextarea ? (
          <textarea className={inputStyles} {...(rest as TextareaHTMLAttributes<HTMLTextAreaElement>)} />
        ) : (
          <input className={inputStyles} {...(rest as InputHTMLAttributes<HTMLInputElement>)} />
        )}
      </div>
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\form\ImageUpload.tsx
================================================================================

import { ChangeEvent } from "react";
import { ImagePlus, X } from "lucide-react";
import Image from "next/image";

interface ImageUploadProps {
  imagePreview: string | null;
  onImageChange: (e: ChangeEvent<HTMLInputElement>) => void;
  onRemove: () => void;
}

export const ImageUpload = ({ imagePreview, onImageChange, onRemove }: ImageUploadProps) => {
  return (
    <div>
       <label className="text-xs font-bold text-zinc-500 uppercase tracking-wider mb-2 ml-1 block">
        Photo principale
      </label>
      {imagePreview ? (
        <div className="relative w-full h-48 rounded-xl overflow-hidden shadow-md group">
          <Image src={imagePreview} alt="Preview" fill className="object-cover" />
          <button type="button" onClick={onRemove} className="absolute top-2 right-2 p-2 bg-black/50 text-white rounded-full hover:bg-red-500 transition-colors">
            <X size={16} />
          </button>
        </div>
      ) : (
        <label className="flex flex-col items-center justify-center w-full h-48 border-2 border-dashed border-zinc-300 dark:border-zinc-700 rounded-xl cursor-pointer hover:bg-violet-50 dark:hover:bg-zinc-800/50 hover:border-primary/50 transition-all group">
          <div className="p-3 bg-white dark:bg-zinc-800 rounded-full shadow-sm mb-3 group-hover:scale-110 transition-transform">
            <ImagePlus size={24} className="text-zinc-400 group-hover:text-primary" />
          </div>
          <span className="text-sm font-medium text-zinc-600 dark:text-zinc-400">Ajouter une photo</span>
          <input type="file" className="hidden" accept="image/*" onChange={onImageChange} />
        </label>
      )}
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\form\FormSelect.tsx
================================================================================

import { ReactNode } from "react";
import { ChevronDown } from "lucide-react";

interface Option {
  id: string;
  label: string;
}

interface FormSelectProps extends React.SelectHTMLAttributes<HTMLSelectElement> {
  label: string;
  icon: ReactNode;
  options: Option[];
}

export const FormSelect = ({ label, icon, options, ...props }: FormSelectProps) => {
  return (
    <div>
      <label className="text-xs font-bold text-zinc-500 uppercase tracking-wider mb-2 ml-1 block">
        {label}
      </label>
      <div className="relative flex items-center group">
        <div className="absolute left-4 text-zinc-400 group-focus-within:text-primary transition-colors">
          {icon}
        </div>
        <select
          {...props}
          className="w-full pl-12 pr-10 h-14 appearance-none rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-black/50 text-zinc-900 dark:text-zinc-100 outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all font-medium cursor-pointer"
        >
          <option value="" disabled>Sélectionner...</option>
          {options.map((opt) => (
            <option key={opt.id} value={opt.id}>
              {opt.label}
            </option>
          ))}
        </select>
        <div className="absolute right-4 text-zinc-400 pointer-events-none">
          <ChevronDown size={20} />
        </div>
      </div>
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\Button.tsx
================================================================================

import { ButtonHTMLAttributes } from "react";
import { clsx } from "clsx";
import { twMerge } from "tailwind-merge";

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: "primary" | "secondary" | "outline" | "ghost";
  size?: "sm" | "md" | "lg";
}

export const Button = ({ className, variant = "primary", size = "md", ...props }: ButtonProps) => {
  const baseStyles = "inline-flex items-center justify-center rounded-full font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed";
  
  const variants = {
    primary: "bg-primary text-white hover:bg-primary-dark shadow-md",
    secondary: "bg-zinc-100 text-zinc-900 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-100",
    outline: "border-2 border-primary text-primary hover:bg-primary/10",
    ghost: "text-zinc-600 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800",
  };

  const sizes = {
    sm: "h-8 px-4 text-xs",
    md: "h-10 px-6 text-sm",
    lg: "h-12 px-8 text-base",
  };

  return <button className={twMerge(clsx(baseStyles, variants[variant], sizes[size], className))} {...props} />;
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\CategoryChip.tsx
================================================================================

import { clsx } from "clsx";

interface ChipProps {
  label: string;
  active: boolean;
  onClick: () => void;
  icon?: React.ReactNode;
}

export const CategoryChip = ({ label, active, onClick, icon }: ChipProps) => {
  return (
    <button
      onClick={onClick}
      className={clsx(
        "flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all shadow-sm border whitespace-nowrap",
        active
          ? "bg-primary text-white border-primary"
          : "bg-white text-zinc-700 border-zinc-200 hover:bg-zinc-50 dark:bg-zinc-900 dark:text-zinc-300 dark:border-zinc-800"
      )}
    >
      {icon && <span className="w-4 h-4">{icon}</span>}
      {label}
    </button>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\ui\Loader.tsx
================================================================================

"use client";

import { clsx } from "clsx";

export const Loader = ({ className }: { className?: string }) => {
  return (
    <div
      className={clsx(
        "flex flex-col items-center justify-center h-full w-full bg-zinc-50 dark:bg-black fixed inset-0 z-[100] overflow-hidden",
        className
      )}
    >
      {/* --- ARRIÈRE PLAN GRILLE --- */}
      {/* Donne un effet technique de cartographie */}
      <div className="absolute inset-0 z-0 opacity-[0.03] dark:opacity-[0.05] pointer-events-none" 
           style={{ 
             backgroundImage: "linear-gradient(#000 1px, transparent 1px), linear-gradient(90deg, #000 1px, transparent 1px)", 
             backgroundSize: "40px 40px" 
           }} 
      />

      <div className="relative z-10 flex flex-col items-center gap-8">
        
        {/* --- CARTE DU CAMEROUN (DESSIN EXACT) --- */}
        <div className="relative w-48 h-64 md:w-56 md:h-80 drop-shadow-2xl">
          <svg
            viewBox="0 0 350 600"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            className="w-full h-full"
          >
            {/* L'ombre/Glow violet derrière la carte */}
            <defs>
              <filter id="glow">
                <feGaussianBlur stdDeviation="4" result="coloredBlur" />
                <feMerge>
                  <feMergeNode in="coloredBlur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
            </defs>

            {/* Silhouette Principale du Cameroun (Retracée selon ton image) */}
            <path
              d="M210 10 C218 8 230 18 232 30 
                 C236 45 225 60 230 65 
                 C240 75 255 82 260 78 
                 C270 70 290 85 292 95 
                 C295 115 282 140 288 150 
                 C300 165 325 185 330 205 
                 C335 230 320 250 315 270 
                 C315 290 330 315 335 340 
                 C340 370 310 400 305 430 
                 C300 460 320 480 325 500 
                 C330 520 345 540 345 550 
                 C345 570 250 590 180 585 
                 C120 580 100 560 90 530 
                 C80 500 70 480 55 470 
                 C40 460 25 440 20 420 
                 C15 400 35 385 40 365 
                 C45 345 30 335 35 320 
                 C40 305 55 295 70 280 
                 C90 260 125 220 135 190 
                 C145 160 160 120 170 85 
                 C180 50 195 25 210 10 Z"
              className="fill-primary/15 dark:fill-primary/20 stroke-primary stroke-[3] animate-pulse"
              filter="url(#glow)"
              strokeLinejoin="round"
              strokeLinecap="round"
            />

            {/* Localisation Clignotante (Symbolise Yaoundé / Le cœur de l'app) */}
            {/* Coordonnées ajustées pour être dans la partie Centre-Sud */}
            <circle cx="200" cy="420" r="6" className="fill-primary animate-ping opacity-75" />
            <circle cx="200" cy="420" r="3" className="fill-white dark:fill-zinc-950" />
          </svg>
        </div>

        {/* --- TEXTE --- */}
        <div className="flex flex-col items-center gap-3">
          <div className="h-2 w-24 bg-zinc-200 dark:bg-zinc-800 rounded-full overflow-hidden">
            <div className="h-full bg-primary w-2/3 animate-[shimmer_1.5s_infinite] rounded-full" 
                 style={{ 
                   backgroundImage: "linear-gradient(to right, transparent, rgba(255,255,255,0.5), transparent)" 
                 }} 
            />
          </div>
          
          <h3 className="text-xl md:text-2xl font-black tracking-tight text-zinc-800 dark:text-white flex items-center gap-1.5 font-sans">
            <span className="text-zinc-300 dark:text-zinc-600">Chargement</span>
            <span className="text-primary animate-pulse">Navigoo</span>
          </h3>
        </div>

      </div>
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\map\Map.tsx
================================================================================

"use client";

import { useState, useMemo, useEffect, useRef, memo, useCallback } from "react";
import Map, { Marker, NavigationControl, GeolocateControl, ScaleControl, Popup, MapRef, Source, Layer } from "react-map-gl/maplibre";
import maplibregl, { LngLatBounds } from "maplibre-gl"; 
import { POI, Location } from "@/types";
import { getCategoryConfig } from "@/data/categories";
import { motion, AnimatePresence } from "framer-motion";
import Image from "next/image";
import { Star, MapPin as MapPinIcon, Loader2, Database, Map as MapIcon, CheckCircle2 } from "lucide-react";

interface MapProps {
  apiKey: string;
  pois: POI[];
  onSelectPoi: (poi: POI | null) => void;
  selectedPoi: POI | null;
  userLocation: Location | null;
  routeGeometry: any | null; 
  mapStyleType: "streets-v2" | "hybrid";
  onMapEmptyClick: (lng: number, lat: number) => void;
  // NOUVEAU: Props pour le suivi GPS
  isNavigating?: boolean;
  traveledPath?: Location[];
}

const MapMarker = memo(({ poi, isSelected, onClick, onHover }: { 
  poi: POI, 
  isSelected: boolean, 
  onClick: (e: any) => void, 
  onHover: (p: POI | null) => void 
}) => {
  const config = getCategoryConfig(poi.poi_category);
  const lng = poi.location?.longitude ?? poi.longitude;
  const lat = poi.location?.latitude ?? poi.latitude;

  return (
    <Marker longitude={lng} latitude={lat} anchor="bottom" onClick={onClick}>
      <div 
        onMouseEnter={() => onHover(poi)}
        onMouseLeave={() => onHover(null)}
        className="relative flex flex-col items-center cursor-pointer group transform-gpu"
        style={{ zIndex: isSelected ? 50 : 10 }}
      >
        {isSelected ? (
           <div className="relative">
              <div className="absolute inset-0 bg-red-500 rounded-full opacity-75 animate-ping"></div>
              <div className="relative z-10 text-red-600 drop-shadow-lg scale-125 transition-transform duration-200">
                 <MapPinIcon size={48} fill="#ef4444" className="text-red-900" />
                 <div className="absolute top-[14px] left-[14px] w-5 h-5 bg-white rounded-full flex items-center justify-center">
                    <div className="w-2 h-2 bg-red-600 rounded-full" />
                 </div>
              </div>
           </div>
        ) : (
          <>
             <div 
               className="flex items-center justify-center w-8 h-8 rounded-full shadow-lg border-2 border-white transition-transform duration-200 group-hover:scale-125 bg-zinc-900 will-change-transform"
               style={{ backgroundColor: config.color }}
             >
               <div className="text-white drop-shadow-md">
                 {config.icon}
               </div>
             </div>
             <div className="w-0 h-0 border-l-[5px] border-l-transparent border-r-[5px] border-r-transparent border-t-[6px] mt-[-1px]" style={{ borderTopColor: config.color }}></div>
          </>
        )}
      </div>
    </Marker>
  );
});

MapMarker.displayName = "MapMarker";

const LoadingIndicator = ({ clickPosition, loadingStage }: { 
  clickPosition: { x: number; y: number }, 
  loadingStage: string 
}) => {
  const stages = [
    { key: 'maptiler', label: 'MapTiler', icon: <MapIcon size={16} /> },
    { key: 'osm', label: 'OpenStreetMap', icon: <Database size={16} /> },
    { key: 'details', label: 'Détails', icon: <CheckCircle2 size={16} /> },
  ];

  return (
    <div className="absolute z-50 pointer-events-none" style={{ left: clickPosition.x, top: clickPosition.y, transform: 'translate(-50%, -50%)' }}>
      <motion.div initial={{ scale: 0, opacity: 0 }} animate={{ scale: 1, opacity: 1 }} exit={{ scale: 0, opacity: 0 }} className="relative">
        <div className="absolute inset-0 bg-primary rounded-full opacity-50 animate-ping"></div>
        <div className="relative bg-white dark:bg-zinc-900 rounded-2xl p-4 shadow-2xl border border-zinc-200 dark:border-zinc-700 min-w-[200px]">
          <div className="flex items-center gap-2 mb-3 pb-2 border-b border-zinc-200 dark:border-zinc-700">
            <Loader2 className="animate-spin text-primary" size={20} />
            <span className="text-sm font-bold text-zinc-800 dark:text-white">Recherche...</span>
          </div>
          <div className="space-y-2">
            {stages.map((stage) => (
              <div key={stage.key} className={`flex items-center gap-2 text-xs transition-all ${
                loadingStage === stage.key ? 'text-primary font-bold' : loadingStage > stage.key ? 'text-green-600 dark:text-green-400' : 'text-zinc-400'
              }`}>
                <div className={`transition-transform ${loadingStage === stage.key ? 'animate-pulse' : ''}`}>{stage.icon}</div>
                <span>{stage.label}</span>
                {loadingStage > stage.key && <CheckCircle2 size={14} className="ml-auto text-green-600" />}
                {loadingStage === stage.key && <Loader2 size={14} className="ml-auto animate-spin" />}
              </div>
            ))}
          </div>
        </div>
      </motion.div>
    </div>
  );
};

function MapComponent({ 
  apiKey, 
  pois, 
  onSelectPoi, 
  selectedPoi, 
  userLocation, 
  routeGeometry, 
  mapStyleType, 
  onMapEmptyClick,
  isNavigating = false,
  traveledPath = []
}: MapProps) {
  const mapRef = useRef<MapRef>(null);
  const hoverTimeoutRef = useRef<NodeJS.Timeout | null>(null);

  const [viewState, setViewState] = useState({
    longitude: 11.516,
    latitude: 3.866,
    zoom: 13.5
  });

  const [hoveredPoi, setHoveredPoi] = useState<POI | null>(null);
  const [isLoadingClick, setIsLoadingClick] = useState(false);
  const [loadingStage, setLoadingStage] = useState('');
  const [clickPosition, setClickPosition] = useState<{ x: number; y: number } | null>(null);

  const handleHover = useCallback((poi: POI | null) => {
    if (hoverTimeoutRef.current) clearTimeout(hoverTimeoutRef.current);
    if (poi) {
        setHoveredPoi(poi);
    } else {
        hoverTimeoutRef.current = setTimeout(() => setHoveredPoi(null), 100);
    }
  }, []);

  const handleMapClick = useCallback(async (e: any) => {
    if (e.originalEvent?.defaultPrevented) return;
    const { lngLat } = e;
    setClickPosition({ x: e.point.x, y: e.point.y });
    setIsLoadingClick(true);
    try {
      setLoadingStage('maptiler');
      await new Promise(resolve => setTimeout(resolve, 300));
      setLoadingStage('osm');
      await new Promise(resolve => setTimeout(resolve, 300));
      setLoadingStage('details');
      await onMapEmptyClick(lngLat.lng, lngLat.lat);
    } finally {
      setIsLoadingClick(false);
      setLoadingStage('');
      setClickPosition(null);
    }
  }, [onMapEmptyClick]);

  useEffect(() => {
    if (userLocation && mapRef.current && !routeGeometry) {
      mapRef.current.flyTo({ center: [userLocation.longitude, userLocation.latitude], zoom: 15, duration: 1200 });
    }
  }, [userLocation, routeGeometry]);

  useEffect(() => {
    if (selectedPoi && mapRef.current && !routeGeometry) {
      const lng = selectedPoi.location?.longitude ?? selectedPoi.longitude;
      const lat = selectedPoi.location?.latitude ?? selectedPoi.latitude;
      mapRef.current.flyTo({ center: [lng, lat], zoom: 16, duration: 1000 });
    }
  }, [selectedPoi, routeGeometry]);

  useEffect(() => {
    if (routeGeometry && mapRef.current) {
        const coords = routeGeometry.coordinates;
        const bounds = new LngLatBounds(coords[0], coords[0]);
        for (const coord of coords) bounds.extend(coord as [number, number]);
        mapRef.current.fitBounds(bounds, {
            padding: { top: 80, bottom: 80, right: 50, left: window.innerWidth > 768 ? 420 : 50 },
            duration: 1500 
        });
    }
  }, [routeGeometry]);

  // NOUVEAU: Centrer sur la position en temps réel pendant la navigation
  useEffect(() => {
    if (isNavigating && userLocation && mapRef.current) {
      mapRef.current.easeTo({
        center: [userLocation.longitude, userLocation.latitude],
        duration: 500
      });
    }
  }, [isNavigating, userLocation]);

  const pins = useMemo(() => {
    return pois.map((poi) => {
      const lat = poi.location?.latitude ?? poi.latitude;
      const lng = poi.location?.longitude ?? poi.longitude;
      if (lat === undefined || lng === undefined || lat === 0) return null;
      return (
        <MapMarker 
          key={poi.poi_id} 
          poi={poi} 
          isSelected={selectedPoi?.poi_id === poi.poi_id}
          onHover={handleHover}
          onClick={(e) => { e.originalEvent.stopPropagation(); onSelectPoi(poi); }}
        />
      );
    }).filter(Boolean);
  }, [pois, selectedPoi?.poi_id, onSelectPoi, handleHover]);

  // NOUVEAU: GeoJSON du chemin parcouru
  const traveledPathGeoJSON = useMemo(() => {
    if (traveledPath.length < 2) return null;
    return {
      type: 'Feature',
      properties: {},
      geometry: {
        type: 'LineString',
        coordinates: traveledPath.map(p => [p.longitude, p.latitude])
      }
    };
  }, [traveledPath]);

  return (
    <div className="relative w-full h-full">
      <Map
        ref={mapRef}
        {...viewState}
        onMove={evt => setViewState(evt.viewState)}
        style={{ width: "100%", height: "100%" }}
        mapStyle={`https://api.maptiler.com/maps/${mapStyleType}/style.json?key=${apiKey}`}
        attributionControl={false}
        onClick={handleMapClick}
        mapLib={maplibregl}
        reuseMaps={true}
        cooperativeGestures={true}
        maxTileCacheSize={100}
      >
        <GeolocateControl position="bottom-right" />
        <NavigationControl position="bottom-right" showCompass={false} />
        <ScaleControl />

        {/* Itinéraire complet */}
        {routeGeometry && (
          <Source id="route-source" type="geojson" data={routeGeometry}>
             <Layer 
               id="route-outline"
               type="line"
               paint={{ 'line-color': '#ffffff', 'line-width': 8, 'line-opacity': 0.8 }}
               layout={{ 'line-cap': 'round', 'line-join': 'round' }}
             />
             <Layer 
               id="route-line"
               type="line"
               paint={{ 'line-color': '#9400D3', 'line-width': 5, 'line-opacity': 1 }}
               layout={{ 'line-cap': 'round', 'line-join': 'round' }}
             />
          </Source>
        )}

        {/* NOUVEAU: Chemin parcouru en pointillés */}
        {traveledPathGeoJSON && (
          <Source id="traveled-path-source" type="geojson" data={traveledPathGeoJSON}>
             <Layer 
               id="traveled-path"
               type="line"
               paint={{
                 'line-color': '#22c55e',
                 'line-width': 4,
                 'line-dasharray': [2, 2],
                 'line-opacity': 0.9
               }}
               layout={{ 'line-cap': 'round', 'line-join': 'round' }}
             />
          </Source>
        )}

        {/* Position utilisateur */}
        {userLocation && (
          <Marker longitude={userLocation.longitude} latitude={userLocation.latitude}>
             <div className="relative flex items-center justify-center w-6 h-6 transform-gpu">
                <span className="absolute w-12 h-12 bg-blue-500 rounded-full opacity-30 animate-ping"></span>
                <span className="absolute w-6 h-6 bg-blue-500/40 rounded-full border border-blue-500/50 backdrop-blur-sm"></span>
                <span className="absolute w-3.5 h-3.5 bg-blue-600 rounded-full border-2 border-white shadow-sm z-10"></span>
             </div>
          </Marker>
        )}

        {pins}

        <AnimatePresence>
          {hoveredPoi && !selectedPoi && (
            <Popup
              longitude={hoveredPoi.location?.longitude ?? hoveredPoi.longitude}
              latitude={hoveredPoi.location?.latitude ?? hoveredPoi.latitude}
              anchor="top"
              closeButton={false}
              offset={12}
              className="z-50 pointer-events-none"
            >
              <motion.div 
                initial={{ opacity: 0, scale: 0.9 }} 
                animate={{ opacity: 1, scale: 1 }}
                exit={{ opacity: 0 }}
                transition={{ duration: 0.1 }}
                className="flex gap-2 p-0 min-w-[180px] shadow-xl rounded-lg bg-white overflow-hidden"
              >
                <div className="relative w-10 h-10 shrink-0 bg-zinc-100 flex items-center justify-center overflow-hidden">
                  {hoveredPoi.poi_images_urls && hoveredPoi.poi_images_urls[0] && !hoveredPoi.poi_images_urls[0].includes("example.com") ? (
                    <Image src={hoveredPoi.poi_images_urls[0]} alt="" fill className="object-cover" sizes="40px" quality={50} />
                  ) : (
                    <MapPinIcon size={16} className="text-zinc-300" />
                  )}
                </div>
                 <div className="flex flex-col justify-center py-1 pr-2">
                   <h4 className="font-bold text-xs text-zinc-900 leading-tight line-clamp-1">{hoveredPoi.poi_name}</h4>
                   <div className="flex items-center gap-1 text-[10px] text-zinc-500 font-medium">
                     <Star size={9} className="text-yellow-500 fill-current" />
                     <span>{hoveredPoi.rating}</span>
                     <span>•</span>
                     <span>{getCategoryConfig(hoveredPoi.poi_category).label}</span>
                   </div>
                 </div>
              </motion.div>
            </Popup>
          )}
        </AnimatePresence>
      </Map>

      <AnimatePresence>
        {isLoadingClick && clickPosition && (
          <LoadingIndicator clickPosition={clickPosition} loadingStage={loadingStage} />
        )}
      </AnimatePresence>
    </div>
  );
}

export default memo(MapComponent);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\sidebar\SidebarItem.tsx
================================================================================

import { ReactNode } from "react";
import clsx from "clsx";
import { motion, AnimatePresence } from "framer-motion";

interface SidebarItemProps {
  icon: ReactNode;
  label: string;
  isExpanded: boolean; // Nouvelle prop pour savoir si on affiche le texte
  onClick?: () => void;
  isActive?: boolean;
}

export const SidebarItem = ({ icon, label, isExpanded, onClick, isActive }: SidebarItemProps) => {
  return (
    <button
      onClick={onClick}
      className={clsx(
        "flex items-center w-full p-3 transition-colors rounded-lg group relative",
        // En mode fermé, on centre. En ouvert, aligné à gauche.
        isExpanded ? "justify-start px-4 gap-4" : "justify-center px-0", 
        isActive 
          ? "bg-primary/10 text-primary" 
          : "text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 hover:text-primary"
      )}
    >
      {/* Icone : taille fixe */}
      <span className={clsx(
        "shrink-0 transition-transform duration-200", 
        isActive ? "scale-110" : "group-hover:scale-110"
      )}>
        {icon}
      </span>

      {/* Libellé : Animation d'apparition */}
      <AnimatePresence>
        {isExpanded && (
          <motion.span
            initial={{ opacity: 0, x: -10, width: 0 }}
            animate={{ opacity: 1, x: 0, width: "auto" }}
            exit={{ opacity: 0, x: -10, width: 0 }}
            transition={{ duration: 0.2, ease: "easeOut" }}
            className="text-sm font-medium whitespace-nowrap overflow-hidden"
          >
            {label}
          </motion.span>
        )}
      </AnimatePresence>

      {/* Tooltip si fermé (UX Bonus) : permet de savoir ce que c'est sans ouvrir */}
      {!isExpanded && (
        <div className="absolute left-full ml-2 px-2 py-1 bg-zinc-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50 whitespace-nowrap">
          {label}
        </div>
      )}
    </button>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\sidebar\Sidebar.tsx
================================================================================

import { useState } from "react";
import { motion } from "framer-motion";
import { SidebarItem } from "./SidebarItem";
import { 
  Bookmark, Clock, Share2, Printer, MapPin, 
  Settings, HelpCircle, Shield, Globe, 
  Building, UserSearch, PanelLeftClose, MapPinHouse
} from "lucide-react";
import { clsx } from "clsx";
import { captureMap, shareMap } from "@/services/mapCaptureService";

interface SidebarProps {
  isOpen: boolean; 
  onClose: () => void;
  // Actions
  onViewChange: (view: "saved" | "recent" | "trips" | "mypois") => void;
  onLocateMe: () => void;
  onShare: () => void;
  onPrint: () => void;
  onToggleSettings: () => void;
}

export const Sidebar = ({ 
    isOpen, 
    onClose, 
    onViewChange, 
    onLocateMe,
    onShare,
    onPrint,
    onToggleSettings
}: SidebarProps) => {
  const [isHovered, setIsHovered] = useState(false);
  const isExpanded = isHovered || isOpen;

  const handleAction = (action: () => void) => {
    action();    // 1. Exécute l'action demandée (ex: ouvrir panneau favoris)
    onClose();   // 2. Force la fermeture du mode "Menu étendu"
    setIsHovered(false); // 3. Force la fin de l'état survol (pour éviter qu'il reste ouvert si la souris ne bouge pas vite)
  };

  return (
    <>
      <motion.div
        onMouseEnter={() => setIsHovered(true)}
        onMouseLeave={() => setIsHovered(false)}
        initial={{ width: "70px" }}
        animate={{ width: isExpanded ? "300px" : "72px" }}
        transition={{ type: "spring", stiffness: 300, damping: 30 }}
        className={clsx(
          "fixed top-0 left-0 h-full bg-white dark:bg-black/95 backdrop-blur-md shadow-2xl z-[60] flex flex-col border-r border-zinc-200 dark:border-zinc-800 overflow-hidden",
          !isOpen && "hidden md:flex" 
        )}
      >
        {/* HEADER LOGO */}
        <div className="h-16 flex items-center shrink-0 border-b border-zinc-100 dark:border-zinc-800 px-3">
           {isExpanded ? (
             <div className="flex items-center justify-between w-full pl-2">
               <div className="flex items-center gap-3">
                 <div className="bg-primary/10 p-1.5 rounded-lg"><MapPinHouse className="text-primary" size={24} /></div>
                 <span className="text-xl font-bold tracking-tight text-zinc-700 dark:text-white">Navi<span className="text-primary">goo</span></span>
               </div>
               <button onClick={onClose} className="p-1 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-md text-zinc-400"><PanelLeftClose size={20} /></button>
             </div>
           ) : (
             <div className="w-full flex justify-center">
                <div className="bg-white dark:bg-zinc-800 p-2 rounded-xl border border-zinc-100 dark:border-zinc-700">
                  <MapPinHouse className="text-primary" size={26} />
                </div>
             </div>
           )}
        </div>

        {/* CONTENT */}
        <div className="flex-1 overflow-y-auto overflow-x-hidden scrollbar-thin px-2 py-4 space-y-1">
          <SidebarItem isExpanded={isExpanded} icon={<Bookmark size={22} />} label="Enregistrés" onClick={() => handleAction(() => onViewChange("saved"))} />
          <SidebarItem isExpanded={isExpanded} icon={<Clock size={22} />} label="Récents" onClick={() => handleAction(() => onViewChange("recent"))} />
          <SidebarItem isExpanded={isExpanded} icon={<Building size={22} />} label="Creer un point d'interet" onClick={() => handleAction(() => onViewChange("mypois"))} />
          <SidebarItem isExpanded={isExpanded} icon={<UserSearch size={22} />} label="Trouver ma position" onClick={() => handleAction(onLocateMe)} />
          <SidebarItem isExpanded={isExpanded} icon={<MapPin size={22} />} label="Mes trajets" onClick={() => handleAction(() => onViewChange("trips"))} />
          
          <div className="h-px bg-zinc-100 dark:bg-zinc-800 my-2 mx-2" />

          <SidebarItem isExpanded={isExpanded} icon={<Share2 size={22} />} label="Partager la carte" onClick={() => handleAction(shareMap)} />
          <SidebarItem isExpanded={isExpanded} icon={<Printer size={22} />} label="Imprimer la carte" onClick={() => handleAction(captureMap)} />
          
          <div className="h-px bg-zinc-100 dark:bg-zinc-800 my-2 mx-2" />

          <SidebarItem isExpanded={isExpanded} icon={<Settings size={22} />} label="Paramètres & Style" onClick={() => handleAction(onToggleSettings)} />
          <SidebarItem isExpanded={isExpanded} icon={<Shield size={22} />} label="Confidentialité" />
        </div>

        {/* Footer */}
        <div className={clsx("p-4 border-t border-zinc-100 dark:border-zinc-800 flex justify-center")}>
             <Globe size={20} className="text-zinc-400 hover:text-primary cursor-pointer" />
        </div>
      </motion.div>
      
      {/* Mobile Backdrop */}
      {isOpen && <div className="fixed inset-0 bg-black/50 z-[55] md:hidden" onClick={onClose} />}
    </>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\sidebar\POIDetailsSidebar.tsx
================================================================================

import { motion } from "framer-motion";
import Image from "next/image";
import { POI } from "@/types";
import { X, Navigation, Bookmark, Share2, Smartphone, Globe, Clock, MapPin, Star, MessageSquare, Edit } from "lucide-react";
import { getCategoryConfig } from "@/data/categories";
import { useRouter } from "next/navigation";
import { useUserData } from "@/hooks/useUserData"; // Pour vérifier propriété

interface PoiDetailsProps {
  poi: POI;
  onClose: () => void;
  isOpen: boolean;
  onOpenDirections: () => void;
}

export const PoiDetailsSidebar = ({ poi, onClose, isOpen, onOpenDirections }: PoiDetailsProps) => {
  const categoryConfig = getCategoryConfig(poi.poi_category);
  const router = useRouter();
  const { myPois } = useUserData();

  // Vérifier si le POI appartient à l'utilisateur
  const isOwner = myPois.some(p => p.poi_id === poi.poi_id);

  const handleEdit = () => {
    router.push(`/add-poi?id=${poi.poi_id}`);
  };

  return (
    <motion.div
      initial={{ x: "-100%" }}
      animate={{ x: isOpen ? "0%" : "-100%" }}
      exit={{ x: "-100%" }}
      transition={{ type: "spring", stiffness: 300, damping: 30 }}
      className="fixed top-0 left-0 md:left-[72px] h-full w-full md:w-[400px] bg-white dark:bg-zinc-900 shadow-2xl z-[55] flex flex-col border-r border-zinc-200 dark:border-zinc-800 overflow-y-auto"
    >
      {/* HEADER IMAGE HERO */}
      <div className="relative w-full h-56 shrink-0 bg-zinc-200">
        {poi.poi_images_urls && poi.poi_images_urls[0] ? (
            <Image src={poi.poi_images_urls[0]} alt={poi.poi_name} fill className="object-cover"/>
        ) : (
            <div className="w-full h-full flex items-center justify-center text-zinc-400 bg-zinc-100">Aucune image</div>
        )}
        
        {/* Close Button */}
        <button onClick={onClose} className="absolute top-4 right-4 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full backdrop-blur-md transition-colors z-20">
          <X size={20} />
        </button>

        {/* OWNER EDIT BUTTON */}
        {isOwner && (
            <button 
                onClick={handleEdit}
                className="absolute bottom-4 right-4 bg-white text-black px-4 py-2 rounded-full shadow-lg font-bold text-sm flex items-center gap-2 hover:scale-105 transition-transform"
            >
                <Edit size={16} /> Modifier Infos
            </button>
        )}
      </div>

      {/* CONTENU */}
      <div className="p-6 space-y-6 pb-20">
        
        {/* TITRE & REVIEW */}
        <div>
          <h1 className="text-3xl font-bold text-zinc-900 dark:text-zinc-50 leading-tight">{poi.poi_name}</h1>
          <div className="flex items-center gap-2 mt-3">
            <span className="font-black text-sm bg-green-600 text-white px-1.5 rounded">{poi.rating || "N/A"}</span>
            <div className="flex text-yellow-500">
              {[1, 2, 3, 4, 5].map((star) => (
                <Star key={star} size={14} fill={star <= Math.round(poi.rating) ? "currentColor" : "none"} />
              ))}
            </div>
            <span className="text-zinc-500 text-sm underline">({poi.review_count} avis)</span>
            <span className="text-zinc-300">•</span>
            <span className="text-primary text-sm font-semibold flex items-center gap-1">
                {categoryConfig.icon} {categoryConfig.label}
            </span>
          </div>
        </div>

        {/* ACTIONS CIRCULAIRES */}
        <div className="flex justify-between px-2 py-2">
          <ActionButton icon={<Navigation size={22} className="-rotate-45 ml-1 mt-1" />} label="Y aller" active onClick={onOpenDirections} />
          <ActionButton icon={<Bookmark size={22} />} label="Sauver" onClick={() => {}}/>
          <ActionButton icon={<Share2 size={22} />} label="Partager" onClick={() => {}}/>
          <ActionButton icon={<Globe size={22} />} label="Site web" onClick={() => {}} disabled={!poi.poi_contacts?.website} />
        </div>

        <div className="h-px bg-zinc-100 dark:bg-zinc-800 w-full" />

        {/* DESCRIPTION */}
        <div className="text-sm text-zinc-600 dark:text-zinc-300 leading-relaxed">
          <p>{poi.poi_description || "Aucune description disponible."}</p>
        </div>

        {/* AMENITIES */}
        {poi.poi_amenities && poi.poi_amenities.length > 0 && (
            <div className="flex flex-wrap gap-2">
                {poi.poi_amenities.map(am => (
                    <span key={am} className="text-xs px-3 py-1 bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 rounded-full font-medium border border-zinc-200 dark:border-zinc-700">
                        {am}
                    </span>
                ))}
            </div>
        )}

        <div className="h-px bg-zinc-100 dark:bg-zinc-800 w-full" />

        {/* INFO PRATIQUES */}
        <div className="space-y-4">
          <InfoRow icon={<MapPin className="text-zinc-400" size={20} />} text={poi.address_informal || `${poi.address_city}, ${poi.address_country || "Cameroun"}`} />
          <InfoRow icon={<Clock className="text-zinc-400" size={20} />} text="Ouvert maintenant (ferme à 22h)" isActive />
          <InfoRow icon={<Smartphone className="text-zinc-400" size={20} />} text={poi.poi_contacts?.phone || "Non renseigné"} />
        </div>

        <div className="h-px bg-zinc-100 dark:bg-zinc-800 w-full" />

        {/* SECTION AVIS / COMMENTAIRES */}
        <div>
            <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                <MessageSquare size={18} /> Avis et commentaires
            </h3>
            
            <div className="space-y-4">
                {/* Simulation Commentaire 1 */}
                <div className="flex gap-3">
                    <div className="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center font-bold text-blue-600 text-sm">JM</div>
                    <div className="bg-zinc-50 dark:bg-zinc-800 p-3 rounded-r-xl rounded-bl-xl text-sm flex-1">
                        <div className="flex justify-between items-center mb-1">
                            <span className="font-bold">Jean-Marc</span>
                            <div className="flex text-yellow-500"><Star size={10} fill="currentColor"/> 5.0</div>
                        </div>
                        <p className="text-zinc-600 dark:text-zinc-300">Très bel endroit, je recommande pour les soirées entre amis !</p>
                    </div>
                </div>

                {/* Simulation Commentaire 2 */}
                <div className="flex gap-3">
                    <div className="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center font-bold text-purple-600 text-sm">AL</div>
                    <div className="bg-zinc-50 dark:bg-zinc-800 p-3 rounded-r-xl rounded-bl-xl text-sm flex-1">
                        <div className="flex justify-between items-center mb-1">
                            <span className="font-bold">Alice L.</span>
                            <div className="flex text-yellow-500"><Star size={10} fill="currentColor"/> 4.0</div>
                        </div>
                        <p className="text-zinc-600 dark:text-zinc-300">Le service est un peu lent mais la nourriture est excellente.</p>
                    </div>
                </div>
            </div>

            <button className="w-full mt-4 py-2 border border-zinc-200 dark:border-zinc-700 text-zinc-500 text-sm font-medium rounded-lg hover:bg-zinc-50 transition-colors">
                Voir les 45 avis
            </button>
        </div>

      </div>
    </motion.div>
  );
};

const ActionButton = ({ icon, label, active, onClick, disabled }: any) => (
  <button 
    onClick={onClick}
    disabled={disabled}
    className={`flex flex-col items-center gap-2 group ${disabled ? "opacity-50 cursor-not-allowed" : "cursor-pointer"}`}
  >
    <div className={`w-12 h-12 rounded-full flex items-center justify-center border transition-all ${
      active ? "bg-primary text-white border-primary shadow-md" : "bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700 text-zinc-600 dark:text-zinc-300 hover:text-primary hover:border-primary/30"
    }`}>
      {icon}
    </div>
    <span className={`text-[10px] font-medium uppercase tracking-wide ${active ? "text-primary" : "text-zinc-500"}`}>{label}</span>
  </button>
);

const InfoRow = ({ icon, text, isActive }: any) => (
  <div className="flex items-start gap-4">
    <div className="mt-0.5 min-w-[20px]">{icon}</div>
    <span className={`text-sm ${isActive ? "text-green-600 font-bold" : "text-zinc-700 dark:text-zinc-300"}`}>{text}</span>
  </div>
);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\sidebar\DirectionSidebar.tsx
================================================================================

import { useState, useEffect } from "react";
import { motion } from "framer-motion";
import { X, ArrowUpDown, Car, PersonStanding, Bike, Loader2, Navigation, CircleDot, MapPin, Clock, Flag, Play, Square } from "lucide-react";
import { POI, Location, TransportMode } from "@/types";
import { clsx } from "clsx";
import { EnrichedRouteStats } from "@/services/routingService";

interface DirectionsSidebarProps {
  originPoi: POI | null;
  destinationPoi: POI;
  userLocation: Location | null;
  isOpen: boolean;
  onClose: () => void;
  onCalculateRoute: (mode: TransportMode) => void;
  routeStats: EnrichedRouteStats | null;
  isLoadingRoute: boolean;
  activeMode: TransportMode;
  onStartNavigation: () => void;
  onStopNavigation: () => void;
  isNavigating: boolean;
}

export const DirectionsSidebar = ({
  originPoi,
  destinationPoi,
  userLocation,
  isOpen,
  onClose,
  onCalculateRoute,
  routeStats,
  isLoadingRoute,
  activeMode,
  onStartNavigation,
  onStopNavigation,
  isNavigating
}: DirectionsSidebarProps) => {

  const formatTime = (seconds: number) => {
    if (seconds < 60) return "1 min";
    const minutes = Math.floor(seconds / 60);
    const hours = Math.floor(minutes / 60);
    if (hours > 0) return `${hours} h ${minutes % 60} min`;
    return `${minutes} min`;
  };

  const formatDist = (meters: number) => {
    if (meters < 1000) return `${Math.round(meters)} m`;
    return `${(meters / 1000).toFixed(1)} km`;
  };

  return (
    <motion.div
      initial={{ x: "-100%" }}
      animate={{ x: isOpen ? "0%" : "-100%" }}
      exit={{ x: "-100%" }}
      transition={{ type: "spring", stiffness: 300, damping: 30 }}
      className="fixed top-0 left-0 md:left-[72px] h-full w-full md:w-[400px] bg-white dark:bg-zinc-900 shadow-2xl z-[60] flex flex-col border-r border-zinc-200 dark:border-zinc-800 font-sans overflow-hidden"
    >
      {/* HEADER */}
      <div className="bg-primary px-4 py-4 shadow-md text-white z-10 shrink-0">
        
        {/* Navigation Modes */}
        <div className="flex justify-between items-center mb-4 px-2">
            <ModeButton 
              icon={<Car size={20} />} 
              mode="driving" 
              active={activeMode === "driving"} 
              onClick={() => onCalculateRoute("driving")} 
            />
            <ModeButton 
              icon={<Bike size={20} />} 
              mode="cycling" 
              active={activeMode === "cycling"} 
              onClick={() => onCalculateRoute("cycling")} 
            />
            <ModeButton 
              icon={<PersonStanding size={20} />} 
              mode="walking" 
              active={activeMode === "walking"} 
              onClick={() => onCalculateRoute("walking")} 
            />
            
            <button onClick={onClose} className="p-2 bg-white/20 hover:bg-white/30 rounded-full transition-colors ml-auto">
                <X size={20} />
            </button>
        </div>

        {/* Input Fields */}
        <div className="bg-white dark:bg-zinc-800 rounded-lg p-3 shadow-inner flex gap-3 text-zinc-800 dark:text-zinc-200">
           <div className="flex flex-col items-center pt-2 gap-1 w-6">
              <CircleDot size={14} className="text-blue-500" />
              <div className="flex-1 w-0.5 border-l-2 border-dotted border-zinc-300 dark:border-zinc-600 my-1"></div>
              <MapPin size={14} className="text-red-500 fill-red-500" />
           </div>

           <div className="flex-1 flex flex-col gap-3">
              <div className="h-8 flex items-center border border-zinc-200 dark:border-zinc-700 bg-zinc-50 dark:bg-zinc-900 rounded px-3 text-sm truncate">
                  {originPoi ? originPoi.poi_name : (userLocation ? "Votre position" : "Départ")}
              </div>
              <div className="h-8 flex items-center border border-zinc-200 dark:border-zinc-700 bg-zinc-50 dark:bg-zinc-900 rounded px-3 text-sm font-semibold truncate">
                  {destinationPoi.poi_name}
              </div>
           </div>

           <div className="flex items-center">
              <button className="p-1 hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded text-zinc-400">
                  <ArrowUpDown size={16} />
              </button>
           </div>
        </div>
      </div>

      {/* RESULTS BODY */}
      <div className="flex-1 overflow-y-auto bg-zinc-50 dark:bg-black p-2">
        
        {isLoadingRoute ? (
           <div className="flex flex-col items-center justify-center h-40 gap-3 text-zinc-500">
               <Loader2 size={32} className="animate-spin text-primary" />
               <p className="text-sm">Calcul de l'itinéraire...</p>
           </div>
        ) : routeStats ? (
            <div className="space-y-2 mt-2">
                {/* Carte récapitulative */}
                <div className="bg-white dark:bg-zinc-900 p-4 rounded-xl shadow-sm border border-zinc-200 dark:border-zinc-800">
                   <div className="flex justify-between items-start mb-4">
                      <div>
                         <div className="text-2xl font-bold text-green-600 dark:text-green-500">
                             {formatTime(routeStats.duration)}
                         </div>
                         <div className="flex items-center gap-2 text-zinc-500 dark:text-zinc-400 text-sm font-medium mt-1">
                             <span>{formatDist(routeStats.distance)}</span>
                             <span>•</span>
                             <span>~{routeStats.averageSpeed} km/h</span>
                         </div>
                      </div>
                      <div className="text-zinc-300">
                          {activeMode === "driving" && <Car size={24} />}
                          {activeMode === "walking" && <PersonStanding size={24} />}
                          {activeMode === "cycling" && <Bike size={24} />}
                      </div>
                   </div>
                   
                   <button 
                      onClick={isNavigating ? onStopNavigation : onStartNavigation}
                      className={clsx(
                        "w-full py-3 rounded-full font-bold flex items-center justify-center gap-2 shadow-lg transition-all",
                        isNavigating 
                          ? "bg-red-600 text-white hover:bg-red-700"
                          : "bg-primary text-white hover:bg-primary-dark"
                      )}
                   >
                      {isNavigating ? (
                        <>
                          <Square size={18} fill="currentColor" />
                          Terminer
                        </>
                      ) : (
                        <>
                          <Play size={18} fill="currentColor" />
                          Démarrer
                        </>
                      )}
                   </button>
                </div>

                {/* Étapes détaillées */}
                <div className="bg-white dark:bg-zinc-900 p-4 rounded-xl shadow-sm border border-zinc-200 dark:border-zinc-800">
                   <h3 className="font-semibold mb-3 flex items-center gap-2">
                       <Clock size={16} /> Étapes de navigation
                   </h3>
                   <div className="space-y-3 max-h-[400px] overflow-y-auto">
                      {routeStats.steps && routeStats.steps.length > 0 ? (
                        routeStats.steps.map((step, idx) => (
                          <Step 
                            key={idx}
                            text={step.instruction}
                            distance={formatDist(step.distance)}
                            isLast={idx === routeStats.steps.length - 1}
                          />
                        ))
                      ) : (
                        <>
                          <Step text={`Partir de ${originPoi ? originPoi.poi_name : "Votre position"}`} distance="" />
                          <Step text="Suivre l'itinéraire" distance={formatDist(routeStats.distance)} />
                          <Step text={`Arrivée à ${destinationPoi.poi_name}`} distance="" isLast />
                        </>
                      )}
                   </div>
                </div>
            </div>
        ) : (
            <div className="text-center p-8 text-zinc-400">
                Sélectionnez un mode de transport pour calculer l'itinéraire.
            </div>
        )}

      </div>
    </motion.div>
  );
};

const ModeButton = ({ icon, active, onClick }: any) => (
  <button 
     onClick={onClick}
     className={clsx(
       "p-2 rounded-full transition-all flex flex-col items-center gap-1 min-w-[60px]",
       active ? "bg-white text-primary font-bold shadow-sm scale-110" : "text-white/70 hover:bg-white/10"
     )}
  >
     {icon}
  </button>
);

const Step = ({ text, distance, isLast }: { text: string; distance: string; isLast?: boolean }) => (
   <div className="flex gap-4 min-h-[40px]">
       <div className="flex flex-col items-center">
           <div className="w-3 h-3 rounded-full border-2 border-zinc-400 bg-white dark:bg-black z-10"></div>
           {!isLast && <div className="w-0.5 flex-1 bg-zinc-200 dark:bg-zinc-700 -mt-1 -mb-1"></div>}
       </div>
       <div className="flex-1 pb-4">
          <p className="text-sm text-zinc-800 dark:text-zinc-200 font-medium">{text}</p>
          {distance && <p className="text-xs text-zinc-500 mt-1">{distance}</p>}
       </div>
   </div>
);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\sidebar\SecondarySidebar.tsx
================================================================================

import { motion } from "framer-motion";
import { X, MapPin, Clock, Bookmark, PlusCircle, Crown, Navigation, Edit2 } from "lucide-react";
import { POI, Trip } from "@/types";
import Image from "next/image";
import { Button } from "@/components/ui/Button";
import { useRouter } from "next/navigation";
import { useUserData } from "@/hooks/useUserData";

type ViewType = "saved" | "recent" | "trips" | "mypois" | null;

interface SecondarySidebarProps {
  view: ViewType;
  onClose: () => void;
  data: {
    savedPois: POI[];
    recentPois: POI[];
    trips: Trip[];
  };
  onSelectPoi: (poi: POI) => void;
}

export const SecondarySidebar = ({ view, onClose, data, onSelectPoi }: SecondarySidebarProps) => {
  const router = useRouter();
  const { myPois } = useUserData(); // Accès aux POIs de l'utilisateur

  const getHeader = () => {
    switch (view) {
      case "saved": return { title: "Enregistrés", icon: <Bookmark className="text-primary" /> };
      case "recent": return { title: "Récents", icon: <Clock className="text-primary" /> };
      case "trips": return { title: "Trajets Récents", icon: <Navigation className="text-primary" /> };
      case "mypois": return { title: "Mes Points d'intérêt", icon: <MapPin className="text-primary" /> };
      default: return { title: "", icon: null };
    }
  };

  const { title, icon } = getHeader();

  const formatDate = (isoString: string) => {
    try { return new Date(isoString).toLocaleDateString('fr-CM', { day: 'numeric', month: 'short' }); } catch { return ""; }
  };

  return (
    <motion.div
      initial={{ x: "-100%" }}
      animate={{ x: "0%" }}
      exit={{ x: "-100%" }}
      transition={{ type: "spring", stiffness: 300, damping: 30 }}
      className="fixed top-0 left-0 md:left-[72px] h-full w-full md:w-[400px] bg-white dark:bg-zinc-900 shadow-2xl z-[55] flex flex-col border-r border-zinc-200 dark:border-zinc-800"
    >
      {/* Header */}
      <div className="p-4 border-b border-zinc-200 dark:border-zinc-800 flex items-center justify-between bg-zinc-50 dark:bg-black/50">
        <div className="flex items-center gap-3">
            <div className="p-2 bg-primary/10 rounded-full">{icon}</div>
            <h2 className="text-lg font-bold text-zinc-800 dark:text-white">{title}</h2>
        </div>
        <button onClick={onClose} className="p-2 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full text-zinc-500">
            <X size={20} />
        </button>
      </div>

      {/* Body */}
      <div className="flex-1 overflow-y-auto p-4 space-y-4">
        
        {/* === SECTION "MES POIS" === */}
        {view === "mypois" && (
            <div className="space-y-4">
                
                {/* Bouton Création Toujours Visible */}
                <button 
                    onClick={() => router.push("/add-poi")} 
                    className="w-full py-4 border-2 border-dashed border-primary/30 rounded-xl flex items-center justify-center gap-3 hover:bg-primary/5 hover:border-primary transition-all group text-zinc-500 dark:text-zinc-400"
                >
                    <div className="p-2 bg-white dark:bg-zinc-800 rounded-full shadow-sm group-hover:scale-110 transition-transform">
                        <PlusCircle size={20} className="text-primary" />
                    </div>
                    <span className="text-sm font-bold text-primary">Créer un nouveau lieu</span>
                </button>

                <div className="h-px bg-zinc-100 dark:bg-zinc-800 my-2"></div>

                <h3 className="text-xs font-bold text-zinc-400 uppercase tracking-wider mb-2">Mes Établissements ({myPois.length})</h3>

                {myPois.length > 0 ? (
                    <div className="space-y-3">
                        {myPois.map(poi => (
                            <div 
                                key={poi.poi_id} 
                                onClick={() => onSelectPoi(poi)} // Clic sur un "MyPOI" ouvre la sidebar détail
                                className="relative flex gap-3 p-3 rounded-xl bg-white dark:bg-zinc-800/50 border border-zinc-200 dark:border-zinc-700 hover:border-primary cursor-pointer shadow-sm hover:shadow-md transition-all group"
                            >
                                <div className="w-16 h-16 rounded-lg overflow-hidden shrink-0 relative bg-zinc-200">
                                   {poi.poi_images_urls[0] && <Image src={poi.poi_images_urls[0]} alt="" fill className="object-cover" />}
                                </div>
                                <div className="flex-1">
                                    <h3 className="font-semibold text-zinc-800 dark:text-zinc-100 line-clamp-1 pr-6">{poi.poi_name}</h3>
                                    <p className="text-xs text-zinc-500 mt-1 line-clamp-1">{poi.poi_description}</p>
                                    <div className="mt-2 flex items-center gap-2">
                                        <span className="text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold">Actif</span>
                                        <div className="ml-auto text-primary text-xs flex items-center gap-1 group-hover:underline">
                                            <Edit2 size={10} /> Gérer
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                ) : (
                    <div className="text-center py-8 text-zinc-400 text-sm">
                        Vous n'avez pas encore ajouté de lieu.
                    </div>
                )}

                {/* Promo Partenaire en bas de liste */}
                <div className="bg-gradient-to-br from-indigo-900 to-primary p-5 rounded-2xl text-white relative overflow-hidden mt-6">
                    <Crown className="absolute -right-4 -bottom-4 text-white/10" size={120} />
                    <h3 className="font-bold text-lg mb-2 relative z-10">Devenir Partenaire</h3>
                    <p className="text-white/80 text-sm mb-4 relative z-10 leading-relaxed">
                        Boostez la visibilité de vos commerces sur Navigoo.
                    </p>
                    <Button size="sm" className="w-full bg-white text-primary hover:bg-zinc-100 border-none relative z-10 font-bold">
                        Passer pro
                    </Button>
                </div>
            </div>
        )}

        {/* Autres Vues (Code inchangé mais condensé pour l'exemple) */}
        {(view === "saved" || view === "recent") && (
             (view === "saved" ? data.savedPois : data.recentPois).length > 0 ? (
                (view === "saved" ? data.savedPois : data.recentPois).map(poi => (
                    <div key={poi.poi_id} onClick={() => onSelectPoi(poi)} className="flex gap-3 p-3 rounded-xl hover:bg-zinc-100 cursor-pointer border border-transparent hover:border-zinc-200 transition-colors">
                        <div className="w-14 h-14 rounded-lg overflow-hidden shrink-0 relative bg-zinc-200">
                           {poi.poi_images_urls[0] && <Image src={poi.poi_images_urls[0]} alt="" fill className="object-cover" />}
                        </div>
                        <div>
                            <h3 className="font-semibold text-zinc-800 line-clamp-1">{poi.poi_name}</h3>
                            <p className="text-xs text-zinc-500">{poi.poi_category} • {poi.address_city}</p>
                        </div>
                    </div>
                ))
             ) : <EmptyState text="Aucun lieu trouvé." />
        )}

        {view === "trips" && data.trips.length > 0 && (
             data.trips.map(trip => (
                <div key={trip.id} className="p-4 rounded-xl bg-zinc-50 border border-zinc-200 mb-3">
                    <div className="flex justify-between items-center mb-2 text-xs text-zinc-400">
                         <span>{formatDate(trip.date)}</span>
                    </div>
                    <div className="flex flex-col gap-1 text-sm">
                        <span className="font-semibold">{trip.arriveName}</span>
                        <span className="text-zinc-500 text-xs">depuis {trip.departName}</span>
                    </div>
                </div>
             ))
        )}
      </div>
    </motion.div>
  );
};

const EmptyState = ({ text }: { text: string }) => (
    <div className="flex flex-col items-center justify-center h-48 text-zinc-400">
        <MapPin size={48} className="mb-2 opacity-20" />
        <p>{text}</p>
    </div>
);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\navigation\SearchInput.tsx
================================================================================

"use client";

import { Search, Menu, X, History, MapPin, Navigation2 } from "lucide-react";
import { useState, useRef, useEffect } from "react";
import clsx from "clsx";
import { POI } from "@/types";
import { poiService } from "@/services/poiService";

interface SearchInputProps {
  onMenuClick: () => void;
  className?: string;
  pois: POI[]; // Liste complète pour fallback
  onSearch: (query: string) => void;
  onSelectResult: (poi: POI) => void;
  onLocateMe: () => void;
  recentSearches: string[];
  recentPois: POI[];
}

export const SearchInput = ({
  onMenuClick,
  className,
  pois,
  onLocateMe,
  onSearch,
  onSelectResult,
  recentSearches,
  recentPois
}: SearchInputProps) => {
  const [isFocused, setIsFocused] = useState(false);
  const [query, setQuery] = useState("");
  const [suggestions, setSuggestions] = useState<POI[]>([]);
  const inputRef = useRef<HTMLInputElement>(null);

  // --- LIVE SEARCH AVEC DEBOUNCE & BACKEND SEARCH GLOBAL ---
  useEffect(() => {
    const fetchSuggestions = async () => {
      // Si la recherche est vide ou trop courte
      if (query.trim().length < 2) {
        setSuggestions([]);
        return;
      }

      try {
        // Appeler la méthode searchGlobal (Recherche Backend sur Nom/Ville/Keywords)
        // Note: Assurez-vous d'avoir implémenté searchGlobal dans votre poiService.ts
        const results = await poiService.searchGlobal(query);
        
        if (results && results.length > 0) {
            setSuggestions(results.slice(0, 8));
        } else {
            // Fallback sur le filtrage local si le serveur ne renvoie rien
            throw new Error("Aucun résultat backend");
        }
      } catch (err) {
        // Fallback local intelligent sur Nom, Ville ou Tags
        const lowerQuery = query.toLowerCase();
        const localResults = pois.filter(p => 
          p.poi_name?.toLowerCase().includes(lowerQuery) ||
          p.address_city?.toLowerCase().includes(lowerQuery) ||
          p.poi_keywords?.some(k => k.toLowerCase().includes(lowerQuery))
        );
        setSuggestions(localResults.slice(0, 8));
      }
    };

    const timer = setTimeout(fetchSuggestions, 300);
    return () => clearTimeout(timer);
  }, [query, pois]);

  const handleSearchSubmit = (e?: React.FormEvent) => {
    e?.preventDefault();
    if (query.trim()) {
        onSearch(query);
        setIsFocused(false);
        inputRef.current?.blur();
    }
  };

  const handleSelectPoi = (poi: POI) => {
    setQuery(poi.poi_name);
    onSelectResult(poi); 
    setIsFocused(false);
    inputRef.current?.blur();
  };

  return (
    <div className={clsx("relative z-50", className)}>
      <form
        onSubmit={handleSearchSubmit}
        className={clsx(
          "flex items-center bg-white dark:bg-zinc-900 h-12 border border-zinc-200 dark:border-zinc-800 transition-all duration-200",
          isFocused ? "rounded-t-[24px] rounded-b-none shadow-2xl border-b-0" : "rounded-full shadow-lg hover:shadow-xl"
        )}
      >
        <button
          type="button"
          onClick={onMenuClick}
          className="pl-4 pr-2 text-zinc-500 hover:text-primary dark:text-zinc-400 dark:hover:text-primary transition-colors"
        >
          {isFocused ? <Search size={20} /> : <Menu size={22} />}
        </button>

        <input
          ref={inputRef}
          type="text"
          placeholder="Rechercher un lieu, une ville ou un tag..."
          className="flex-1 bg-transparent border-none outline-none text-[15px] text-zinc-900 dark:text-zinc-100 px-2 truncate font-medium"
          value={query}
          onFocus={() => setIsFocused(true)}
          onChange={(e) => {
            setQuery(e.target.value);
            if (e.target.value === "") onSearch("");
          }}
        />

        <div className="flex items-center gap-1 pr-2">
          {query && (
            <button
              type="button"
              onClick={() => { setQuery(""); onSearch(""); setSuggestions([]); }}
              className="p-2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"
            >
              <X size={18} />
            </button>
          )}

          <div className="h-6 w-px bg-zinc-200 dark:bg-zinc-800 mx-1"></div>

          <button
            type="button"
            onClick={(e) => { e.preventDefault(); onLocateMe(); }}
            className="p-1.5 hover:bg-primary/10 rounded-full group transition-all"
            title="Ma position"
          >
            <div className="w-8 h-8 bg-primary flex items-center justify-center rounded-full text-white shadow-md group-hover:scale-105 group-active:scale-95 transition-transform">
              <Navigation2 size={16} className="-rotate-45" fill="currentColor" />
            </div>
          </button>
        </div>
      </form>

      {/* --- MENU DÉROULANT --- */}
      {isFocused && (
        <>
          <div className="fixed inset-0 bg-black/5 dark:bg-white/5 z-[-1]" onClick={() => setIsFocused(false)} />
          <div className="absolute top-full left-0 w-full bg-white dark:bg-zinc-900 rounded-b-[24px] shadow-2xl border border-t-0 border-zinc-200 dark:border-zinc-800 pb-3 max-h-[70vh] overflow-y-auto">
            
            {/* SUGGESTIONS LIVE (Backend Results) */}
            {query.length >= 2 && (
              <div className="pt-2">
                {suggestions.length > 0 ? (
                  suggestions.map(poi => (
                    <SuggestionItem
                      key={poi.poi_id}
                      icon={<MapPin size={18} />}
                      title={poi.poi_name}
                      subtitle={`${poi.poi_category} • ${poi.address_city}`}
                      onClick={() => handleSelectPoi(poi)}
                      isLocation
                    />
                  ))
                ) : (
                  <div className="px-6 py-4 text-sm text-zinc-400 italic">Aucun résultat pour cette recherche...</div>
                )}
              </div>
            )}

            {/* HISTORIQUE ET RECENTS (Quand le champ est vide) */}
            {query.length < 2 && (
              <div className="pt-2">
                {recentSearches.length > 0 && (
                  <div className="mb-2">
                    <div className="px-6 py-2 text-[11px] font-bold text-zinc-400 uppercase tracking-[0.1em]">Recherches passées</div>
                    {recentSearches.slice(0, 3).map((term, i) => (
                      <SuggestionItem
                        key={`hist-${i}`}
                        icon={<History size={18} />}
                        title={term}
                        onClick={() => { setQuery(term); onSearch(term); setIsFocused(false); }}
                      />
                    ))}
                  </div>
                )}

                {recentPois.length > 0 && (
                  <div>
                    <div className="px-6 py-2 text-[11px] font-bold text-zinc-400 uppercase tracking-[0.1em]">Lieux consultés</div>
                    {recentPois.slice(0, 3).map((poi) => (
                      <SuggestionItem
                        key={`recent-poi-${poi.poi_id}`}
                        icon={<MapPin size={18} className="text-primary" />}
                        title={poi.poi_name}
                        subtitle={`${poi.poi_category} • ${poi.address_city}`}
                        onClick={() => handleSelectPoi(poi)}
                      />
                    ))}
                  </div>
                )}

                {recentSearches.length === 0 && recentPois.length === 0 && (
                   <div className="px-6 py-4 text-center">
                        <p className="text-sm text-zinc-400 font-medium italic">Commencez à explorer...</p>
                   </div>
                )}
              </div>
            )}
          </div>
        </>
      )}
    </div>
  );
};

// --- COMPOSANT INTERNE SUGGESTION ---
const SuggestionItem = ({ icon, title, subtitle, onClick, isLocation }: any) => (
  <div
    onClick={onClick}
    className="flex items-center gap-4 py-3 px-6 hover:bg-zinc-50 dark:hover:bg-zinc-800/50 cursor-pointer transition-colors group"
  >
    <div className={clsx(
      "w-9 h-9 min-w-[36px] rounded-xl flex items-center justify-center transition-colors",
      isLocation ? "bg-primary/10 text-primary" : "bg-zinc-100 dark:bg-zinc-800 text-zinc-500"
    )}>
      {icon}
    </div>
    <div className="flex flex-col overflow-hidden">
      <span className="text-[14px] font-bold text-zinc-800 dark:text-zinc-100 truncate group-hover:text-primary transition-colors">
        {title}
      </span>
      {subtitle && <span className="text-[12px] text-zinc-500 dark:text-zinc-400 truncate mt-0.5">{subtitle}</span>}
    </div>
  </div>
);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\navigation\CategoryBar.tsx
================================================================================

import { clsx } from "clsx";
import { CATEGORIES } from "@/data/categories";

interface CategoryBarProps {
  onSelect: (cat: string) => void;
  selected: string;
}

export const CategoryBar = ({ onSelect, selected }: CategoryBarProps) => {
  return (
    <div className="flex items-center gap-2 overflow-x-auto scrollbar-hide py-2 px-1 h-full mask-gradient-right">
      {CATEGORIES.map((cat) => (
        <button
          key={cat.id}
          onClick={() => onSelect(cat.id)}
          className={clsx(
            "flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-medium transition-all shadow-sm border whitespace-nowrap bg-white dark:bg-zinc-800",
            selected === cat.id
              ? "bg-zinc-900 text-white dark:bg-white dark:text-purple-400 border-transparent shadow-md" // Style "actif" google noir/blanc
              : "text-zinc-700 dark:text-zinc-200 border-zinc-200 hover:bg-zinc-100 dark:hover:bg-zinc-700 dark:border-zinc-700"
          )}
        >
          {cat.icon}
          <span>{cat.label}</span>
        </button>
      ))}
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\navigation\TopLayout.tsx
================================================================================

"use client";

import { SearchInput } from "./SearchInput";
import { CategoryBar } from "./CategoryBar";
import { Grip, UserCircle2, LogIn, LayoutDashboard } from "lucide-react";
import { POI, AppUser } from "@/types";
import { useRouter } from "next/navigation";
import { useEffect, useState } from "react";
import { authService } from "@/services/authService";
import { clsx } from "clsx";

interface TopLayoutProps {
  onToggleSidebar: () => void;
  allPois: POI[];
  selectedCategory: string;
  onSelectCategory: (cat: string) => void;
  onSearch: (query: string) => void;
  onSelectResult: (poi: POI) => void;
  onLocateMe: () => void;
  recentSearches: string[];
  recentPois: POI[];
}

export const TopLayout = ({
  onToggleSidebar,
  allPois,
  selectedCategory,
  onSelectCategory,
  onSearch,
  onLocateMe,
  onSelectResult,
  recentSearches,
  recentPois,
}: TopLayoutProps) => {
  const router = useRouter();
  const [user, setUser] = useState<AppUser | null>(null);

  useEffect(() => {
    // Récupération réelle de la session via le service
    const session = authService.getSession();
    setUser(session);
  }, []);

  const handleProfileClick = () => {
    if (user?.role === "SUPER_ADMIN") {
      router.push("/admin");
    } else {
      router.push("/profile");
    }
  };

  return (
    <div className="absolute top-0 left-0 w-full z-40 p-2 md:p-4 pointer-events-none flex flex-col md:flex-row items-start gap-3">
      
      {/* 1. BLOC RECHERCHE - Largeur fixe sur PC, Full sur mobile */}
      <div className="ml-16 pointer-events-auto w-full md:w-[380px] lg:w-[320px] shrink-0">
        <SearchInput
          onMenuClick={onToggleSidebar}
          pois={allPois}
          onSearch={onSearch}
          onSelectResult={onSelectResult}
          onLocateMe={onLocateMe}
          recentSearches={recentSearches}
          recentPois={recentPois}
          className="shadow-xl"
        />
      </div>

      {/* 2. BLOC CATÉGORIES ET AUTH - S'adapte au reste de l'espace */}
      <div className="flex-1 flex items-center justify-between gap-2 w-full pointer-events-auto overflow-hidden">
        
        {/* Barre de Catégories : Visible principalement sur Desktop/Tablet */}
        <div className="flex-1 hidden sm:block min-w-0">
          <CategoryBar
            selected={selectedCategory}
            onSelect={onSelectCategory}
          />
        </div>

        {/* SECTION UTILISATEUR / ACTIONS */}
        <div className="flex items-center gap-2 ml-auto pr-1 md:pr-0">
          
          {user ? (
            /* --- CAS CONNECTÉ --- */
            <div className="flex items-center gap-2 bg-white/90 dark:bg-zinc-900/90 backdrop-blur-md p-1.5 rounded-full border border-zinc-200 dark:border-zinc-800 shadow-lg">
              
              {/* Bouton Raccourci Admin (Optionnel) */}
              {user.role === "SUPER_ADMIN" && (
                <button 
                  onClick={() => router.push("/admin")}
                  className="p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-colors text-zinc-600 dark:text-zinc-400 hidden lg:block"
                  title="Panel Admin"
                >
                  <LayoutDashboard size={20} />
                </button>
              )}

              {/* Grip / Menu Applications (Style Google) */}
              <button className="p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition-colors text-zinc-600 dark:text-zinc-400 hidden md:block">
                <Grip size={20} />
              </button>

              {/* Avatar et Lien Profil */}
              <button
                onClick={handleProfileClick}
                className={clsx(
                  "relative group flex items-center justify-center",
                  "w-9 h-9 rounded-full overflow-hidden transition-all duration-300",
                  "border-2 border-primary/20 hover:border-primary active:scale-95 shadow-inner"
                )}
              >
                <div className="absolute inset-0 bg-primary/10 flex items-center justify-center">
                  <UserCircle2 size={38} className="text-primary/70 group-hover:scale-110 transition-transform" />
                </div>
                {/* On peut ajouter l'initiale de l'utilisateur par dessus si pas de photo */}
                <span className="relative z-10 text-[10px] font-black text-primary pointer-events-none">
                   {user.username.charAt(0).toUpperCase()}
                </span>
              </button>
            </div>
          ) : (
            /* --- CAS DÉCONNECTÉ --- */
            <button
              onClick={() => router.push("/signin")}
              className={clsx(
                "group relative flex items-center gap-2 px-6 py-2.5 rounded-full overflow-hidden",
                "bg-primary text-white font-bold text-sm",
                "shadow-lg shadow-primary/30",
                "transition-all duration-300 hover:shadow-primary/50 hover:scale-[1.03] active:scale-95"
              )}
            >
              {/* Effet Brillance / Hover */}
              <div className="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700" />
              
              <LogIn size={18} className="stroke-[3]" />
              <span className="whitespace-nowrap">Connexion</span>
            </button>
          )}
        </div>
      </div>
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\navigation\MobileNavbar.tsx
================================================================================

"use client";

import { Map, Bookmark, Plus, Route, Menu } from "lucide-react";
import { useRouter } from "next/navigation";
import { clsx } from "clsx";

interface MobileNavBarProps {
  currentView: "saved" | "recent" | "trips" | "mypois" | null;
  onViewChange: (view: "saved" | "recent" | "trips" | "mypois") => void;
  onOpenSidebar: () => void;
  onResetView: () => void;
}

export const MobileNavBar = ({ 
  currentView, 
  onViewChange, 
  onOpenSidebar,
  onResetView 
}: MobileNavBarProps) => {
  const router = useRouter();

  return (
    <div className="md:hidden fixed bottom-0 left-0 w-full z-50 px-4 pb-4 pt-0">
      {/* Container Flottant pour effet "Island" ou simple barre fixée */}
      <nav className="bg-white/95 dark:bg-zinc-900/95 backdrop-blur-lg border border-zinc-200 dark:border-zinc-800 rounded-2xl shadow-xl shadow-zinc-200/50 dark:shadow-black/50 h-[72px] flex items-center justify-around px-2">
        
        {/* 1. ACCUEIL / CARTE */}
        <NavItem 
          label="Carte" 
          icon={<Map size={24} />} 
          isActive={currentView === null}
          onClick={onResetView}
        />

        {/* 2. FAVORIS */}
        <NavItem 
          label="Favoris" 
          icon={<Bookmark size={24} />} 
          isActive={currentView === "saved"}
          onClick={() => onViewChange("saved")}
        />

        {/* 3. AJOUTER (Bouton Central Highlight) */}
        <button 
          onClick={() => router.push("/add-poi")}
          className="relative -top-6 flex flex-col items-center justify-center w-14 h-14 bg-primary text-white rounded-full shadow-lg shadow-primary/40 transform active:scale-95 transition-all border-4 border-zinc-50 dark:border-zinc-950"
        >
          <Plus size={32} />
        </button>

        {/* 4. TRAJETS */}
        <NavItem 
          label="Trajets" 
          icon={<Route size={24} />} 
          isActive={currentView === "trips"}
          onClick={() => onViewChange("trips")}
        />

        {/* 5. MENU (Ouvre la Sidebar existante) */}
        <NavItem 
          label="Menu" 
          icon={<Menu size={24} />} 
          isActive={false} // Le menu est un tiroir, pas un état actif de la nav
          onClick={onOpenSidebar}
        />

      </nav>
    </div>
  );
};

// Sous-composant pour les boutons classiques
const NavItem = ({ label, icon, isActive, onClick }: any) => (
  <button 
    onClick={onClick}
    className={clsx(
      "flex flex-col items-center justify-center w-16 gap-1 transition-colors",
      isActive 
        ? "text-primary font-bold" 
        : "text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"
    )}
  >
    <div className={clsx("transition-transform", isActive && "scale-110")}>
      {icon}
    </div>
    <span className="text-[10px] font-medium">{label}</span>
  </button>
);


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\admin\utils.ts
================================================================================

// Utility functions for the admin dashboard

export const formatDate = (dateString: string): string => {
  const date = new Date(dateString);
  return new Intl.DateTimeFormat('fr-FR', {
    day: '2-digit',
    month: 'short',
    year: 'numeric',
  }).format(date);
};

export const formatDateTime = (dateString: string): string => {
  const date = new Date(dateString);
  return new Intl.DateTimeFormat('fr-FR', {
    day: '2-digit',
    month: 'short',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
  }).format(date);
};

export const formatNumber = (num: number): string => {
  return new Intl.NumberFormat('fr-FR').format(num);
};

export const formatCompactNumber = (num: number): string => {
  if (num >= 1000000) {
    return `${(num / 1000000).toFixed(1)}M`;
  }
  if (num >= 1000) {
    return `${(num / 1000).toFixed(1)}K`;
  }
  return num.toString();
};

export const formatPercentage = (value: number, total: number): string => {
  if (total === 0) return '0%';
  return `${((value / total) * 100).toFixed(1)}%`;
};

export const getPoiCategoryLabel = (category: string): string => {
  const labels: Record<string, string> = {
    FOOD_DRINK: 'Alimentation & Boissons',
    ACCOMMODATION: 'Hébergement',
    SHOPPING_RETAIL: 'Commerce & Retail',
    TRANSPORTATION: 'Transport',
    HEALTH_WELLNESS: 'Santé & Bien-être',
    LEISURE_CULTURE: 'Loisirs & Culture',
    PUBLIC_ADMIN_SERVICES: 'Administration Publique',
    FINANCE: 'Finance',
    EDUCATION: 'Éducation',
    WORSHIP_SPIRITUALITY: 'Spiritualité',
  };
  return labels[category] || category;
};

export const getPoiTypeLabel = (type: string): string => {
  const labels: Record<string, string> = {
    RESTAURANT: 'Restaurant',
    CAFE: 'Café',
    BAR: 'Bar',
    HOTEL: 'Hôtel',
    HOPITAL: 'Hôpital',
    BANQUE: 'Banque',
    ECOLE: 'École',
    MUSEE: 'Musée',
    PARC_JARDIN: 'Parc/Jardin',
    // Add more as needed
  };
  return labels[type] || type.replace(/_/g, ' ');
};

export const getTrendIndicator = (current: number, previous: number) => {
  if (previous === 0) return { direction: 'neutral' as const, percentage: 0 };
  const change = ((current - previous) / previous) * 100;
  return {
    direction: change > 0 ? 'up' : change < 0 ? 'down' : 'neutral' as const,
    percentage: Math.abs(change),
  };
};

export const debounce = <T extends (...args: any[]) => any>(
  func: T,
  wait: number
): ((...args: Parameters<T>) => void) => {
  let timeout: NodeJS.Timeout;
  return (...args: Parameters<T>) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
};

export const cn = (...classes: (string | undefined | null | false)[]): string => {
  return classes.filter(Boolean).join(' ');
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\admin\StatCards.tsx
================================================================================

'use client';

import React from 'react';
import { cn } from '@/components/admin/utils';

interface StatsCardProps {
  title: string;
  value: string | number;
  subtitle?: string;
  icon: React.ReactNode;
  trend?: {
    direction: 'up' | 'down' | 'neutral';
    percentage: number;
  };
  variant?: 'default' | 'accent' | 'success' | 'warning';
}

export const StatsCard: React.FC<StatsCardProps> = ({
  title,
  value,
  subtitle,
  icon,
  trend,
  variant = 'default',
}) => {
  const variantClasses = {
    default: 'from-violet-500/10 to-purple-500/10 border-violet-200 dark:border-violet-800',
    accent: 'from-fuchsia-500/10 to-pink-500/10 border-fuchsia-200 dark:border-fuchsia-800',
    success: 'from-emerald-500/10 to-green-500/10 border-emerald-200 dark:border-emerald-800',
    warning: 'from-amber-500/10 to-orange-500/10 border-amber-200 dark:border-amber-800',
  };

  return (
    <div
      className={cn(
        'relative overflow-hidden rounded-2xl border bg-gradient-to-br p-6 transition-all duration-300 hover:scale-[1.02] hover:shadow-xl',
        variantClasses[variant]
      )}
      style={{
        animation: 'fadeInUp 0.5s ease-out',
      }}
    >
      <div className="flex items-start justify-between">
        <div className="flex-1">
          <p className="text-sm font-medium text-gray-600 dark:text-gray-400">{title}</p>
          <h3 className="mt-2 text-3xl font-bold text-gray-900 dark:text-white">{value}</h3>
          {subtitle && (
            <p className="mt-1 text-xs text-gray-500 dark:text-gray-400">{subtitle}</p>
          )}
          {trend && (
            <div className="mt-2 flex items-center gap-1">
              {trend.direction === 'up' ? (
                <svg className="h-4 w-4 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 10l7-7m0 0l7 7m-7-7v18" />
                </svg>
              ) : trend.direction === 'down' ? (
                <svg className="h-4 w-4 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 14l-7 7m0 0l-7-7m7 7V3" />
                </svg>
              ) : (
                <svg className="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 12h14" />
                </svg>
              )}
              <span
                className={cn(
                  'text-xs font-medium',
                  trend.direction === 'up' && 'text-emerald-600 dark:text-emerald-400',
                  trend.direction === 'down' && 'text-red-600 dark:text-red-400',
                  trend.direction === 'neutral' && 'text-gray-600 dark:text-gray-400'
                )}
              >
                {trend.percentage.toFixed(1)}%
              </span>
            </div>
          )}
        </div>
        <div className="rounded-xl bg-white/50 p-3 dark:bg-gray-800/50">
          {icon}
        </div>
      </div>
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\admin\Chart.tsx
================================================================================

'use client';

import React, { useEffect, useRef } from 'react';

interface ChartData {
  label: string;
  value: number;
  color?: string;
}

interface ChartProps {
  type: 'line' | 'bar' | 'doughnut' | 'area';
  data: ChartData[];
  title?: string;
  height?: number;
}

export const Chart: React.FC<ChartProps> = ({ type, data, title, height = 300 }) => {
  const canvasRef = useRef<HTMLCanvasElement>(null);

  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    if (!ctx) return;

    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    
    canvas.width = rect.width * dpr;
    canvas.height = height * dpr;
    
    ctx.scale(dpr, dpr);
    canvas.style.width = rect.width + 'px';
    canvas.style.height = height + 'px';

    ctx.clearRect(0, 0, rect.width, height);

    const maxValue = Math.max(...data.map(d => d.value));
    const padding = 40;
    const chartWidth = rect.width - padding * 2;
    const chartHeight = height - padding * 2;

    if (type === 'bar') {
      const barWidth = chartWidth / data.length - 10;
      data.forEach((item, index) => {
        const barHeight = (item.value / maxValue) * chartHeight;
        const x = padding + index * (chartWidth / data.length);
        const y = height - padding - barHeight;

        const gradient = ctx.createLinearGradient(0, y, 0, height - padding);
        gradient.addColorStop(0, item.color || '#8b5cf6');
        gradient.addColorStop(1, item.color ? item.color + '40' : '#8b5cf640');

        ctx.fillStyle = gradient;
        ctx.fillRect(x + 5, y, barWidth, barHeight);

        ctx.fillStyle = '#6b7280';
        ctx.font = '12px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText(item.label, x + barWidth / 2 + 5, height - padding + 20);
      });
    } else if (type === 'line' || type === 'area') {
      ctx.beginPath();
      data.forEach((item, index) => {
        const x = padding + (index / (data.length - 1)) * chartWidth;
        const y = height - padding - (item.value / maxValue) * chartHeight;

        if (index === 0) {
          ctx.moveTo(x, y);
        } else {
          ctx.lineTo(x, y);
        }
      });

      if (type === 'area') {
        ctx.lineTo(padding + chartWidth, height - padding);
        ctx.lineTo(padding, height - padding);
        ctx.closePath();

        const gradient = ctx.createLinearGradient(0, padding, 0, height - padding);
        gradient.addColorStop(0, '#8b5cf680');
        gradient.addColorStop(1, '#8b5cf610');
        ctx.fillStyle = gradient;
        ctx.fill();
      }

      ctx.strokeStyle = '#8b5cf6';
      ctx.lineWidth = 3;
      ctx.stroke();

      data.forEach((item, index) => {
        const x = padding + (index / (data.length - 1)) * chartWidth;
        const y = height - padding - (item.value / maxValue) * chartHeight;

        ctx.beginPath();
        ctx.arc(x, y, 5, 0, Math.PI * 2);
        ctx.fillStyle = '#8b5cf6';
        ctx.fill();
        ctx.strokeStyle = '#ffffff';
        ctx.lineWidth = 2;
        ctx.stroke();
      });
    } else if (type === 'doughnut') {
      const centerX = rect.width / 2;
      const centerY = height / 2;
      const radius = Math.min(chartWidth, chartHeight) / 2 - 20;
      const innerRadius = radius * 0.6;

      const total = data.reduce((sum, item) => sum + item.value, 0);
      let currentAngle = -Math.PI / 2;

      const colors = ['#8b5cf6', '#a78bfa', '#c4b5fd', '#ddd6fe', '#ede9fe'];

      data.forEach((item, index) => {
        const sliceAngle = (item.value / total) * Math.PI * 2;

        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
        ctx.arc(centerX, centerY, innerRadius, currentAngle + sliceAngle, currentAngle, true);
        ctx.closePath();

        ctx.fillStyle = item.color || colors[index % colors.length];
        ctx.fill();

        currentAngle += sliceAngle;
      });
    }

    // Y-axis
    ctx.strokeStyle = '#e5e7eb';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(padding, padding);
    ctx.lineTo(padding, height - padding);
    ctx.stroke();

    // X-axis
    ctx.beginPath();
    ctx.moveTo(padding, height - padding);
    ctx.lineTo(rect.width - padding, height - padding);
    ctx.stroke();
  }, [data, type, height]);

  return (
    <div className="rounded-2xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800">
      {title && (
        <h3 className="mb-4 text-lg font-semibold text-gray-900 dark:text-white">{title}</h3>
      )}
      <canvas ref={canvasRef} className="w-full" />
      {type === 'doughnut' && (
        <div className="mt-4 flex flex-wrap gap-3">
          {data.map((item, index) => (
            <div key={index} className="flex items-center gap-2">
              <div
                className="h-3 w-3 rounded-full"
                style={{
                  backgroundColor: item.color || ['#8b5cf6', '#a78bfa', '#c4b5fd', '#ddd6fe', '#ede9fe'][index % 5],
                }}
              />
              <span className="text-sm text-gray-600 dark:text-gray-400">
                {item.label}: {item.value}
              </span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\admin\RecentActivity.tsx
================================================================================

'use client';

import React from 'react';
import { formatDateTime } from '@/components/admin/utils';

interface Activity {
  id: string;
  type: 'poi' | 'review' | 'user' | 'access';
  title: string;
  description: string;
  timestamp: string;
  user?: string;
  icon?: React.ReactNode;
}

interface RecentActivityProps {
  activities: Activity[];
  maxItems?: number;
}

export const RecentActivity: React.FC<RecentActivityProps> = ({ activities, maxItems = 10 }) => {
  const displayActivities = activities.slice(0, maxItems);

  const getActivityIcon = (type: string) => {
    switch (type) {
      case 'poi':
        return (
          <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        );
      case 'review':
        return (
          <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
          </svg>
        );
      case 'user':
        return (
          <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
        );
      case 'access':
        return (
          <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
          </svg>
        );
      default:
        return (
          <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        );
    }
  };

  const getActivityColor = (type: string) => {
    switch (type) {
      case 'poi':
        return 'bg-violet-100 text-violet-600 dark:bg-violet-900/30 dark:text-violet-400';
      case 'review':
        return 'bg-amber-100 text-amber-600 dark:bg-amber-900/30 dark:text-amber-400';
      case 'user':
        return 'bg-emerald-100 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400';
      case 'access':
        return 'bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400';
      default:
        return 'bg-gray-100 text-gray-600 dark:bg-gray-900/30 dark:text-gray-400';
    }
  };

  return (
    <div className="rounded-2xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800">
      <h3 className="mb-4 text-lg font-semibold text-gray-900 dark:text-white">
        Activité Récente
      </h3>
      <div className="space-y-4">
        {displayActivities.map((activity, index) => (
          <div
            key={activity.id}
            className="flex gap-4 border-b border-gray-100 pb-4 last:border-0 last:pb-0 dark:border-gray-700"
            style={{
              animation: `fadeInLeft 0.5s ease-out ${index * 0.1}s both`,
            }}
          >
            <div className={`flex h-10 w-10 shrink-0 items-center justify-center rounded-lg ${getActivityColor(activity.type)}`}>
              {activity.icon || getActivityIcon(activity.type)}
            </div>
            <div className="flex-1 min-w-0">
              <p className="text-sm font-medium text-gray-900 dark:text-white">
                {activity.title}
              </p>
              <p className="text-xs text-gray-500 dark:text-gray-400 mt-0.5 truncate">
                {activity.description}
              </p>
              {activity.user && (
                <p className="text-xs text-gray-400 dark:text-gray-500 mt-1">
                  Par {activity.user}
                </p>
              )}
            </div>
            <div className="shrink-0 text-right">
              <p className="text-xs text-gray-400 dark:text-gray-500">
                {formatDateTime(activity.timestamp)}
              </p>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\admin\DataTable.tsx
================================================================================

'use client';

import React, { useState } from 'react';
import { cn } from '@/components/admin/utils';

export interface Column<T> {
  key: string;
  label: string;
  render?: (row: T) => React.ReactNode;
  sortable?: boolean;
  width?: string;
}

interface DataTableProps<T> {
  columns: Column<T>[];
  data: T[];
  onRowClick?: (row: T) => void;
  searchable?: boolean;
  searchPlaceholder?: string;
  actions?: (row: T) => React.ReactNode;
}

export function DataTable<T extends Record<string, any>>({
  columns,
  data,
  onRowClick,
  searchable = true,
  searchPlaceholder = 'Rechercher...',
  actions,
}: DataTableProps<T>) {
  const [searchTerm, setSearchTerm] = useState('');
  const [sortConfig, setSortConfig] = useState<{ key: string; direction: 'asc' | 'desc' } | null>(null);

  const handleSort = (key: string) => {
    setSortConfig(current => {
      if (current?.key === key) {
        return { key, direction: current.direction === 'asc' ? 'desc' : 'asc' };
      }
      return { key, direction: 'asc' };
    });
  };

  const filteredData = React.useMemo(() => {
    let result = [...data];

    // Search
    if (searchTerm) {
      result = result.filter(row =>
        Object.values(row).some(value =>
          String(value).toLowerCase().includes(searchTerm.toLowerCase())
        )
      );
    }

    // Sort
    if (sortConfig) {
      result.sort((a, b) => {
        const aVal = a[sortConfig.key];
        const bVal = b[sortConfig.key];

        if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;
        if (aVal > bVal) return sortConfig.direction === 'asc' ? 1 : -1;
        return 0;
      });
    }

    return result;
  }, [data, searchTerm, sortConfig]);

  return (
    <div className="rounded-2xl border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
      {searchable && (
        <div className="border-b border-gray-200 p-4 dark:border-gray-700">
          <div className="relative">
            <input
              type="text"
              placeholder={searchPlaceholder}
              value={searchTerm}
              onChange={(e) => setSearchTerm(e.target.value)}
              className="w-full rounded-lg border border-gray-300 bg-white px-4 py-2 pl-10 text-sm focus:border-violet-500 focus:outline-none focus:ring-2 focus:ring-violet-500/20 dark:border-gray-600 dark:bg-gray-700 dark:text-white"
            />
            <svg
              className="absolute left-3 top-2.5 h-5 w-5 text-gray-400"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                strokeLinecap="round"
                strokeLinejoin="round"
                strokeWidth={2}
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              />
            </svg>
          </div>
        </div>
      )}

      <div className="overflow-x-auto">
        <table className="w-full">
          <thead className="border-b border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-900/50">
            <tr>
              {columns.map((column) => (
                <th
                  key={column.key}
                  className={cn(
                    'px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400',
                    column.sortable && 'cursor-pointer hover:text-violet-600 dark:hover:text-violet-400',
                    column.width
                  )}
                  onClick={() => column.sortable && handleSort(column.key)}
                >
                  <div className="flex items-center gap-2">
                    {column.label}
                    {column.sortable && sortConfig?.key === column.key && (
                      <svg
                        className={cn(
                          'h-4 w-4 transition-transform',
                          sortConfig.direction === 'desc' && 'rotate-180'
                        )}
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                      >
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" />
                      </svg>
                    )}
                  </div>
                </th>
              ))}
              {actions && (
                <th className="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400">
                  Actions
                </th>
              )}
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
            {filteredData.length === 0 ? (
              <tr>
                <td
                  colSpan={columns.length + (actions ? 1 : 0)}
                  className="px-6 py-12 text-center text-gray-500 dark:text-gray-400"
                >
                  Aucune donnée disponible
                </td>
              </tr>
            ) : (
              filteredData.map((row, index) => (
                <tr
                  key={index}
                  onClick={() => onRowClick?.(row)}
                  className={cn(
                    'transition-colors',
                    onRowClick && 'cursor-pointer hover:bg-violet-50 dark:hover:bg-violet-900/10'
                  )}
                  style={{
                    animation: `fadeInUp 0.3s ease-out ${index * 0.05}s both`,
                  }}
                >
                  {columns.map((column) => (
                    <td
                      key={column.key}
                      className="px-6 py-4 text-sm text-gray-900 dark:text-gray-100"
                    >
                      {column.render ? column.render(row) : row[column.key]}
                    </td>
                  ))}
                  {actions && (
                    <td className="px-6 py-4 text-right text-sm">
                      {actions(row)}
                    </td>
                  )}
                </tr>
              ))
            )}
          </tbody>
        </table>
      </div>
    </div>
  );
}


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\components\admin\Sidebar.tsx
================================================================================

'use client';

import React, { useState } from 'react';
import { cn } from '@/components/admin/utils';

interface SidebarProps {
  onNavigate?: (section: string) => void;
  currentSection?: string;
}

interface NavItem {
  id: string;
  label: string;
  icon: React.ReactNode;
  badge?: number;
}

export const Sidebar: React.FC<SidebarProps> = ({ onNavigate, currentSection = 'dashboard' }) => {
  const [isCollapsed, setIsCollapsed] = useState(false);

  const navItems: NavItem[] = [
    {
      id: 'dashboard',
      label: 'Tableau de bord',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      ),
    },
    {
      id: 'pois',
      label: 'Points d\'Intérêt',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
      ),
    },
    {
      id: 'reviews',
      label: 'Avis',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
        </svg>
      ),
    },
    {
      id: 'users',
      label: 'Utilisateurs',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
      ),
    },
    {
      id: 'organizations',
      label: 'Organisations',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
        </svg>
      ),
    },
    {
      id: 'analytics',
      label: 'Analytiques',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
        </svg>
      ),
    },
    {
      id: 'content',
      label: 'Contenu',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
        </svg>
      ),
    },
    {
      id: 'settings',
      label: 'Paramètres',
      icon: (
        <svg className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
      ),
    },
  ];

  return (
    <aside
      className={cn(
        'sticky top-0 h-screen border-r border-gray-200 bg-white transition-all duration-300 dark:border-gray-700 dark:bg-gray-800',
        isCollapsed ? 'w-20' : 'w-64'
      )}
    >
      <div className="flex h-full flex-col">
        {/* Header */}
        <div className="flex items-center justify-between border-b border-gray-200 p-6 dark:border-gray-700">
          {!isCollapsed && (
            <h1 className="bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-xl font-bold text-transparent">
              POI Admin
            </h1>
          )}
          <button
            onClick={() => setIsCollapsed(!isCollapsed)}
            className="rounded-lg p-2 hover:bg-gray-100 dark:hover:bg-gray-700"
          >
            <svg
              className={cn('h-5 w-5 text-gray-600 transition-transform dark:text-gray-400', isCollapsed && 'rotate-180')}
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
            </svg>
          </button>
        </div>

        {/* Navigation */}
        <nav className="flex-1 overflow-y-auto p-4">
          <ul className="space-y-2">
            {navItems.map((item, index) => (
              <li
                key={item.id}
                style={{
                  animation: `fadeInLeft 0.3s ease-out ${index * 0.05}s both`,
                }}
              >
                <button
                  onClick={() => onNavigate?.(item.id)}
                  className={cn(
                    'group flex w-full items-center gap-3 rounded-lg px-4 py-3 text-sm font-medium transition-all',
                    currentSection === item.id
                      ? 'bg-gradient-to-r from-violet-500 to-purple-500 text-white shadow-lg shadow-violet-500/25'
                      : 'text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700'
                  )}
                >
                  <span className={cn(currentSection !== item.id && 'group-hover:scale-110', 'transition-transform')}>
                    {item.icon}
                  </span>
                  {!isCollapsed && (
                    <>
                      <span className="flex-1 text-left">{item.label}</span>
                      {item.badge && (
                        <span className="flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white">
                          {item.badge}
                        </span>
                      )}
                    </>
                  )}
                </button>
              </li>
            ))}
          </ul>
        </nav>

        {/* User Profile */}
        <div className="border-t border-gray-200 p-4 dark:border-gray-700">
          <button className="flex w-full items-center gap-3 rounded-lg px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700">
            <div className="flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-violet-500 to-purple-500 text-white">
              <span className="text-sm font-bold">AD</span>
            </div>
            {!isCollapsed && (
              <div className="flex-1 text-left">
                <p className="text-sm font-medium text-gray-900 dark:text-white">Admin</p>
                <p className="text-xs text-gray-500 dark:text-gray-400">admin@navigoo.com</p>
              </div>
            )}
          </button>
        </div>
      </div>
    </aside>
  );
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\routingService.ts
================================================================================

import { Location, RouteStats, TransportMode } from "@/types";

// Vitesses moyennes en km/h
const AVERAGE_SPEEDS = {
  driving: 40,    // Voiture en ville
  cycling: 15,    // Vélo
  walking: 5      // Marche
};

interface RouteStep {
  instruction: string;
  distance: number;
  duration: number;
  location: [number, number];
}

export interface EnrichedRouteStats extends RouteStats {
  steps: RouteStep[];
  averageSpeed: number;
}

export const getRoute = async (
  start: Location,
  end: Location,
  mode: TransportMode = "driving",
  apiKey: string
): Promise<EnrichedRouteStats | null> => {
  try {
    // Conversion du mode pour OSRM
    let profile = "driving";
    if (mode === "cycling") profile = "bike";
    if (mode === "walking") profile = "foot";

    // Requête OSRM avec steps=true pour obtenir les instructions
    const url = `https://router.project-osrm.org/route/v1/${profile}/${start.longitude},${start.latitude};${end.longitude},${end.latitude}?overview=full&geometries=geojson&steps=true`;

    console.log("🚗 Fetching Route:", url);

    const response = await fetch(url);

    if (!response.ok) {
      console.error(`❌ Erreur API Route: ${response.status}`);
      return null;
    }

    const data = await response.json();

    if (data.code !== "Ok" || !data.routes || data.routes.length === 0) {
      console.warn("⚠️ Pas de route trouvée par OSRM");
      return null;
    }

    const route = data.routes[0];
    const legs = route.legs || [];
    
    // Extraction des étapes détaillées
    const steps: RouteStep[] = [];
    
    legs.forEach((leg: any) => {
      leg.steps?.forEach((step: any) => {
        steps.push({
          instruction: step.maneuver?.type 
            ? formatInstruction(step.maneuver.type, step.name)
            : "Continuer tout droit",
          distance: step.distance,
          duration: step.duration,
          location: step.maneuver?.location || [0, 0]
        });
      });
    });

    // Recalcul de la durée selon la vitesse moyenne réelle
    const averageSpeed = AVERAGE_SPEEDS[mode];
    const distanceKm = route.distance / 1000;
    const recalculatedDuration = (distanceKm / averageSpeed) * 3600; // en secondes

    return {
      distance: route.distance,
      duration: recalculatedDuration,
      geometry: route.geometry,
      steps,
      averageSpeed
    };

  } catch (error) {
    console.error("❌ Exception service routage:", error);
    return null;
  }
};

// Formatage des instructions de navigation
const formatInstruction = (type: string, streetName?: string): string => {
  const instructions: Record<string, string> = {
    'turn': `Tourner ${streetName ? `vers ${streetName}` : ''}`,
    'new name': `Continuer sur ${streetName || 'la route'}`,
    'depart': `Partir ${streetName ? `vers ${streetName}` : ''}`,
    'arrive': `Arrivée à destination`,
    'merge': 'Se rabattre',
    'on ramp': 'Prendre la bretelle',
    'off ramp': 'Sortir de la bretelle',
    'fork': 'Bifurquer',
    'end of road': 'Bout de route',
    'continue': `Continuer ${streetName ? `sur ${streetName}` : 'tout droit'}`,
    'roundabout': 'Au rond-point',
    'rotary': 'Au carrefour giratoire',
    'roundabout turn': 'Au rond-point, tourner',
  };

  return instructions[type] || `Continuer ${streetName || 'tout droit'}`;
};

// Calculer la distance entre deux points (Haversine)
export const calculateDistance = (point1: Location, point2: Location): number => {
  const R = 6371e3; // Rayon de la Terre en mètres
  const φ1 = point1.latitude * Math.PI / 180;
  const φ2 = point2.latitude * Math.PI / 180;
  const Δφ = (point2.latitude - point1.latitude) * Math.PI / 180;
  const Δλ = (point2.longitude - point1.longitude) * Math.PI / 180;

  const a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +
          Math.cos(φ1) * Math.cos(φ2) *
          Math.sin(Δλ/2) * Math.sin(Δλ/2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

  return R * c; // Distance en mètres
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\poiService.ts
================================================================================

import { CreatePoiDTO, POI } from "@/types";
import { authService } from "./authService";

const API_BASE_URL = "https://poi-navigoo.pynfi.com";

/**
 * Fonction utilitaire pour transformer le format à plat du Backend Java
 * vers le format imbriqué { location: { latitude, longitude } } attendu par le Frontend.
 */
const mapPoiFromBackend = (data: any): POI => {
  if (!data) return data;
  
  return {
    ...data,
    location: data.location || {
      latitude: data.latitude ?? 0,
      longitude: data.longitude ?? 0
    },
    poi_images_urls: data.poi_images_urls || [],
    poi_amenities: data.poi_amenities || [],
    poi_keywords: data.poi_keywords || [],
    poi_contacts: data.poi_contacts || { phone: "", website: "" },
    rating: data.rating ?? 0,
    review_count: data.review_count ?? 0,
    popularity_score: data.popularity_score ?? 0
  };
};

class PoiService {
  /**
   * Wrapper générique pour fetch avec gestion d'erreurs
   */
  private async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {
    const url = `${API_BASE_URL}${endpoint}`;
    
    if (process.env.NODE_ENV === "development") {
        console.log(`📡 Fetching: ${url}`);
    }

    const response = await fetch(url, {
      headers: {
        "Content-Type": "application/json",
        "Accept": "application/json",
      },
      ...options,
    });

    if (!response.ok) {
        let errorMessage = response.statusText;
        try {
            const errorBody = await response.text();
            errorMessage = errorBody || response.statusText;
        } catch (e) {}
        
        throw new Error(`Erreur API (${response.status}): ${errorMessage}`);
    }

    if (response.status === 204) return {} as T;
    return response.json();
  }

  // ==========================================
  // LECTURE (GET)
  // ==========================================

  async getAllPois(): Promise<POI[]> {
    const data = await this.request<any[]>("/api/pois");
    return data.map(mapPoiFromBackend);
  }

  async getPoiById(poiId: string): Promise<POI> {
    const data = await this.request<any>(`/api/pois/${poiId}`);
    return mapPoiFromBackend(data);
  }

  async searchPoisByLocation(latitude: number, longitude: number, radiusKm: number = 10): Promise<POI[]> {
    const params = new URLSearchParams({
      latitude: latitude.toString(),
      longitude: longitude.toString(),
      radiusKm: radiusKm.toString(),
    });
    const data = await this.request<any[]>(`/api/pois/location?${params.toString()}`);
    return data.map(mapPoiFromBackend);
  }

  async getPoisByCategory(category: string): Promise<POI[]> {
    const data = await this.request<any[]>(`/api/pois/category/${category}`);
    return data.map(mapPoiFromBackend);
  }

  async getPoisByCity(city: string): Promise<POI[]> {
    const data = await this.request<any[]>(`/api/pois/city/${encodeURIComponent(city)}`);
    return data.map(mapPoiFromBackend);
  }

  async searchPoisByName(name: string): Promise<POI[]> {
    const data = await this.request<any[]>(`/api/pois/name/${encodeURIComponent(name)}`);
    return data.map(mapPoiFromBackend);
  }

  async getTopPopularPois(limit: number = 10): Promise<POI[]> {
    const data = await this.request<any[]>(`/api/pois/popular?limit=${limit}`);
    return data.map(mapPoiFromBackend);
  }

  async getPoisByType(type: string): Promise<POI[]> {
    const data = await this.request<any[]>(`/api/pois/type/${encodeURIComponent(type)}`);
    return data.map(mapPoiFromBackend);
  }

  async getPoisByUser(userId: string): Promise<POI[]> {
    const data = await this.request<any[]>(`/api/pois/user/${userId}`);
    return data.map(mapPoiFromBackend);
  }

  async getPoisByOrganization(orgId: string, type: 'active' | 'all' = 'active'): Promise<POI[]> {
    const suffix = type === 'all' ? '/all' : '';
    const data = await this.request<any[]>(`/api/pois/organization/${orgId}${suffix}`);
    return data.map(mapPoiFromBackend);
  }

  // ==========================================
  // ÉCRITURE (POST / PUT / DELETE)
  // ==========================================
  
  async createPoi(formData: any): Promise<POI> {
    const user = authService.getSession();
    if (!user) throw new Error("Session expirée.");

    // MAPPING des types POI selon catégorie
    const getValidPoiType = (category: string, type: string) => {
        if (type && type !== "OTHER") return type; 
        switch(category) {
            case "FOOD_DRINK": return "RESTAURANT";
            case "ACCOMMODATION": return "HOTEL";
            case "WORSHIP_SPIRITUALITY": return "AUTRE_LIEU_CULTE";
            case "LEISURE_CULTURE": return "SITE_TOURISTIQUE";
            case "PUBLIC_ADMIN_SERVICES": return "MAIRIE";
            default: return "SITE_TOURISTIQUE";
        }
    };

    // Convertir Base64 image en URL si nécessaire
    let imageUrl = "";
    if (formData.poi_images_urls && formData.poi_images_urls[0]) {
      const img = formData.poi_images_urls[0];
      // Si c'est une vraie URL, on la garde, sinon c'est du Base64 qu'on ignore pour l'instant
      if (img.startsWith("http")) {
        imageUrl = img;
      }
    }

    // Construction du payload MINIMAL VALIDE
    const payload = {
      organization_id: user.organizationId,
      town_id: null,
      created_by_user_id: user.userId,
      poi_name: formData.poi_name,
      poi_type: getValidPoiType(formData.poi_category, formData.poi_type),
      poi_category: formData.poi_category || "LEISURE_CULTURE",
      
      // Champs obligatoires
      poi_long_name: formData.poi_name,
      poi_short_name: formData.poi_name.substring(0, Math.min(15, formData.poi_name.length)),
      poi_friendly_name: formData.poi_name,
      poi_description: formData.poi_description || "",
      
      // Logo Base64 minimal valide (image 1x1 transparente)
      poi_logo: "R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7", 

      latitude: formData.location?.latitude ?? 3.86667,
      longitude: formData.location?.longitude ?? 11.51667,
      
      // Adresse
      address_street_number: "1",
      address_street_name: formData.address_informal || "",
      address_city: formData.address_city || "Yaoundé",
      address_state_province: formData.address_state_province || "Centre",
      address_postal_code: formData.postalCode || "0000",
      address_country: formData.address_country || "Cameroun",
      address_informal: formData.address_informal || "",
      
      website_url: formData.poi_contacts?.website || "",
      
      // Objets et Tableaux (DOIVENT être présents)
      operation_time_plan: {}, 
      poi_contacts: {
          phone: formData.poi_contacts?.phone || "",
          email: formData.poi_contacts?.email || ""
      },
      poi_images_urls: imageUrl ? [imageUrl] : [],
      poi_amenities: formData.poi_amenities || [],
      poi_keywords: formData.poi_keywords || [],
      poi_type_tags: [],
      
      popularity_score: 0.0,
      is_active: true
    };

    console.log("🚀 Envoi au Backend (Payload Complet) :", payload);

    const result = await this.request<any>("/api/pois", {
      method: "POST",
      body: JSON.stringify(payload),
    });
    return mapPoiFromBackend(result);
  }

  async updatePoi(poiId: string, poiData: Partial<POI>): Promise<POI> {
    const result = await this.request<any>(`/api/pois/${poiId}`, {
      method: "PUT",
      body: JSON.stringify(poiData),
    });
    return mapPoiFromBackend(result);
  }

  async deletePoi(poiId: string): Promise<void> {
    return this.request<void>(`/api/pois/${poiId}`, { method: "DELETE" });
  }

  // ==========================================
  // AUTRES ACTIONS
  // ==========================================

  async checkPoiNameExists(name: string, organizationId: string, excludeId?: string): Promise<boolean> {
    const params = new URLSearchParams({ name, organizationId });
    if (excludeId) params.append("excludeId", excludeId);
    return this.request<boolean>(`/api/pois/check-name?${params.toString()}`);
  }

  async activatePoi(poiId: string): Promise<void> {
    return this.request<void>(`/api/pois/${poiId}/activate`, { method: "PATCH" });
  }

  async deactivatePoi(poiId: string): Promise<void> {
    return this.request<void>(`/api/pois/${poiId}/desactivate`, { method: "PATCH" });
  }

  async updatePopularityScore(poiId: string, score: number): Promise<void> {
    return this.request<void>(`/api/pois/${poiId}/popularity?score=${score}`, { method: "PATCH" });
  }

  // Ajoute cette méthode pour une recherche globale
  async searchGlobal(query: string): Promise<POI[]> {
    // Cette méthode tente de chercher par nom, puis par ville, puis fusionne les tags
    // Idéalement, le backend devrait avoir un endpoint /search?q=...
    const [byName, byCity] = await Promise.all([
      this.searchPoisByName(query),
      this.getPoisByCity(query)
    ]);
    
    // Fusion unique par ID
    const combined = [...byName, ...byCity];
    return Array.from(new Map(combined.map(item => [item.poi_id, item])).values());
  }

}

export const poiService = new PoiService();


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\authService.ts
================================================================================

import { AppUser } from "@/types";

const API_BASE_URL = "https://poi-navigoo.pynfi.com";
const DEFAULT_ORG_ID = "83ce5943-d920-454f-908d-3248a73aafdf"; 

class AuthService {
  /**
   * Inscrit un nouvel utilisateur selon le DTO Java
   */
  async register(userData: Partial<AppUser>): Promise<AppUser> {
    const endpoint = `${API_BASE_URL}/api/users`;

    // Validation Password (doit matcher la regex Java)
    const pwdRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
    if (userData.password && !pwdRegex.test(userData.password)) {
      throw new Error("Le mot de passe doit contenir: 8 chars min, 1 Maj, 1 Min, 1 Chiffre, 1 Spécial (@$!%*?&)");
    }

    // Validation Phone (doit matcher la regex Java: ^[+]?[0-9]{10,15}$)
    if (userData.phone) {
      const phoneRegex = /^[+]?[0-9]{10,15}$/;
      if (!phoneRegex.test(userData.phone)) {
        throw new Error("Le téléphone doit contenir entre 10 et 15 chiffres (+ optionnel au début)");
      }
    }

    // Validation Username (doit matcher: ^[a-zA-Z0-9_.-]+$)
    if (userData.username) {
      const usernameRegex = /^[a-zA-Z0-9_.-]+$/;
      if (!usernameRegex.test(userData.username)) {
        throw new Error("Le nom d'utilisateur ne peut contenir que des lettres, chiffres, points, tirets et underscores");
      }
      if (userData.username.length < 3 || userData.username.length > 50) {
        throw new Error("Le nom d'utilisateur doit contenir entre 3 et 50 caractères");
      }
    }

    const payload = {
      organizationId: DEFAULT_ORG_ID,
      username: userData.username,
      email: userData.email,
      phone: userData.phone || null, // Envoyer null si vide
      password: userData.password,
      role: "USER",
      isActive: true
    };

    console.log("📤 Register Payload:", payload);

    const res = await fetch(endpoint, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload),
    });

    if (!res.ok) {
      const errorText = await res.text();
      console.error("❌ API Error:", errorText);
      
      try {
        const errorJson = JSON.parse(errorText);
        throw new Error(errorJson.message || "Erreur lors de l'inscription");
      } catch (e) {
        throw new Error(`Erreur serveur (${res.status}): ${errorText}`);
      }
    }

    const newUser = await res.json();
    return newUser;
  }

  async login(credentials: { email: string, password: string }): Promise<AppUser> {
    const checkRes = await fetch(`${API_BASE_URL}/api/users/check-email/${encodeURIComponent(credentials.email)}`);
    const exists = await checkRes.json();

    if (!exists) {
      throw new Error("Cet email n'existe pas.");
    }

    const userRes = await fetch(`${API_BASE_URL}/api/users/email/${encodeURIComponent(credentials.email)}`);
    
    if (!userRes.ok) {
       throw new Error("Impossible de récupérer le profil utilisateur.");
    }

    const user: AppUser = await userRes.json();
    this.saveSession(user);
    return user;
  }

  saveSession(user: AppUser) {
    if (typeof window !== 'undefined') {
      localStorage.setItem("navigoo_user", JSON.stringify(user));
    }
  }

  getSession(): AppUser | null {
    if (typeof window !== 'undefined') {
      const u = localStorage.getItem("navigoo_user");
      return u ? JSON.parse(u) : null;
    }
    return null;
  }

  logout() {
    if (typeof window !== 'undefined') {
      localStorage.removeItem("navigoo_user");
      window.location.href = "/signin";
    }
  }
}

export const authService = new AuthService();


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\adminService.ts
================================================================================

// Admin Service - Centralized API calls for POI Navigoo Admin Dashboard
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'https://poi-navigoo.pynfi.com';

// Types
export interface AppUser {
  userId: string;
  organizationId: string;
  username: string;
  email: string;
  phone?: string;
  role: 'USER' | 'ADMIN' | 'SUPER_ADMIN';
  isActive: boolean;
  createdAt: string;
}

export interface PointOfInterest {
  poi_id: string;
  organization_id: string;
  town_id?: string;
  created_by_user_id: string;
  poi_name: string;
  poi_type: string;
  poi_category: string;
  poi_description?: string;
  latitude: number;
  longitude: number;
  address_city?: string;
  address_country?: string;
  popularity_score?: number;
  is_active: boolean;
  created_at: string;
  updated_at?: string;
}

export interface PoiReview {
  reviewId: string;
  poiId: string;
  userId: string;
  organizationId: string;
  platformType: string;
  rating: number;
  reviewText?: string;
  createdAt: string;
  likes: number;
  dislikes: number;
}

export interface PoiPlatformStat {
  statId: string;
  orgId: string;
  poiId: string;
  platformType: string;
  statDate: string;
  views: number;
  reviews: number;
  likes: number;
  dislikes: number;
}

export interface PoiAccessLog {
  accessId: string;
  poiId: string;
  organizationId: string;
  platformType: string;
  userId?: string;
  accessType: string;
  accessDatetime: string;
  metadata?: Record<string, any>;
}

export interface Organization {
  organizationId: string;
  organizationName: string;
  orgCode: string;
  orgType: 'MERCHANT' | 'DISTRIBUTOR' | 'SUPPLIER' | 'INTERNAL';
  createdAt: string;
  isActive: boolean;
}

export interface Blog {
  blog_id: string;
  user_id: string;
  poi_id: string;
  title: string;
  description?: string;
  cover_image_url?: string;
  content: string;
  is_active: boolean;
  created_at: string;
  updated_at?: string;
}

export interface Podcast {
  podcast_id: string;
  user_id: string;
  poi_id: string;
  title: string;
  description?: string;
  cover_image_url?: string;
  audio_file_url: string;
  duration_seconds: number;
  is_active: boolean;
  created_at: string;
  updated_at?: string;
}

// Helper function for API calls
async function apiCall<T>(endpoint: string, options?: RequestInit): Promise<T> {
  const response = await fetch(`${API_BASE_URL}${endpoint}`, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      ...options?.headers,
    },
  });

  if (!response.ok) {
    throw new Error(`API Error: ${response.status} ${response.statusText}`);
  }

  return response.json();
}

// ==================== USER API ====================
export const UserAPI = {
  getAll: () => apiCall<AppUser[]>('/api/users'),
  getById: (id: string) => apiCall<AppUser>(`/api/users/${id}`),
  getByUsername: (username: string) => apiCall<AppUser>(`/api/users/username/${username}`),
  getByEmail: (email: string) => apiCall<AppUser>(`/api/users/email/${email}`),
  getByRole: (role: string) => apiCall<AppUser[]>(`/api/users/role/${role}`),
  getActiveByOrg: (orgId: string) => apiCall<AppUser[]>(`/api/users/organization/${orgId}/active`),
  countActiveByOrg: (orgId: string) => apiCall<number>(`/api/users/organization/${orgId}/count`),
  exists: (id: string) => apiCall<boolean>(`/api/users/${id}/exists`),
  usernameExists: (username: string) => apiCall<boolean>(`/api/users/check-username/${username}`),
  emailExists: (email: string) => apiCall<boolean>(`/api/users/check-email/${email}`),
  create: (user: Partial<AppUser>) => apiCall<AppUser>('/api/users', { method: 'POST', body: JSON.stringify(user) }),
  update: (id: string, user: Partial<AppUser>) => apiCall<AppUser>(`/api/users/${id}`, { method: 'PUT', body: JSON.stringify(user) }),
  delete: (id: string) => apiCall<void>(`/api/users/${id}`, { method: 'DELETE' }),
};

// ==================== POI API ====================
export const PoiAPI = {
  getAll: () => apiCall<PointOfInterest[]>('/api/pois'),
  getById: (id: string) => apiCall<PointOfInterest>(`/api/pois/${id}`),
  getByUser: (userId: string) => apiCall<PointOfInterest[]>(`/api/pois/user/${userId}`),
  getByType: (type: string) => apiCall<PointOfInterest[]>(`/api/pois/type/${type}`),
  getByCategory: (category: string) => apiCall<PointOfInterest[]>(`/api/pois/category/${category}`),
  getByCity: (city: string) => apiCall<PointOfInterest[]>(`/api/pois/city/${city}`),
  getByOrganization: (orgId: string) => apiCall<PointOfInterest[]>(`/api/pois/organization/${orgId}`),
  getAllByOrganization: (orgId: string) => apiCall<PointOfInterest[]>(`/api/pois/organization/${orgId}/all`),
  countByOrganization: (orgId: string) => apiCall<number>(`/api/pois/organization/${orgId}/count`),
  searchByName: (name: string) => apiCall<PointOfInterest[]>(`/api/pois/name/${name}`),
  getByLocation: (latitude: number, longitude: number, radiusKm?: number) => 
    apiCall<PointOfInterest[]>(`/api/pois/location?latitude=${latitude}&longitude=${longitude}&radiusKm=${radiusKm || 10}`),
  getPopular: (limit?: number) => apiCall<PointOfInterest[]>(`/api/pois/popular?limit=${limit || 10}`),
  checkNameExists: (name: string, organizationId: string, excludeId?: string) => 
    apiCall<boolean>(`/api/pois/check-name?name=${encodeURIComponent(name)}&organizationId=${organizationId}${excludeId ? `&excludeId=${excludeId}` : ''}`),
  create: (poi: Partial<PointOfInterest>) => apiCall<PointOfInterest>('/api/pois', { method: 'POST', body: JSON.stringify(poi) }),
  update: (id: string, poi: Partial<PointOfInterest>) => apiCall<PointOfInterest>(`/api/pois/${id}`, { method: 'PUT', body: JSON.stringify(poi) }),
  delete: (id: string) => apiCall<void>(`/api/pois/${id}`, { method: 'DELETE' }),
  activate: (id: string) => apiCall<void>(`/api/pois/${id}/activate`, { method: 'PATCH' }),
  deactivate: (id: string) => apiCall<void>(`/api/pois/${id}/desactivate`, { method: 'PATCH' }),
  updatePopularity: (id: string, score: number) => apiCall<void>(`/api/pois/${id}/popularity?score=${score}`, { method: 'PATCH' }),
};

// ==================== REVIEWS API ====================
export const ReviewAPI = {
  getAll: () => apiCall<PoiReview[]>('/api-reviews'),
  getById: (id: string) => apiCall<PoiReview>(`/api-reviews/${id}`),
  getByPoi: (poiId: string) => apiCall<PoiReview[]>(`/api-reviews/poi/${poiId}/reviews`),
  getByUser: (userId: string) => apiCall<PoiReview[]>(`/api-reviews/user/${userId}/reviews`),
  getByOrganization: (orgId: string) => apiCall<PoiReview[]>(`/api-reviews/organization/${orgId}/reviews`),
  getPoiStats: (poiId: string) => apiCall<{ averageRating: number; reviewCount: number }>(`/api-reviews/poi/${poiId}/stats`),
  getAverageRating: (poiId: string) => apiCall<number>(`/api-reviews/poi/${poiId}/average-rating`),
  getCount: (poiId: string) => apiCall<number>(`/api-reviews/poi/${poiId}/count`),
  create: (review: Partial<PoiReview>) => apiCall<PoiReview>('/api-reviews', { method: 'POST', body: JSON.stringify(review) }),
  update: (id: string, review: Partial<PoiReview>) => apiCall<PoiReview>(`/api-reviews/${id}`, { method: 'PUT', body: JSON.stringify(review) }),
  delete: (id: string) => apiCall<void>(`/api-reviews/${id}`, { method: 'DELETE' }),
  like: (id: string) => apiCall<PoiReview>(`/api-reviews/${id}/like`, { method: 'PATCH' }),
  unlike: (id: string) => apiCall<PoiReview>(`/api-reviews/${id}/unlike`, { method: 'PATCH' }),
};

// ==================== STATISTICS API ====================
export const StatisticsAPI = {
  getAll: () => apiCall<PoiPlatformStat[]>('/api/poi-platform-stats'),
  getById: (id: string) => apiCall<PoiPlatformStat>(`/api/poi-platform-stats/${id}`),
  getByPoi: (poiId: string) => apiCall<PoiPlatformStat[]>(`/api/poi-platform-stats/poi/${poiId}/stats`),
  getByOrganization: (orgId: string) => apiCall<PoiPlatformStat[]>(`/api/poi-platform-stats/organization/${orgId}/stats`),
  getByPlatform: (platformType: string) => apiCall<PoiPlatformStat[]>(`/api/poi-platform-stats/platform/${platformType}/stats`),
  getByDate: (date: string) => apiCall<PoiPlatformStat[]>(`/api/poi-platform-stats/date/${date}/stats`),
  getByDateRange: (startDate: string, endDate: string) => 
    apiCall<PoiPlatformStat[]>(`/api/poi-platform-stats/date-range?startDate=${startDate}&endDate=${endDate}`),
  getByOrgAndDateRange: (orgId: string, startDate: string, endDate: string) => 
    apiCall<PoiPlatformStat[]>(`/api/poi-platform-stats/organization/${orgId}/date-range?startDate=${startDate}&endDate=${endDate}`),
  create: (stat: Partial<PoiPlatformStat>) => apiCall<PoiPlatformStat>('/api/poi-platform-stats', { method: 'POST', body: JSON.stringify(stat) }),
  update: (id: string, stat: Partial<PoiPlatformStat>) => apiCall<PoiPlatformStat>(`/api/poi-platform-stats/${id}`, { method: 'PUT', body: JSON.stringify(stat) }),
  delete: (id: string) => apiCall<void>(`/api/poi-platform-stats/${id}`, { method: 'DELETE' }),
  deleteByPoi: (poiId: string) => apiCall<void>(`/api/poi-platform-stats/poi/${poiId}`, { method: 'DELETE' }),
  deleteByOrg: (orgId: string) => apiCall<void>(`/api/poi-platform-stats/organization/${orgId}`, { method: 'DELETE' }),
};

// ==================== ACCESS LOGS API ====================
export const AccessLogAPI = {
  getAll: () => apiCall<PoiAccessLog[]>('/api/poi-access-logs'),
  getById: (id: string) => apiCall<PoiAccessLog>(`/api/poi-access-logs/${id}`),
  getByPoi: (poiId: string) => apiCall<PoiAccessLog[]>(`/api/poi-access-logs/poi/${poiId}`),
  getByPoiPaginated: (poiId: string, page: number = 0, size: number = 10) => 
    apiCall<PoiAccessLog[]>(`/api/poi-access-logs/poi/${poiId}/paginated?page=${page}&size=${size}`),
  getRecentByPoi: (poiId: string, since: string) => 
    apiCall<PoiAccessLog[]>(`/api/poi-access-logs/poi/${poiId}/recent?since=${since}`),
  getByUser: (userId: string) => apiCall<PoiAccessLog[]>(`/api/poi-access-logs/user/${userId}`),
  getByOrganization: (orgId: string) => apiCall<PoiAccessLog[]>(`/api/poi-access-logs/organization/${orgId}`),
  getByPoiAndOrg: (poiId: string, orgId: string) => 
    apiCall<PoiAccessLog[]>(`/api/poi-access-logs/poi/${poiId}/organization/${orgId}`),
  getByPlatform: (platformType: string) => apiCall<PoiAccessLog[]>(`/api/poi-access-logs/platform/${platformType}`),
  getByAccessType: (accessType: string) => apiCall<PoiAccessLog[]>(`/api/poi-access-logs/access-type/${accessType}`),
  getByDateRange: (startDate: string, endDate: string) => 
    apiCall<PoiAccessLog[]>(`/api/poi-access-logs/date-range?startDate=${startDate}&endDate=${endDate}`),
  countByPoiAndAccessType: (poiId: string, accessType: string) => 
    apiCall<number>(`/api/poi-access-logs/poi/${poiId}/count/access-type/${accessType}`),
  getPlatformStatsForOrg: (orgId: string) => apiCall<Record<string, number>>(`/api/poi-access-logs/organization/${orgId}/platform-stats`),
  create: (log: Partial<PoiAccessLog>) => apiCall<PoiAccessLog>('/api/poi-access-logs', { method: 'POST', body: JSON.stringify(log) }),
  update: (id: string, log: Partial<PoiAccessLog>) => apiCall<PoiAccessLog>(`/api/poi-access-logs/${id}`, { method: 'PUT', body: JSON.stringify(log) }),
  delete: (id: string) => apiCall<void>(`/api/poi-access-logs/${id}`, { method: 'DELETE' }),
  deleteOldLogs: (beforeDate: string) => apiCall<string>(`/api/poi-access-logs/cleanup?beforeDate=${beforeDate}`, { method: 'DELETE' }),
};

// ==================== ORGANIZATION API ====================
export const OrganizationAPI = {
  getAll: () => apiCall<Organization[]>('/api/organizations'),
  getById: (id: string) => apiCall<Organization>(`/api/organizations/${id}`),
  getByCode: (code: string) => apiCall<Organization>(`/api/organizations/by-code/${code}`),
  getByType: (type: string) => apiCall<Organization[]>(`/api/organizations/by-type/${type}`),
  searchByName: (name: string) => apiCall<Organization[]>(`/api/organizations/by-name/${name}`),
  getByActiveStatus: (isActive: boolean) => apiCall<Organization[]>(`/api/organizations/by-active-status/${isActive}`),
  create: (org: Partial<Organization>) => apiCall<Organization>('/api/organizations', { method: 'POST', body: JSON.stringify(org) }),
  update: (id: string, org: Partial<Organization>) => apiCall<Organization>(`/api/organizations/${id}`, { method: 'PUT', body: JSON.stringify(org) }),
  delete: (id: string) => apiCall<void>(`/api/organizations/${id}`, { method: 'DELETE' }),
};

// ==================== BLOG API ====================
export const BlogAPI = {
  getAll: () => apiCall<Blog[]>('/api/blogs'),
  getById: (id: string) => apiCall<Blog>(`/api/blogs/${id}`),
  getByUser: (userId: string) => apiCall<Blog[]>(`/api/blogs/user/${userId}`),
  getByPoi: (poiId: string) => apiCall<Blog[]>(`/api/blogs/poi/${poiId}`),
  searchByTitle: (title: string) => apiCall<Blog[]>(`/api/blogs/search?title=${encodeURIComponent(title)}`),
  create: (blog: { user_id: string; poi_id: string; title: string; description?: string; cover_image_url?: string; content: string }) => 
    apiCall<Blog>('/api/blogs', { method: 'POST', body: JSON.stringify(blog) }),
  update: (id: string, blog: Partial<Blog>) => apiCall<Blog>(`/api/blogs/${id}`, { method: 'PUT', body: JSON.stringify(blog) }),
  delete: (id: string) => apiCall<void>(`/api/blogs/${id}`, { method: 'DELETE' }),
};

// ==================== PODCAST API ====================
export const PodcastAPI = {
  getAll: () => apiCall<Podcast[]>('/api/podcasts'),
  getById: (id: string) => apiCall<Podcast>(`/api/podcasts/${id}`),
  getByUser: (userId: string) => apiCall<Podcast[]>(`/api/podcasts/user/${userId}`),
  getByPoi: (poiId: string) => apiCall<Podcast[]>(`/api/podcasts/poi/${poiId}`),
  searchByTitle: (title: string) => apiCall<Podcast[]>(`/api/podcasts/search?title=${encodeURIComponent(title)}`),
  getByDurationRange: (minDuration: number, maxDuration: number) => 
    apiCall<Podcast[]>(`/api/podcasts/duration?minDuration=${minDuration}&maxDuration=${maxDuration}`),
  create: (podcast: { user_id: string; poi_id: string; title: string; description?: string; cover_image_url?: string; audio_file_url: string; duration_seconds: number }) => 
    apiCall<Podcast>('/api/podcasts', { method: 'POST', body: JSON.stringify(podcast) }),
  update: (id: string, podcast: Partial<Podcast>) => apiCall<Podcast>(`/api/podcasts/${id}`, { method: 'PUT', body: JSON.stringify(podcast) }),
  delete: (id: string) => apiCall<void>(`/api/podcasts/${id}`, { method: 'DELETE' }),
};

// ==================== DASHBOARD AGGREGATES ====================
export const DashboardAPI = {
  async getOverview(orgId?: string) {
    const [pois, users, reviews, stats] = await Promise.all([
      orgId ? PoiAPI.getByOrganization(orgId) : PoiAPI.getAll(),
      orgId ? UserAPI.getActiveByOrg(orgId) : UserAPI.getAll(),
      orgId ? ReviewAPI.getByOrganization(orgId) : ReviewAPI.getAll(),
      orgId ? StatisticsAPI.getByOrganization(orgId) : StatisticsAPI.getAll(),
    ]);

    return {
      totalPois: pois.length,
      activePois: pois.filter(p => p.is_active).length,
      totalUsers: users.length,
      totalReviews: reviews.length,
      averageRating: reviews.length > 0 
        ? reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length 
        : 0,
      totalViews: stats.reduce((sum, s) => sum + s.views, 0),
      totalLikes: stats.reduce((sum, s) => sum + s.likes, 0),
    };
  },
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\geocodingService.ts
================================================================================

import { POI } from "@/types";

const MAPTILER_API_KEY = "Lr72DkH8TYyjpP7RNZS9";

// Cache pour éviter les requêtes redondantes
const geocodeCache = new Map<string, Partial<POI>>();

// Détermine la catégorie en fonction du type de lieu
const determineCategoryFromType = (placeType: string): string => {
  const typeMap: Record<string, string> = {
    'restaurant': 'FOOD_DRINK',
    'cafe': 'FOOD_DRINK',
    'bar': 'FOOD_DRINK',
    'fast_food': 'FOOD_DRINK',
    'food_court': 'FOOD_DRINK',
    'hotel': 'ACCOMMODATION',
    'motel': 'ACCOMMODATION',
    'hostel': 'ACCOMMODATION',
    'guest_house': 'ACCOMMODATION',
    'shop': 'SHOPPING_RETAIL',
    'supermarket': 'SHOPPING_RETAIL',
    'mall': 'SHOPPING_RETAIL',
    'marketplace': 'SHOPPING_RETAIL',
    'boutique': 'SHOPPING_RETAIL',
    'hospital': 'HEALTH_WELLNESS',
    'clinic': 'HEALTH_WELLNESS',
    'pharmacy': 'HEALTH_WELLNESS',
    'doctors': 'HEALTH_WELLNESS',
    'dentist': 'HEALTH_WELLNESS',
    'veterinary': 'HEALTH_WELLNESS',
    'school': 'EDUCATION',
    'university': 'EDUCATION',
    'college': 'EDUCATION',
    'kindergarten': 'EDUCATION',
    'library': 'EDUCATION',
    'bank': 'FINANCE',
    'atm': 'FINANCE',
    'bureau_de_change': 'FINANCE',
    'church': 'WORSHIP_SPIRITUALITY',
    'mosque': 'WORSHIP_SPIRITUALITY',
    'temple': 'WORSHIP_SPIRITUALITY',
    'chapel': 'WORSHIP_SPIRITUALITY',
    'museum': 'LEISURE_CULTURE',
    'cinema': 'LEISURE_CULTURE',
    'theater': 'LEISURE_CULTURE',
    'theatre': 'LEISURE_CULTURE',
    'park': 'LEISURE_CULTURE',
    'zoo': 'LEISURE_CULTURE',
    'stadium': 'LEISURE_CULTURE',
    'bus_stop': 'TRANSPORTATION',
    'bus_station': 'TRANSPORTATION',
    'train_station': 'TRANSPORTATION',
    'airport': 'TRANSPORTATION',
    'taxi_stand': 'TRANSPORTATION',
    'fuel': 'TRANSPORTATION',
    'parking': 'TRANSPORTATION',
    'town_hall': 'PUBLIC_ADMIN_SERVICES',
    'police': 'PUBLIC_ADMIN_SERVICES',
    'fire_station': 'PUBLIC_ADMIN_SERVICES',
    'post_office': 'PUBLIC_ADMIN_SERVICES',
    'government': 'PUBLIC_ADMIN_SERVICES',
  };
  
  const lowerType = placeType.toLowerCase();
  return typeMap[lowerType] || 'LEISURE_CULTURE';
};

// Génère une description contextuelle enrichie
const generateDescription = (
  placeName: string, 
  placeType: string, 
  city: string,
  additionalInfo?: any
): string => {
  const baseDescriptions: Record<string, string> = {
    'FOOD_DRINK': `établissement de restauration`,
    'ACCOMMODATION': `hébergement`,
    'SHOPPING_RETAIL': `commerce`,
    'HEALTH_WELLNESS': `établissement de santé`,
    'EDUCATION': `établissement d'enseignement`,
    'FINANCE': `établissement financier`,
    'WORSHIP_SPIRITUALITY': `lieu de culte`,
    'LEISURE_CULTURE': `lieu culturel et de loisirs`,
    'TRANSPORTATION': `point de transport`,
    'PUBLIC_ADMIN_SERVICES': `service public`
  };
  
  const category = determineCategoryFromType(placeType);
  const baseDesc = baseDescriptions[category] || 'établissement';
  
  let description = `${placeName} est un ${baseDesc} situé à ${city}.`;
  
  // Ajouter des informations contextuelles si disponibles
  if (additionalInfo) {
    if (additionalInfo.address) {
      description += ` Adresse: ${additionalInfo.address}.`;
    }
    if (additionalInfo.opening_hours) {
      description += ` Horaires: ${additionalInfo.opening_hours}.`;
    }
    if (additionalInfo.phone) {
      description += ` Contact: ${additionalInfo.phone}.`;
    }
  }
  
  description += ` Partagez votre expérience sur Navigoo.`;
  
  return description;
};

// Sélectionne une image appropriée selon la catégorie
const getCategoryImage = (category: string): string => {
  const imageMap: Record<string, string> = {
    'FOOD_DRINK': 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?q=80&w=800',
    'ACCOMMODATION': 'https://images.unsplash.com/photo-1566073771259-6a8506099945?q=80&w=800',
    'SHOPPING_RETAIL': 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?q=80&w=800',
    'HEALTH_WELLNESS': 'https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?q=80&w=800',
    'EDUCATION': 'https://images.unsplash.com/photo-1523050854058-8df90110c9f1?q=80&w=800',
    'FINANCE': 'https://images.unsplash.com/photo-1541354329998-f4d9a9f9297f?q=80&w=800',
    'WORSHIP_SPIRITUALITY': 'https://images.unsplash.com/photo-1548625361-5b2e24e3f179?q=80&w=800',
    'LEISURE_CULTURE': 'https://images.unsplash.com/photo-1518998053901-5348d3961a04?q=80&w=800',
    'TRANSPORTATION': 'https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?q=80&w=800',
    'PUBLIC_ADMIN_SERVICES': 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?q=80&w=800'
  };
  
  return imageMap[category] || 'https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=800';
};

// Extrait les équipements depuis les tags OSM
const extractAmenitiesFromTags = (tags: any): string[] => {
  const amenities: string[] = [];
  
  if (!tags) return amenities;
  
  // Mapping des tags OSM vers amenities Navigoo
  const amenityMap: Record<string, string> = {
    'wifi': 'Wi-Fi',
    'internet_access': 'Wi-Fi',
    'parking': 'Parking',
    'wheelchair': 'Handicap',
    'air_conditioning': 'Climatisé',
    'outdoor_seating': 'Terrasse',
    'delivery': 'Livraison',
    'takeaway': 'À emporter',
    'toilets': 'Toilettes',
    'smoking': 'Fumeur',
    'payment:mobile_money': 'Mobile Money',
  };
  
  Object.keys(tags).forEach(key => {
    if (amenityMap[key] && tags[key] === 'yes') {
      amenities.push(amenityMap[key]);
    }
  });
  
  // Ajouter selon le type
  if (tags.cuisine) amenities.push(`Cuisine: ${tags.cuisine}`);
  if (tags.stars) amenities.push(`${tags.stars} étoiles`);
  if (tags.opening_hours) amenities.push('Horaires disponibles');
  
  return amenities;
};

// NOUVELLE FONCTION: Recherche détaillée via Overpass API (OpenStreetMap)
const fetchFromOverpassAPI = async (lat: number, lon: number, radius: number = 50): Promise<any> => {
  try {
    // Query Overpass pour récupérer les POIs dans un rayon
    const query = `
      [out:json][timeout:25];
      (
        node["name"](around:${radius},${lat},${lon});
        way["name"](around:${radius},${lat},${lon});
        relation["name"](around:${radius},${lat},${lon});
      );
      out body;
      >;
      out skel qt;
    `;
    
    const response = await fetch('https://overpass-api.de/api/interpreter', {
      method: 'POST',
      body: `data=${encodeURIComponent(query)}`,
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
    });
    
    if (!response.ok) {
      console.warn('Overpass API error:', response.status);
      return null;
    }
    
    const data = await response.json();
    
    if (data.elements && data.elements.length > 0) {
      // Trouver l'élément le plus proche
      let closest = null;
      let minDistance = Infinity;
      
      data.elements.forEach((element: any) => {
        if (element.tags && element.tags.name) {
          const elLat = element.lat || element.center?.lat;
          const elLon = element.lon || element.center?.lon;
          
          if (elLat && elLon) {
            const distance = Math.sqrt(
              Math.pow(elLat - lat, 2) + Math.pow(elLon - lon, 2)
            );
            
            if (distance < minDistance) {
              minDistance = distance;
              closest = element;
            }
          }
        }
      });
      
      return closest;
    }
    
    return null;
  } catch (error) {
    console.error('Overpass API error:', error);
    return null;
  }
};

// NOUVELLE FONCTION: Enrichir avec Nominatim (détails complets)
const enrichWithNominatim = async (lat: number, lon: number): Promise<any> => {
  try {
    const response = await fetch(
      `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=18&addressdetails=1&extratags=1&namedetails=1`,
      {
        headers: {
          'User-Agent': 'POI-Navigoo/1.0',
        },
      }
    );
    
    if (!response.ok) return null;
    
    return await response.json();
  } catch (error) {
    console.error('Nominatim error:', error);
    return null;
  }
};

// FONCTION PRINCIPALE: Géocodage Inverse Multi-Sources
export const reverseGeocode = async (lat: number, lon: number): Promise<Partial<POI> | null> => {
  const cacheKey = `${lat.toFixed(5)},${lon.toFixed(5)}`;
  
  // Vérifier le cache
  if (geocodeCache.has(cacheKey)) {
    console.log('✅ Cache hit:', cacheKey);
    return geocodeCache.get(cacheKey)!;
  }

  console.log('🔍 Recherche multi-sources pour:', lat, lon);

  try {
    // ÉTAPE 1: MapTiler (rapide, info de base)
    const maptilerPromise = fetch(
      `https://api.maptiler.com/geocoding/${lon},${lat}.json?key=${MAPTILER_API_KEY}&limit=1`
    ).then(res => res.ok ? res.json() : null);
    
    // ÉTAPE 2: Overpass API (données OSM riches)
    const overpassPromise = fetchFromOverpassAPI(lat, lon, 50);
    
    // ÉTAPE 3: Nominatim (détails d'adresse)
    const nominatimPromise = enrichWithNominatim(lat, lon);
    
    // Exécution parallèle pour optimiser le temps
    const [maptilerData, overpassData, nominatimData] = await Promise.all([
      maptilerPromise,
      overpassPromise,
      nominatimPromise,
    ]);
    
    console.log('📊 Données récupérées:', {
      maptiler: !!maptilerData,
      overpass: !!overpassData,
      nominatim: !!nominatimData,
    });
    
    // FUSION DES DONNÉES
    let placeName = 'Lieu inconnu';
    let placeType = 'unknown';
    let city = 'Ville inconnue';
    let region = '';
    let country = 'Cameroun';
    let address = '';
    let phone = '';
    let website = '';
    let opening_hours = '';
    let amenities: string[] = [];
    let keywords: string[] = [];
    let imageUrl = '';
    
    // Priorité 1: Overpass (données les plus riches)
    if (overpassData && overpassData.tags) {
      const tags = overpassData.tags;
      placeName = tags.name || tags['name:fr'] || tags['name:en'] || placeName;
      placeType = tags.amenity || tags.shop || tags.leisure || tags.tourism || placeType;
      phone = tags.phone || tags['contact:phone'] || phone;
      website = tags.website || tags['contact:website'] || website;
      opening_hours = tags.opening_hours || opening_hours;
      
      // Extraire les équipements
      amenities = extractAmenitiesFromTags(tags);
      
      // Keywords depuis les tags
      if (tags.cuisine) keywords.push(tags.cuisine);
      if (tags.brand) keywords.push(tags.brand);
      if (tags.operator) keywords.push(tags.operator);
      
      console.log('✨ Overpass data:', {
        name: placeName,
        type: placeType,
        tags: Object.keys(tags),
      });
    }
    
    // Priorité 2: Nominatim (adresse complète)
    if (nominatimData) {
      address = nominatimData.display_name || address;
      
      if (nominatimData.address) {
        const addr = nominatimData.address;
        city = addr.city || addr.town || addr.village || addr.municipality || city;
        region = addr.state || addr.region || region;
        country = addr.country || country;
        
        // Si pas de nom depuis Overpass, utiliser Nominatim
        if (placeName === 'Lieu inconnu') {
          placeName = nominatimData.name || 
                     addr.amenity || 
                     addr.shop || 
                     addr.building || 
                     placeName;
        }
      }
      
      // Type depuis Nominatim si non trouvé
      if (placeType === 'unknown') {
        placeType = nominatimData.type || 
                   nominatimData.class || 
                   placeType;
      }
      
      // Tags extra de Nominatim
      if (nominatimData.extratags) {
        const extra = nominatimData.extratags;
        if (extra.phone && !phone) phone = extra.phone;
        if (extra.website && !website) website = extra.website;
        if (extra.opening_hours && !opening_hours) opening_hours = extra.opening_hours;
      }
      
      console.log('🏠 Nominatim data:', {
        name: placeName,
        address: city,
        type: placeType,
      });
    }
    
    // Priorité 3: MapTiler (fallback)
    if (maptilerData && maptilerData.features && maptilerData.features.length > 0) {
      const feature = maptilerData.features[0];
      const context = feature.context || [];
      
      if (placeName === 'Lieu inconnu') {
        placeName = feature.text || placeName;
      }
      
      const placeContext = context.find((c: any) => c.id?.includes('place'));
      const regionContext = context.find((c: any) => c.id?.includes('region'));
      const countryContext = context.find((c: any) => c.id?.includes('country'));
      
      if (!city || city === 'Ville inconnue') city = placeContext?.text || city;
      if (!region) region = regionContext?.text || region;
      if (!country || country === 'Cameroun') country = countryContext?.text || country;
      
      if (placeType === 'unknown') {
        placeType = feature.properties?.category || placeType;
      }
      
      console.log('🗺️ MapTiler data:', {
        name: placeName,
        city,
        type: placeType,
      });
    }
    
    // Déterminer la catégorie
    const category = determineCategoryFromType(placeType);
    
    // Image par défaut selon catégorie
    imageUrl = getCategoryImage(category);
    
    // Mots-clés finaux
    keywords = Array.from(new Set([...keywords, placeType, city, category])).filter(Boolean);
    
    // Construire le POI final
    const poi: Partial<POI> = {
      poi_id: `external-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
      poi_name: placeName,
      address_informal: address || `${city}, ${country}`,
      address_city: city,
      address_state_province: region,
      address_country: country,
      location: { latitude: lat, longitude: lon },
      poi_category: category,
      poi_description: generateDescription(placeName, placeType, city, {
        address,
        opening_hours,
        phone,
      }),
      poi_images_urls: [imageUrl],
      rating: 0,
      review_count: 0,
      popularity_score: 0,
      poi_amenities: amenities,
      poi_keywords: keywords,
      poi_contacts: {
        phone: phone,
        website: website,
        email: '',
      },
      is_active: false, // Lieu externe non vérifié
    };
    
    console.log('✅ POI final créé:', {
      name: poi.poi_name,
      category: poi.poi_category,
      amenities: poi.poi_amenities?.length,
      hasPhone: !!phone,
      hasWebsite: !!website,
    });
    
    // Mise en cache
    if (geocodeCache.size > 100) {
      const firstKey = geocodeCache.keys().next().value;
      geocodeCache.delete(firstKey);
    }
    geocodeCache.set(cacheKey, poi);
    
    return poi;
    
  } catch (error) {
    console.error('❌ Erreur geocoding:', error);
    return null;
  }
};

// FONCTION BONUS: Recherche par nom de lieu
export const searchPlaceByName = async (name: string, lat?: number, lon?: number): Promise<Partial<POI>[]> => {
  try {
    const nominatimUrl = lat && lon
      ? `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(name)}&format=json&limit=5&lat=${lat}&lon=${lon}&addressdetails=1&extratags=1`
      : `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(name)}&format=json&limit=5&addressdetails=1&extratags=1`;
    
    const response = await fetch(nominatimUrl, {
      headers: {
        'User-Agent': 'POI-Navigoo/1.0',
      },
    });
    
    if (!response.ok) return [];
    
    const results = await response.json();
    
    return results.map((result: any) => {
      const category = determineCategoryFromType(result.type || result.class);
      
      return {
        poi_id: `search-${result.osm_id}`,
        poi_name: result.display_name.split(',')[0],
        address_informal: result.display_name,
        address_city: result.address?.city || result.address?.town || '',
        address_country: result.address?.country || '',
        location: {
          latitude: parseFloat(result.lat),
          longitude: parseFloat(result.lon),
        },
        poi_category: category,
        poi_description: `${result.display_name}`,
        poi_images_urls: [getCategoryImage(category)],
        rating: 0,
        review_count: 0,
      };
    });
  } catch (error) {
    console.error('Search error:', error);
    return [];
  }
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\mapCaptureService.ts
================================================================================

import html2canvas from 'html2canvas';

export const captureMap = async (): Promise<void> => {
  try {
    const mapContainer = document.querySelector('.maplibregl-map') as HTMLElement;
    
    if (!mapContainer) {
      alert("Impossible de capturer la carte");
      return;
    }

    // Masquer temporairement les contrôles
    const controls = document.querySelectorAll('.maplibregl-ctrl-top-right, .maplibregl-ctrl-bottom-right');
    controls.forEach(ctrl => (ctrl as HTMLElement).style.display = 'none');

    // Capture
    const canvas = await html2canvas(mapContainer, {
      useCORS: true,
      allowTaint: true,
      backgroundColor: '#ffffff'
    });

    // Réafficher les contrôles
    controls.forEach(ctrl => (ctrl as HTMLElement).style.display = 'block');

    // Téléchargement
    const link = document.createElement('a');
    link.download = `navigoo-carte-${new Date().getTime()}.png`;
    link.href = canvas.toDataURL();
    link.click();

    console.log("✅ Carte capturée avec succès");
  } catch (error) {
    console.error("❌ Erreur capture:", error);
    alert("Erreur lors de la capture de la carte");
  }
};

export const shareMap = async (): Promise<void> => {
  const url = window.location.href;
  const text = "Découvrez cette carte sur POI Navigoo !";

  try {
    if (navigator.share) {
      // API Web Share (mobile)
      await navigator.share({
        title: 'POI Navigoo',
        text,
        url
      });
    } else {
      // Fallback: copier dans le presse-papier
      await navigator.clipboard.writeText(url);
      alert("✅ Lien copié dans le presse-papier !");
    }
  } catch (error) {
    console.error("❌ Erreur partage:", error);
  }
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\services\contentService.ts
================================================================================

import { Blog, Podcast } from "@/types";

const API_BASE_URL = "https://poi-navigoo.pynfi.com/api";

class ContentService {
  private async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {
    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
      headers: { "Content-Type": "application/json" },
      ...options,
    });
    if (!response.ok) throw new Error(`Erreur API: ${response.statusText}`);
    return response.status !== 204 ? response.json() : ({} as T);
  }

  // BLOGS
  async createBlog(blog: Partial<Blog>) {
    return this.request<Blog>("/blogs", {
      method: "POST",
      body: JSON.stringify(blog),
    });
  }

  async getBlogsByUser(userId: string) {
    return this.request<Blog[]>(`/blogs/user/${userId}`);
  }

  // PODCASTS
  async createPodcast(podcast: Partial<Podcast>) {
    return this.request<Podcast>("/podcasts", {
      method: "POST",
      body: JSON.stringify(podcast),
    });
  }

  async getPodcastsByUser(userId: string) {
    return this.request<Podcast[]>(`/podcasts/user/${userId}`);
  }
}

export const contentService = new ContentService();


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\hooks\useUserData.ts
================================================================================

// hooks/useUserData.ts

"use client";

import { useState, useEffect, useCallback } from "react";
import { POI, Trip, MapStyle } from "@/types";
import { poiService } from "@/services/poiService";
import { authService } from "@/services/authService";
import { AccessLogAPI } from "@/services/adminService";

export const useUserData = () => {
  const [savedPois, setSavedPois] = useState<POI[]>([]); // Simulation via Favoris (à implémenter au backend si besoin)
  const [recentPois, setRecentPois] = useState<POI[]>([]);
  const [recentTrips, setRecentTrips] = useState<Trip[]>([]);
  const [myPois, setMyPois] = useState<POI[]>([]);
  const [mapStyle, setMapStyle] = useState<MapStyle>("streets-v2");
  const [isLoading, setIsLoading] = useState(true);

  const currentUser = authService.getSession();

  // --- 1. CHARGEMENT DES DONNÉES DEPUIS LE BACKEND ---

  const loadUserPois = useCallback(async (userId: string) => {
    try {
      const data = await poiService.getPoisByUser(userId);
      setMyPois(data || []);
    } catch (err) {
      console.error("Erreur chargement mes POIs:", err);
    }
  }, []);

  const loadRecentActivity = useCallback(async (userId: string) => {
    try {
      // On récupère les logs d'accès de l'utilisateur pour construire la liste "Récents"
      const logs = await AccessLogAPI.getByUser(userId);
      
      // On prend les 5 derniers IDs de POIs uniques visités
      const uniquePoiIds = Array.from(new Set(logs.map((log) => log.poiId))).slice(0, 5);
      
      // On récupère les détails de ces POIs
      const detailedPois = await Promise.all(
        uniquePoiIds.map((id) => poiService.getPoiById(id))
      );
      
      setRecentPois(detailedPois);
      
      // Filtrage des logs pour les trajets récents (si métadonnées présentes)
      const trips = logs
        .filter(l => l.accessType === "TRIP" && l.metadata)
        .map(l => l.metadata as unknown as Trip);
      setRecentTrips(trips);

    } catch (err) {
      console.error("Erreur chargement historique:", err);
    }
  }, []);

  // Sync initiale avec le Backend au montage du composant
  useEffect(() => {
    const initSync = async () => {
      if (currentUser?.userId) {
        setIsLoading(true);
        await Promise.all([
          loadUserPois(currentUser.userId),
          loadRecentActivity(currentUser.userId)
        ]);
        setIsLoading(false);
      }
    };
    initSync();
  }, [currentUser?.userId, loadUserPois, loadRecentActivity]);


  // --- 2. ACTIONS DE MISE À JOUR (BACKEND WRITE) ---

  const addMyPoi = async (poiData: Partial<POI>) => {
    try {
      const created = await poiService.createPoi(poiData);
      setMyPois((prev) => [created, ...prev]);
      return created;
    } catch (err) {
      throw err;
    }
  };

  const updateMyPoi = async (updatedPoi: POI) => {
    try {
      const result = await poiService.updatePoi(updatedPoi.poi_id, updatedPoi);
      setMyPois((prev) =>
        prev.map((p) => (p.poi_id === result.poi_id ? result : p))
      );
      return result;
    } catch (err) {
      throw err;
    }
  };

  const deleteMyPoi = async (poiId: string) => {
    try {
      await poiService.deletePoi(poiId);
      setMyPois((prev) => prev.filter((p) => p.poi_id !== poiId));
    } catch (err) {
      throw err;
    }
  };

  const addRecentPoi = async (poi: POI) => {
    if (!currentUser) return;
    try {
      // Enregistre l'accès au backend
      await AccessLogAPI.create({
        poiId: poi.poi_id,
        userId: currentUser.userId,
        organizationId: currentUser.organizationId,
        accessType: "VIEW",
        platformType: "WEB"
      });
      // Update local state pour réactivité immédiate
      setRecentPois((prev) => [poi, ...prev.filter((p) => p.poi_id !== poi.poi_id)].slice(0, 10));
    } catch (err) {
      console.warn("Échec enregistrement log accès");
    }
  };

  const addTrip = async (trip: Trip) => {
    if (!currentUser) return;
    try {
        await AccessLogAPI.create({
            poiId: trip.id, // Destination
            userId: currentUser.userId,
            organizationId: currentUser.organizationId,
            accessType: "TRIP",
            platformType: "WEB",
            metadata: { ...trip }
        });
        setRecentTrips((prev) => [trip, ...prev].slice(0, 10));
    } catch (err) {
        console.error("Erreur enregistrement trajet");
    }
  };

  // --- 3. UI STATE (Volatile ou à porter en table préférences plus tard) ---
  
  const toggleMapStyle = () => {
    setMapStyle((prev) => (prev === "streets-v2" ? "hybrid" : "streets-v2"));
  };

  const toggleSavePoi = async (poi: POI) => {
    // Le backend ne possède pas encore de table /favorites, on peut utiliser 
    // les likes de la table Reviews ou attendre une évolution API.
    console.info("L'API actuelle ne gère pas encore les favoris persistants.");
  };

  return {
    // États
    savedPois,
    recentPois,
    recentTrips,
    myPois,
    mapStyle,
    isLoading,
    
    // Méthodes
    loadUserPois,
    toggleSavePoi,
    addRecentPoi,
    addTrip,
    addMyPoi,
    updateMyPoi,
    deleteMyPoi,
    toggleMapStyle,
    isSaved: (id: string) => savedPois.some((p) => p.poi_id === id)
  };
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\hooks\useGeolocation.ts
================================================================================

"use client";

import { useState, useEffect, useCallback } from "react";
import { Location } from "@/types";

interface GeolocationState {
  position: Location | null;
  isTracking: boolean;
  error: string | null;
  accuracy: number | null;
}

export const useGeolocation = () => {
  const [state, setState] = useState<GeolocationState>({
    position: null,
    isTracking: false,
    error: null,
    accuracy: null
  });

  const [watchId, setWatchId] = useState<number | null>(null);

  const startTracking = useCallback(() => {
    if (!navigator.geolocation) {
      setState(prev => ({ ...prev, error: "Géolocalisation non supportée" }));
      return;
    }

    const id = navigator.geolocation.watchPosition(
      (position) => {
        setState({
          position: {
            latitude: position.coords.latitude,
            longitude: position.coords.longitude
          },
          isTracking: true,
          error: null,
          accuracy: position.coords.accuracy
        });
      },
      (error) => {
        setState(prev => ({ 
          ...prev, 
          error: error.message,
          isTracking: false 
        }));
      },
      {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      }
    );

    setWatchId(id);
  }, []);

  const stopTracking = useCallback(() => {
    if (watchId !== null) {
      navigator.geolocation.clearWatch(watchId);
      setWatchId(null);
      setState(prev => ({ ...prev, isTracking: false }));
    }
  }, [watchId]);

  const getCurrentPosition = useCallback((): Promise<Location> => {
    return new Promise((resolve, reject) => {
      if (!navigator.geolocation) {
        reject(new Error("Géolocalisation non supportée"));
        return;
      }

      navigator.geolocation.getCurrentPosition(
        (position) => {
          const location = {
            latitude: position.coords.latitude,
            longitude: position.coords.longitude
          };
          setState(prev => ({ ...prev, position: location }));
          resolve(location);
        },
        (error) => reject(error),
        { enableHighAccuracy: true, timeout: 5000 }
      );
    });
  }, []);

  useEffect(() => {
    return () => {
      if (watchId !== null) {
        navigator.geolocation.clearWatch(watchId);
      }
    };
  }, [watchId]);

  return {
    ...state,
    startTracking,
    stopTracking,
    getCurrentPosition
  };
};


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\eslint.config.mjs
================================================================================

import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;



================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\next.config.ts
================================================================================

// next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  typescript: {
    ignoreBuildErrors: true,
  },
  images: {
    // Liste des domaines autorisés pour les images externes
    remotePatterns: [
      {
        protocol: "https",
        hostname: "images.unsplash.com",
      },
      {
        protocol: "https",
        hostname: "example.com", // Ajouté pour corriger l'erreur actuelle
      },
      {
        protocol: "https", // Cas où le backend héberge lui-même des images
        hostname: "**.pynfi.com", 
      },
      {
        protocol: "http",
        hostname: "localhost",
      }
    ],
  },
};

export default nextConfig;


================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\postcss.config.mjs
================================================================================

const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;



================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\next-env.d.ts
================================================================================

/// <reference types="next" />
/// <reference types="next/image-types/global" />
import "./.next/dev/types/routes.d.ts";

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.



================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\README.md
================================================================================

This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.



================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\tsconfig.json
================================================================================

{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}



================================================================================
FICHIER: D:\5GI\PoI-Navigoo\poi-navigoo-web\package.json
================================================================================

{
  "name": "poi-navigoo-web",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "clsx": "^2.1.1",
    "framer-motion": "^12.26.2",
    "html2canvas": "^1.4.1",
    "lucide-react": "^0.562.0",
    "maplibre-gl": "^5.16.0",
    "next": "16.1.2",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "react-map-gl": "^8.1.0",
    "tailwind-merge": "^3.4.0"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "16.1.2",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}


